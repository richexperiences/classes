require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({kn1c3t:[function(a,b){b.exports=function(a){function b(b){a.network.isConnected&&d.replicate(c,function(){c.replicate(d,b)})}var c=a.models.LocalTodo,d=a.models.Todo;a.network={_isConnected:!0,get isConnected(){return console.log("isConnected?",this._isConnected),this._isConnected},set isConnected(a){this._isConnected=a}},c.on("changed",b),c.on("deleted",b),a.sync=b}},{}],"loopback-boot#boot#replication.js":[function(a,b){b.exports=a("kn1c3t")},{}],gwhLyT:[function(a,b){var c=a("loopback"),d=a("loopback-boot"),e=b.exports=c();d(e)},{loopback:89,"loopback-boot":54}],lbclient:[function(a,b){b.exports=a("gwhLyT")},{}],"loopback-boot#models#todo.js":[function(a,b){b.exports=a("1I6yuX")},{}],"1I6yuX":[function(a,b){var c=(a("loopback"),a("async"));b.exports=function(a){a.definition.properties.created.default=Date.now,a.beforeSave=function(a,b){b.id||(b.id="t-"+Math.floor(1e4*Math.random()).toString()),a()},a.stats=function(a,b){function d(a){g.count({completed:!0},function(b,c){f.completed=c,a(b)})}function e(a){g.count(function(b,c){f.total=c,a(b)})}var f={};b=arguments[arguments.length-1];var g=this;c.parallel([d,e],function(a){return a?b(a):(f.remaining=f.total-f.completed,void b(null,f))})},a.remoteMethod("stats",{accepts:{arg:"filter",type:"object"},returns:{arg:"stats",type:"object"},http:{path:"/stats"}},a.stats)}},{async:7,loopback:89}],7:[function(a,b){(function(a){!function(){function c(a){var b=!1;return function(){if(b)throw new Error("Callback was already called.");b=!0,a.apply(d,arguments)}}var d,e,f={};d=this,null!=d&&(e=d.async),f.noConflict=function(){return d.async=e,f};var g=Object.prototype.toString,h=Array.isArray||function(a){return"[object Array]"===g.call(a)},i=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},j=function(a,b){if(a.map)return a.map(b);var c=[];return i(a,function(a,d,e){c.push(b(a,d,e))}),c},k=function(a,b,c){return a.reduce?a.reduce(b,c):(i(a,function(a,d,e){c=b(c,a,d,e)}),c)},l=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"!=typeof a&&a.nextTick?(f.nextTick=a.nextTick,f.setImmediate="undefined"!=typeof setImmediate?function(a){setImmediate(a)}:f.nextTick):"function"==typeof setImmediate?(f.nextTick=function(a){setImmediate(a)},f.setImmediate=f.nextTick):(f.nextTick=function(a){setTimeout(a,0)},f.setImmediate=f.nextTick),f.each=function(a,b,d){function e(b){b?(d(b),d=function(){}):(f+=1,f>=a.length&&d())}if(d=d||function(){},!a.length)return d();var f=0;i(a,function(a){b(a,c(e))})},f.forEach=f.each,f.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})};e()},f.forEachSeries=f.eachSeries,f.eachLimit=function(a,b,c,d){var e=m(b);e.apply(null,[a,c,d])},f.forEachLimit=f.eachLimit;var m=function(a){return function(b,c,d){if(d=d||function(){},!b.length||0>=a)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;a>g&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},n=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[f.each].concat(b))}},o=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[m(a)].concat(c))}},p=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[f.eachSeries].concat(b))}},q=function(a,b,c,d){var e=[];b=j(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})};f.map=n(q),f.mapSeries=p(q),f.mapLimit=function(a,b,c,d){return r(b)(a,c,d)};var r=function(a){return o(a,q)};f.reduce=function(a,b,c,d){f.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){d(a,b)})},f.inject=f.reduce,f.foldl=f.reduce,f.reduceRight=function(a,b,c,d){var e=j(a,function(a){return a}).reverse();f.reduce(e,b,c,d)},f.foldr=f.reduceRight;var s=function(a,b,c,d){var e=[];b=j(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(){d(j(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};f.filter=n(s),f.filterSeries=p(s),f.select=f.filter,f.selectSeries=f.filterSeries;var t=function(a,b,c,d){var e=[];b=j(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(){d(j(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};f.reject=n(t),f.rejectSeries=p(t);var u=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(){d()})};f.detect=n(u),f.detectSeries=p(u),f.some=function(a,b,c){f.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(){c(!1)})},f.any=f.some,f.every=function(a,b,c){f.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(){c(!0)})},f.all=f.every,f.sortBy=function(a,b,c){f.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0};c(null,j(b.sort(d),function(a){return a.value}))})},f.auto=function(a,b){b=b||function(){};var c=l(a),d=c.length;if(!d)return b();var e={},g=[],j=function(a){g.unshift(a)},m=function(a){for(var b=0;b<g.length;b+=1)if(g[b]===a)return void g.splice(b,1)},n=function(){d--,i(g.slice(0),function(a){a()})};j(function(){if(!d){var a=b;b=function(){},a(null,e)}}),i(c,function(c){var d=h(a[c])?a[c]:[a[c]],g=function(a){var d=Array.prototype.slice.call(arguments,1);if(d.length<=1&&(d=d[0]),a){var g={};i(l(e),function(a){g[a]=e[a]}),g[c]=d,b(a,g),b=function(){}}else e[c]=d,f.setImmediate(n)},o=d.slice(0,Math.abs(d.length-1))||[],p=function(){return k(o,function(a,b){return a&&e.hasOwnProperty(b)},!0)&&!e.hasOwnProperty(c)};if(p())d[d.length-1](g,e);else{var q=function(){p()&&(m(q),d[d.length-1](g,e))};j(q)}})},f.retry=function(a,b,c){var d=5,e=[];"function"==typeof a&&(c=b,b=a,a=d),a=parseInt(a,10)||d;var g=function(d,g){for(var h=function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},g)}};a;)e.push(h(b,!(a-=1)));f.series(e,function(a,b){b=b[b.length-1],(d||c)(b.err,b.result)})};return c?g():g},f.waterfall=function(a,b){if(b=b||function(){},!h(a)){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();var d=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var e=Array.prototype.slice.call(arguments,1),g=a.next();e.push(g?d(g):b),f.setImmediate(function(){a.apply(null,e)})}}};d(f.iterator(a))()};var v=function(a,b,c){if(c=c||function(){},h(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(l(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};f.parallel=function(a,b){v({map:f.map,each:f.each},a,b)},f.parallelLimit=function(a,b,c){v({map:r(b),each:m(b)},a,c)},f.series=function(a,b){if(b=b||function(){},h(a))f.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};f.eachSeries(l(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},f.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},f.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var w=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};f.concat=n(w),f.concatSeries=p(w),f.whilst=function(a,b,c){a()?b(function(d){return d?c(d):void f.whilst(a,b,c)}):c()},f.doWhilst=function(a,b,c){a(function(d){if(d)return c(d);var e=Array.prototype.slice.call(arguments,1);b.apply(null,e)?f.doWhilst(a,b,c):c()})},f.until=function(a,b,c){a()?c():b(function(d){return d?c(d):void f.until(a,b,c)})},f.doUntil=function(a,b,c){a(function(d){if(d)return c(d);var e=Array.prototype.slice.call(arguments,1);b.apply(null,e)?c():f.doUntil(a,b,c)})},f.queue=function(a,b){function d(a,b,c,d){return a.started||(a.started=!0),h(b)||(b=[b]),0==b.length?f.setImmediate(function(){a.drain&&a.drain()}):void i(b,function(b){var e={data:b,callback:"function"==typeof d?d:null};c?a.tasks.unshift(e):a.tasks.push(e),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),f.setImmediate(a.process)})}void 0===b&&(b=1);var e=0,g={tasks:[],concurrency:b,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(a,b){d(g,a,!1,b)},kill:function(){g.drain=null,g.tasks=[]},unshift:function(a,b){d(g,a,!0,b)},process:function(){if(!g.paused&&e<g.concurrency&&g.tasks.length){var b=g.tasks.shift();g.empty&&0===g.tasks.length&&g.empty(),e+=1;var d=function(){e-=1,b.callback&&b.callback.apply(b,arguments),g.drain&&g.tasks.length+e===0&&g.drain(),g.process()},f=c(d);a(b.data,f)}},length:function(){return g.tasks.length},running:function(){return e},idle:function(){return g.tasks.length+e===0},pause:function(){g.paused!==!0&&(g.paused=!0,g.process())},resume:function(){g.paused!==!1&&(g.paused=!1,g.process())}};return g},f.cargo=function(a,b){var c=!1,d=[],e={tasks:d,payload:b,saturated:null,empty:null,drain:null,drained:!0,push:function(a,c){h(a)||(a=[a]),i(a,function(a){d.push({data:a,callback:"function"==typeof c?c:null}),e.drained=!1,e.saturated&&d.length===b&&e.saturated()}),f.setImmediate(e.process)},process:function g(){if(!c){if(0===d.length)return e.drain&&!e.drained&&e.drain(),void(e.drained=!0);var f="number"==typeof b?d.splice(0,b):d.splice(0,d.length),h=j(f,function(a){return a.data});e.empty&&e.empty(),c=!0,a(h,function(){c=!1;var a=arguments;i(f,function(b){b.callback&&b.callback.apply(null,a)}),g()})}},length:function(){return d.length},running:function(){return c}};return e};var x=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&i(c,function(b){console[a](b)}))}]))}};f.log=x("log"),f.dir=x("dir"),f.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),g=e.pop(),h=b.apply(null,e);h in c?f.nextTick(function(){g.apply(null,c[h])}):h in d?d[h].push(g):(d[h]=[g],a.apply(null,e.concat([function(){c[h]=arguments;var a=d[h];delete d[h];for(var b=0,e=a.length;e>b;b++)a[b].apply(null,arguments)}])))};return e.memo=c,e.unmemoized=a,e},f.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},f.times=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return f.map(d,b,c)},f.timesSeries=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return f.mapSeries(d,b,c)},f.seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),d=c.pop();f.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){d.apply(b,[a].concat(c))})}},f.compose=function(){return f.seq.apply(null,Array.prototype.reverse.call(arguments))};var y=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};f.applyEach=n(y),f.applyEachSeries=p(y),f.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},"undefined"!=typeof b&&b.exports?b.exports=f:"undefined"!=typeof define&&define.amd?define([],function(){return f}):d.async=f}()}).call(this,a("+xKvab"))},{"+xKvab":29}],8:[function(){},{}],9:[function(a,b){function c(a,b){return m.isUndefined(b)?""+b:!m.isNumber(b)||!isNaN(b)&&isFinite(b)?m.isFunction(b)||m.isRegExp(b)?b.toString():b:b.toString()}function d(a,b){return m.isString(a)?a.length<b?a:a.slice(0,b):a}function e(a){return d(JSON.stringify(a.actual,c),128)+" "+a.operator+" "+d(JSON.stringify(a.expected,c),128)}function f(a,b,c,d,e){throw new p.AssertionError({message:c,actual:a,expected:b,operator:d,stackStartFunction:e})}function g(a,b){a||f(a,!0,b,"==",p.ok)}function h(a,b){if(a===b)return!0;if(m.isBuffer(a)&&m.isBuffer(b)){if(a.length!=b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return m.isDate(a)&&m.isDate(b)?a.getTime()===b.getTime():m.isRegExp(a)&&m.isRegExp(b)?a.source===b.source&&a.global===b.global&&a.multiline===b.multiline&&a.lastIndex===b.lastIndex&&a.ignoreCase===b.ignoreCase:m.isObject(a)||m.isObject(b)?j(a,b):a==b}function i(a){return"[object Arguments]"==Object.prototype.toString.call(a)}function j(a,b){if(m.isNullOrUndefined(a)||m.isNullOrUndefined(b))return!1;if(a.prototype!==b.prototype)return!1;if(i(a))return i(b)?(a=n.call(a),b=n.call(b),h(a,b)):!1;try{var c,d,e=q(a),f=q(b)}catch(g){return!1}if(e.length!=f.length)return!1;for(e.sort(),f.sort(),d=e.length-1;d>=0;d--)if(e[d]!=f[d])return!1;for(d=e.length-1;d>=0;d--)if(c=e[d],!h(a[c],b[c]))return!1;return!0}function k(a,b){return a&&b?"[object RegExp]"==Object.prototype.toString.call(b)?b.test(a):a instanceof b?!0:b.call({},a)===!0?!0:!1:!1}function l(a,b,c,d){var e;m.isString(c)&&(d=c,c=null);try{b()}catch(g){e=g}if(d=(c&&c.name?" ("+c.name+").":".")+(d?" "+d:"."),a&&!e&&f(e,c,"Missing expected exception"+d),!a&&k(e,c)&&f(e,c,"Got unwanted exception"+d),a&&e&&c&&!k(e,c)||!a&&e)throw e}var m=a("util/"),n=Array.prototype.slice,o=Object.prototype.hasOwnProperty,p=b.exports=g;p.AssertionError=function(a){this.name="AssertionError",this.actual=a.actual,this.expected=a.expected,this.operator=a.operator,a.message?(this.message=a.message,this.generatedMessage=!1):(this.message=e(this),this.generatedMessage=!0);var b=a.stackStartFunction||f;if(Error.captureStackTrace)Error.captureStackTrace(this,b);else{var c=new Error;if(c.stack){var d=c.stack,g=b.name,h=d.indexOf("\n"+g);if(h>=0){var i=d.indexOf("\n",h+1);d=d.substring(i+1)}this.stack=d}}},m.inherits(p.AssertionError,Error),p.fail=f,p.ok=g,p.equal=function(a,b,c){a!=b&&f(a,b,c,"==",p.equal)},p.notEqual=function(a,b,c){a==b&&f(a,b,c,"!=",p.notEqual)},p.deepEqual=function(a,b,c){h(a,b)||f(a,b,c,"deepEqual",p.deepEqual)},p.notDeepEqual=function(a,b,c){h(a,b)&&f(a,b,c,"notDeepEqual",p.notDeepEqual)},p.strictEqual=function(a,b,c){a!==b&&f(a,b,c,"===",p.strictEqual)},p.notStrictEqual=function(a,b,c){a===b&&f(a,b,c,"!==",p.notStrictEqual)},p.throws=function(){l.apply(this,[!0].concat(n.call(arguments)))},p.doesNotThrow=function(){l.apply(this,[!1].concat(n.call(arguments)))},p.ifError=function(a){if(a)throw a};var q=Object.keys||function(a){var b=[];for(var c in a)o.call(a,c)&&b.push(c);return b}},{"util/":11}],10:[function(a,b){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],11:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("+xKvab"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"+xKvab":29,"./support/isBuffer":10,inherits:27}],12:[function(a,b){b.exports=a(8)},{}],13:[function(a,b,c){function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);var e=typeof a;if("base64"===b&&"string"===e)for(a=C(a);a.length%4!==0;)a+="=";var f;if("number"===e)f=E(a);else if("string"===e)f=d.byteLength(a,b);else{if("object"!==e)throw new Error("First argument needs to be a number, array or string.");f=E(a.length)}var g;d._useTypedArrays?g=d._augment(new Uint8Array(f)):(g=this,g.length=f,g._isBuffer=!0);var h;if(d._useTypedArrays&&"number"==typeof a.byteLength)g._set(a);else if(G(a))if(d.isBuffer(a))for(h=0;f>h;h++)g[h]=a.readUInt8(h);else for(h=0;f>h;h++)g[h]=(a[h]%256+256)%256;else if("string"===e)g.write(a,0,b);else if("number"===e&&!d._useTypedArrays&&!c)for(h=0;f>h;h++)g[h]=0;return g}function e(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;R(f%2===0,"Invalid hex string"),d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);R(!isNaN(h),"Invalid hex string"),a[c+g]=h}return g}function f(a,b,c,d){var e=M(I(b),a,c,d);return e}function g(a,b,c,d){var e=M(J(b),a,c,d);return e}function h(a,b,c,d){return g(a,b,c,d)}function i(a,b,c,d){var e=M(L(b),a,c,d);return e}function j(a,b,c,d){var e=M(K(b),a,c,d);return e}function k(a,b,c){return S.fromByteArray(0===b&&c===a.length?a:a.slice(b,c))}function l(a,b,c){var d="",e="";c=Math.min(a.length,c);for(var f=b;c>f;f++)a[f]<=127?(d+=N(e)+String.fromCharCode(a[f]),e=""):e+="%"+a[f].toString(16);return d+N(e)}function m(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function n(a,b,c){return m(a,b,c)}function o(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=H(a[f]);return e}function p(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function q(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f;return c?(f=a[b],e>b+1&&(f|=a[b+1]<<8)):(f=a[b]<<8,e>b+1&&(f|=a[b+1])),f}}function r(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f;return c?(e>b+2&&(f=a[b+2]<<16),e>b+1&&(f|=a[b+1]<<8),f|=a[b],e>b+3&&(f+=a[b+3]<<24>>>0)):(e>b+1&&(f=a[b+1]<<16),e>b+2&&(f|=a[b+2]<<8),e>b+3&&(f|=a[b+3]),f+=a[b]<<24>>>0),f}}function s(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f=q(a,b,c,!0),g=32768&f;return g?-1*(65535-f+1):f}}function t(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f=r(a,b,c,!0),g=2147483648&f;return g?-1*(4294967295-f+1):f}}function u(a,b,c,d){return d||(R("boolean"==typeof c,"missing or invalid endian"),R(b+3<a.length,"Trying to read beyond buffer length")),T.read(a,b,c,23,4)}function v(a,b,c,d){return d||(R("boolean"==typeof c,"missing or invalid endian"),R(b+7<a.length,"Trying to read beyond buffer length")),T.read(a,b,c,52,8)}function w(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+1<a.length,"trying to write beyond buffer length"),O(b,65535));var f=a.length;if(!(c>=f)){for(var g=0,h=Math.min(f-c,2);h>g;g++)a[c+g]=(b&255<<8*(d?g:1-g))>>>8*(d?g:1-g);return c+2}}function x(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+3<a.length,"trying to write beyond buffer length"),O(b,4294967295));var f=a.length;if(!(c>=f)){for(var g=0,h=Math.min(f-c,4);h>g;g++)a[c+g]=b>>>8*(d?g:3-g)&255;return c+4}}function y(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+1<a.length,"Trying to write beyond buffer length"),P(b,32767,-32768));var f=a.length;if(!(c>=f))return b>=0?w(a,b,c,d,e):w(a,65535+b+1,c,d,e),c+2}function z(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+3<a.length,"Trying to write beyond buffer length"),P(b,2147483647,-2147483648));var f=a.length;if(!(c>=f))return b>=0?x(a,b,c,d,e):x(a,4294967295+b+1,c,d,e),c+4}function A(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+3<a.length,"Trying to write beyond buffer length"),Q(b,3.4028234663852886e38,-3.4028234663852886e38));var f=a.length;if(!(c>=f))return T.write(a,b,c,d,23,4),c+4}function B(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+7<a.length,"Trying to write beyond buffer length"),Q(b,1.7976931348623157e308,-1.7976931348623157e308));var f=a.length;if(!(c>=f))return T.write(a,b,c,d,52,8),c+8}function C(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function D(a,b,c){return"number"!=typeof a?c:(a=~~a,a>=b?b:a>=0?a:(a+=b,a>=0?a:0))}function E(a){return a=~~Math.ceil(+a),0>a?0:a}function F(a){return(Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)})(a)}function G(a){return F(a)||d.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length}function H(a){return 16>a?"0"+a.toString(16):a.toString(16)}function I(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);if(127>=d)b.push(d);else{var e=c;d>=55296&&57343>=d&&c++;for(var f=encodeURIComponent(a.slice(e,c+1)).substr(1).split("%"),g=0;g<f.length;g++)b.push(parseInt(f[g],16))}}return b}function J(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function K(a){for(var b,c,d,e=[],f=0;f<a.length;f++)b=a.charCodeAt(f),c=b>>8,d=b%256,e.push(d),e.push(c);return e}function L(a){return S.toByteArray(a)}function M(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function N(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}function O(a,b){R("number"==typeof a,"cannot write a non-number as a number"),R(a>=0,"specified a negative value for writing an unsigned value"),R(b>=a,"value is larger than maximum value for type"),R(Math.floor(a)===a,"value has a fractional component")}function P(a,b,c){R("number"==typeof a,"cannot write a non-number as a number"),R(b>=a,"value larger than maximum allowed value"),R(a>=c,"value smaller than minimum allowed value"),R(Math.floor(a)===a,"value has a fractional component")}function Q(a,b,c){R("number"==typeof a,"cannot write a non-number as a number"),R(b>=a,"value larger than maximum allowed value"),R(a>=c,"value smaller than minimum allowed value")}function R(a,b){if(!a)throw new Error(b||"Failed assertion")}var S=a("base64-js"),T=a("ieee754");c.Buffer=d,c.SlowBuffer=d,c.INSPECT_MAX_BYTES=50,d.poolSize=8192,d._useTypedArrays=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);return b.foo=function(){return 42},42===b.foo()&&"function"==typeof b.subarray}catch(c){return!1}}(),d.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.isBuffer=function(a){return!(null===a||void 0===a||!a._isBuffer)},d.byteLength=function(a,b){var c;switch(a=a.toString(),b||"utf8"){case"hex":c=a.length/2;break;case"utf8":case"utf-8":c=I(a).length;break;case"ascii":case"binary":case"raw":c=a.length;break;case"base64":c=L(a).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":c=2*a.length;break;default:throw new Error("Unknown encoding")}return c},d.concat=function(a,b){if(R(F(a),"Usage: Buffer.concat(list[, length])"),0===a.length)return new d(0);if(1===a.length)return a[0];var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var e=new d(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(e,f),f+=g.length}return e},d.compare=function(a,b){R(d.isBuffer(a)&&d.isBuffer(b),"Arguments must be Buffers");for(var c=a.length,e=b.length,f=0,g=Math.min(c,e);g>f&&a[f]===b[f];f++);return f!==g&&(c=a[f],e=b[f]),e>c?-1:c>e?1:0},d.prototype.write=function(a,b,c,d){if(isFinite(b))isFinite(c)||(d=c,c=void 0);else{var k=d;d=b,b=c,c=k}b=Number(b)||0;var l=this.length-b;c?(c=Number(c),c>l&&(c=l)):c=l,d=String(d||"utf8").toLowerCase();var m;switch(d){case"hex":m=e(this,a,b,c);break;case"utf8":case"utf-8":m=f(this,a,b,c);break;case"ascii":m=g(this,a,b,c);break;case"binary":m=h(this,a,b,c);break;case"base64":m=i(this,a,b,c);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":m=j(this,a,b,c);break;default:throw new Error("Unknown encoding")}return m},d.prototype.toString=function(a,b,c){var d=this;if(a=String(a||"utf8").toLowerCase(),b=Number(b)||0,c=void 0===c?d.length:Number(c),c===b)return"";var e;switch(a){case"hex":e=o(d,b,c);break;case"utf8":case"utf-8":e=l(d,b,c);break;case"ascii":e=m(d,b,c);break;case"binary":e=n(d,b,c);break;case"base64":e=k(d,b,c);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":e=p(d,b,c);break;default:throw new Error("Unknown encoding")}return e},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.equals=function(a){return R(d.isBuffer(a),"Argument must be a Buffer"),0===d.compare(this,a)},d.prototype.compare=function(a){return R(d.isBuffer(a),"Argument must be a Buffer"),d.compare(this,a)},d.prototype.copy=function(a,b,c,e){var f=this;if(c||(c=0),e||0===e||(e=this.length),b||(b=0),e!==c&&0!==a.length&&0!==f.length){R(e>=c,"sourceEnd < sourceStart"),R(b>=0&&b<a.length,"targetStart out of bounds"),R(c>=0&&c<f.length,"sourceStart out of bounds"),R(e>=0&&e<=f.length,"sourceEnd out of bounds"),e>this.length&&(e=this.length),a.length-b<e-c&&(e=a.length-b+c);
var g=e-c;if(100>g||!d._useTypedArrays)for(var h=0;g>h;h++)a[h+b]=this[h+c];else a._set(this.subarray(c,c+g),b)}},d.prototype.slice=function(a,b){var c=this.length;if(a=D(a,c,0),b=D(b,c,c),d._useTypedArrays)return d._augment(this.subarray(a,b));for(var e=b-a,f=new d(e,void 0,!0),g=0;e>g;g++)f[g]=this[g+a];return f},d.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},d.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},d.prototype.readUInt8=function(a,b){return b||(R(void 0!==a&&null!==a,"missing offset"),R(a<this.length,"Trying to read beyond buffer length")),a>=this.length?void 0:this[a]},d.prototype.readUInt16LE=function(a,b){return q(this,a,!0,b)},d.prototype.readUInt16BE=function(a,b){return q(this,a,!1,b)},d.prototype.readUInt32LE=function(a,b){return r(this,a,!0,b)},d.prototype.readUInt32BE=function(a,b){return r(this,a,!1,b)},d.prototype.readInt8=function(a,b){if(b||(R(void 0!==a&&null!==a,"missing offset"),R(a<this.length,"Trying to read beyond buffer length")),!(a>=this.length)){var c=128&this[a];return c?-1*(255-this[a]+1):this[a]}},d.prototype.readInt16LE=function(a,b){return s(this,a,!0,b)},d.prototype.readInt16BE=function(a,b){return s(this,a,!1,b)},d.prototype.readInt32LE=function(a,b){return t(this,a,!0,b)},d.prototype.readInt32BE=function(a,b){return t(this,a,!1,b)},d.prototype.readFloatLE=function(a,b){return u(this,a,!0,b)},d.prototype.readFloatBE=function(a,b){return u(this,a,!1,b)},d.prototype.readDoubleLE=function(a,b){return v(this,a,!0,b)},d.prototype.readDoubleBE=function(a,b){return v(this,a,!1,b)},d.prototype.writeUInt8=function(a,b,c){return c||(R(void 0!==a&&null!==a,"missing value"),R(void 0!==b&&null!==b,"missing offset"),R(b<this.length,"trying to write beyond buffer length"),O(a,255)),b>=this.length?void 0:(this[b]=a,b+1)},d.prototype.writeUInt16LE=function(a,b,c){return w(this,a,b,!0,c)},d.prototype.writeUInt16BE=function(a,b,c){return w(this,a,b,!1,c)},d.prototype.writeUInt32LE=function(a,b,c){return x(this,a,b,!0,c)},d.prototype.writeUInt32BE=function(a,b,c){return x(this,a,b,!1,c)},d.prototype.writeInt8=function(a,b,c){return c||(R(void 0!==a&&null!==a,"missing value"),R(void 0!==b&&null!==b,"missing offset"),R(b<this.length,"Trying to write beyond buffer length"),P(a,127,-128)),b>=this.length?void 0:(a>=0?this.writeUInt8(a,b,c):this.writeUInt8(255+a+1,b,c),b+1)},d.prototype.writeInt16LE=function(a,b,c){return y(this,a,b,!0,c)},d.prototype.writeInt16BE=function(a,b,c){return y(this,a,b,!1,c)},d.prototype.writeInt32LE=function(a,b,c){return z(this,a,b,!0,c)},d.prototype.writeInt32BE=function(a,b,c){return z(this,a,b,!1,c)},d.prototype.writeFloatLE=function(a,b,c){return A(this,a,b,!0,c)},d.prototype.writeFloatBE=function(a,b,c){return A(this,a,b,!1,c)},d.prototype.writeDoubleLE=function(a,b,c){return B(this,a,b,!0,c)},d.prototype.writeDoubleBE=function(a,b,c){return B(this,a,b,!1,c)},d.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),R(c>=b,"end < start"),c!==b&&0!==this.length){R(b>=0&&b<this.length,"start out of bounds"),R(c>=0&&c<=this.length,"end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=I(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},d.prototype.inspect=function(){for(var a=[],b=this.length,d=0;b>d;d++)if(a[d]=H(this[d]),d===c.INSPECT_MAX_BYTES){a[d+1]="...";break}return"<Buffer "+a.join(" ")+">"},d.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(d._useTypedArrays)return new d(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var U=d.prototype;d._augment=function(a){return a._isBuffer=!0,a._get=a.get,a._set=a.set,a.get=U.get,a.set=U.set,a.write=U.write,a.toString=U.toString,a.toLocaleString=U.toString,a.toJSON=U.toJSON,a.equals=U.equals,a.compare=U.compare,a.copy=U.copy,a.slice=U.slice,a.readUInt8=U.readUInt8,a.readUInt16LE=U.readUInt16LE,a.readUInt16BE=U.readUInt16BE,a.readUInt32LE=U.readUInt32LE,a.readUInt32BE=U.readUInt32BE,a.readInt8=U.readInt8,a.readInt16LE=U.readInt16LE,a.readInt16BE=U.readInt16BE,a.readInt32LE=U.readInt32LE,a.readInt32BE=U.readInt32BE,a.readFloatLE=U.readFloatLE,a.readFloatBE=U.readFloatBE,a.readDoubleLE=U.readDoubleLE,a.readDoubleBE=U.readDoubleBE,a.writeUInt8=U.writeUInt8,a.writeUInt16LE=U.writeUInt16LE,a.writeUInt16BE=U.writeUInt16BE,a.writeUInt32LE=U.writeUInt32LE,a.writeUInt32BE=U.writeUInt32BE,a.writeInt8=U.writeInt8,a.writeInt16LE=U.writeInt16LE,a.writeInt16BE=U.writeInt16BE,a.writeInt32LE=U.writeInt32LE,a.writeInt32BE=U.writeInt32BE,a.writeFloatLE=U.writeFloatLE,a.writeFloatBE=U.writeFloatBE,a.writeDoubleLE=U.writeDoubleLE,a.writeDoubleBE=U.writeDoubleBE,a.fill=U.fill,a.inspect=U.inspect,a.toArrayBuffer=U.toArrayBuffer,a}},{"base64-js":14,ieee754:15}],14:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g?62:b===h?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],15:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?0/0:1/0*(n?-1:1);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||1/0===b?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],16:[function(a,b){function c(a,b){if(a.length%g!==0){var c=a.length+(g-a.length%g);a=f.concat([a,h],c)}for(var d=[],e=b?a.readInt32BE:a.readInt32LE,i=0;i<a.length;i+=g)d.push(e.call(a,i));return d}function d(a,b,c){for(var d=new f(b),e=c?d.writeInt32BE:d.writeInt32LE,g=0;g<a.length;g++)e.call(d,a[g],4*g,!0);return d}function e(a,b,e,g){f.isBuffer(a)||(a=new f(a));var h=b(c(a,g),a.length*i);return d(h,e,g)}var f=a("buffer").Buffer,g=4,h=new f(g);h.fill(0);var i=8;b.exports={hash:e}},{buffer:13}],17:[function(a,b,c){function d(a,b,c){h.isBuffer(b)||(b=new h(b)),h.isBuffer(c)||(c=new h(c)),b.length>n?b=a(b):b.length<n&&(b=h.concat([b,o],n));for(var d=new h(n),e=new h(n),f=0;n>f;f++)d[f]=54^b[f],e[f]=92^b[f];var g=a(h.concat([d,c]));return a(h.concat([e,g]))}function e(a,b){a=a||"sha1";var c=m[a],e=[],g=0;return c||f("algorithm:",a,"is not yet supported"),{update:function(a){return h.isBuffer(a)||(a=new h(a)),e.push(a),g+=a.length,this},digest:function(a){var f=h.concat(e),g=b?d(c,b,f):c(f);return e=null,a?g.toString(a):g}}}function f(){var a=[].slice.call(arguments).join(" ");throw new Error([a,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function g(a,b){for(var c in a)b(a[c],c)}var h=a("buffer").Buffer,i=a("./sha"),j=a("./sha256"),k=a("./rng"),l=a("./md5"),m={sha1:i,sha256:j,md5:l},n=64,o=new h(n);o.fill(0),c.createHash=function(a){return e(a)},c.createHmac=function(a,b){return e(a,b)},c.randomBytes=function(a,b){if(!b||!b.call)return new h(k(a));try{b.call(this,void 0,new h(k(a)))}catch(c){b(c)}},g(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(a){c[a]=function(){f("sorry,",a,"is not implemented yet")}})},{"./md5":18,"./rng":19,"./sha":20,"./sha256":21,buffer:13}],18:[function(a,b){function c(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,j=-1732584194,k=271733878,l=0;l<a.length;l+=16){var m=c,n=d,o=j,p=k;c=e(c,d,j,k,a[l+0],7,-680876936),k=e(k,c,d,j,a[l+1],12,-389564586),j=e(j,k,c,d,a[l+2],17,606105819),d=e(d,j,k,c,a[l+3],22,-1044525330),c=e(c,d,j,k,a[l+4],7,-176418897),k=e(k,c,d,j,a[l+5],12,1200080426),j=e(j,k,c,d,a[l+6],17,-1473231341),d=e(d,j,k,c,a[l+7],22,-45705983),c=e(c,d,j,k,a[l+8],7,1770035416),k=e(k,c,d,j,a[l+9],12,-1958414417),j=e(j,k,c,d,a[l+10],17,-42063),d=e(d,j,k,c,a[l+11],22,-1990404162),c=e(c,d,j,k,a[l+12],7,1804603682),k=e(k,c,d,j,a[l+13],12,-40341101),j=e(j,k,c,d,a[l+14],17,-1502002290),d=e(d,j,k,c,a[l+15],22,1236535329),c=f(c,d,j,k,a[l+1],5,-165796510),k=f(k,c,d,j,a[l+6],9,-1069501632),j=f(j,k,c,d,a[l+11],14,643717713),d=f(d,j,k,c,a[l+0],20,-373897302),c=f(c,d,j,k,a[l+5],5,-701558691),k=f(k,c,d,j,a[l+10],9,38016083),j=f(j,k,c,d,a[l+15],14,-660478335),d=f(d,j,k,c,a[l+4],20,-405537848),c=f(c,d,j,k,a[l+9],5,568446438),k=f(k,c,d,j,a[l+14],9,-1019803690),j=f(j,k,c,d,a[l+3],14,-187363961),d=f(d,j,k,c,a[l+8],20,1163531501),c=f(c,d,j,k,a[l+13],5,-1444681467),k=f(k,c,d,j,a[l+2],9,-51403784),j=f(j,k,c,d,a[l+7],14,1735328473),d=f(d,j,k,c,a[l+12],20,-1926607734),c=g(c,d,j,k,a[l+5],4,-378558),k=g(k,c,d,j,a[l+8],11,-2022574463),j=g(j,k,c,d,a[l+11],16,1839030562),d=g(d,j,k,c,a[l+14],23,-35309556),c=g(c,d,j,k,a[l+1],4,-1530992060),k=g(k,c,d,j,a[l+4],11,1272893353),j=g(j,k,c,d,a[l+7],16,-155497632),d=g(d,j,k,c,a[l+10],23,-1094730640),c=g(c,d,j,k,a[l+13],4,681279174),k=g(k,c,d,j,a[l+0],11,-358537222),j=g(j,k,c,d,a[l+3],16,-722521979),d=g(d,j,k,c,a[l+6],23,76029189),c=g(c,d,j,k,a[l+9],4,-640364487),k=g(k,c,d,j,a[l+12],11,-421815835),j=g(j,k,c,d,a[l+15],16,530742520),d=g(d,j,k,c,a[l+2],23,-995338651),c=h(c,d,j,k,a[l+0],6,-198630844),k=h(k,c,d,j,a[l+7],10,1126891415),j=h(j,k,c,d,a[l+14],15,-1416354905),d=h(d,j,k,c,a[l+5],21,-57434055),c=h(c,d,j,k,a[l+12],6,1700485571),k=h(k,c,d,j,a[l+3],10,-1894986606),j=h(j,k,c,d,a[l+10],15,-1051523),d=h(d,j,k,c,a[l+1],21,-2054922799),c=h(c,d,j,k,a[l+8],6,1873313359),k=h(k,c,d,j,a[l+15],10,-30611744),j=h(j,k,c,d,a[l+6],15,-1560198380),d=h(d,j,k,c,a[l+13],21,1309151649),c=h(c,d,j,k,a[l+4],6,-145523070),k=h(k,c,d,j,a[l+11],10,-1120210379),j=h(j,k,c,d,a[l+2],15,718787259),d=h(d,j,k,c,a[l+9],21,-343485551),c=i(c,m),d=i(d,n),j=i(j,o),k=i(k,p)}return Array(c,d,j,k)}function d(a,b,c,d,e,f){return i(j(i(i(b,a),i(d,f)),e),c)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function j(a,b){return a<<b|a>>>32-b}var k=a("./helpers");b.exports=function(a){return k.hash(a,c,16)}},{"./helpers":16}],19:[function(a,b){!function(){var a,c,d=this;a=function(a){for(var b,b,c=new Array(a),d=0;a>d;d++)0==(3&d)&&(b=4294967296*Math.random()),c[d]=b>>>((3&d)<<3)&255;return c},d.crypto&&crypto.getRandomValues&&(c=function(a){var b=new Uint8Array(a);return crypto.getRandomValues(b),b}),b.exports=c||a}()},{}],20:[function(a,b){function c(a,b){a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;for(var c=Array(80),h=1732584193,i=-271733879,j=-1732584194,k=271733878,l=-1009589776,m=0;m<a.length;m+=16){for(var n=h,o=i,p=j,q=k,r=l,s=0;80>s;s++){c[s]=16>s?a[m+s]:g(c[s-3]^c[s-8]^c[s-14]^c[s-16],1);var t=f(f(g(h,5),d(s,i,j,k)),f(f(l,c[s]),e(s)));l=k,k=j,j=g(i,30),i=h,h=t}h=f(h,n),i=f(i,o),j=f(j,p),k=f(k,q),l=f(l,r)}return Array(h,i,j,k,l)}function d(a,b,c,d){return 20>a?b&c|~b&d:40>a?b^c^d:60>a?b&c|b&d|c&d:b^c^d}function e(a){return 20>a?1518500249:40>a?1859775393:60>a?-1894007588:-899497514}function f(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function g(a,b){return a<<b|a>>>32-b}var h=a("./helpers");b.exports=function(a){return h.hash(a,c,20,!0)}},{"./helpers":16}],21:[function(a,b){var c=a("./helpers"),d=function(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c},e=function(a,b){return a>>>b|a<<32-b},f=function(a,b){return a>>>b},g=function(a,b,c){return a&b^~a&c},h=function(a,b,c){return a&b^a&c^b&c},i=function(a){return e(a,2)^e(a,13)^e(a,22)},j=function(a){return e(a,6)^e(a,11)^e(a,25)},k=function(a){return e(a,7)^e(a,18)^f(a,3)},l=function(a){return e(a,17)^e(a,19)^f(a,10)},m=function(a,b){var c,e,f,m,n,o,p,q,r,s,t,u,v=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),w=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),x=new Array(64);a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;for(var r=0;r<a.length;r+=16){c=w[0],e=w[1],f=w[2],m=w[3],n=w[4],o=w[5],p=w[6],q=w[7];for(var s=0;64>s;s++)x[s]=16>s?a[s+r]:d(d(d(l(x[s-2]),x[s-7]),k(x[s-15])),x[s-16]),t=d(d(d(d(q,j(n)),g(n,o,p)),v[s]),x[s]),u=d(i(c),h(c,e,f)),q=p,p=o,o=n,n=d(m,t),m=f,f=e,e=c,c=d(t,u);w[0]=d(c,w[0]),w[1]=d(e,w[1]),w[2]=d(f,w[2]),w[3]=d(m,w[3]),w[4]=d(n,w[4]),w[5]=d(o,w[5]),w[6]=d(p,w[6]),w[7]=d(q,w[7])}return w};b.exports=function(a){return c.hash(a,m,32,!0)}},{"./helpers":16}],22:[function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length))throw b=arguments[1],b instanceof Error?b:TypeError('Uncaught, unspecified "error" event.');if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];c.apply(this,h)}else if(f(c)){for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];for(j=c.slice(),e=j.length,i=0;e>i;i++)j[i].apply(this,h)}return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned){var e;e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d(a._events[b])?1:a._events[b].length:0}},{}],23:[function(a,b){var c=b.exports,d=(a("events").EventEmitter,a("./lib/request")),e=a("url");c.request=function(a,b){"string"==typeof a&&(a=e.parse(a)),a||(a={}),a.host||a.port||(a.port=parseInt(window.location.port,10)),!a.host&&a.hostname&&(a.host=a.hostname),a.scheme||(a.scheme=window.location.protocol.split(":")[0]),a.host||(a.host=window.location.hostname||window.location.host),/:/.test(a.host)&&(a.port||(a.port=a.host.split(":")[1]),a.host=a.host.split(":")[0]),a.port||(a.port="https"==a.scheme?443:80);var c=new d(new f,a);return b&&c.on("response",b),c},c.get=function(a,b){a.method="GET";var d=c.request(a,b);return d.end(),d},c.Agent=function(){},c.Agent.defaultMaxSockets=4;var f=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{var c=new window.ActiveXObject(a[b]);return function(){if(c){var d=c;return c=null,d}return new window.ActiveXObject(a[b])}}catch(d){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();c.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":24,events:22,url:48}],24:[function(a,b){var c=a("stream"),d=a("./response"),e=a("Base64"),f=a("inherits"),g=b.exports=function(a,b){var c=this;c.writable=!0,c.xhr=a,c.body=[],c.uri=(b.scheme||"http")+"://"+b.host+(b.port?":"+b.port:"")+(b.path||"/"),"undefined"==typeof b.withCredentials&&(b.withCredentials=!0);try{a.withCredentials=b.withCredentials}catch(f){}if(a.open(b.method||"GET",c.uri,!0),c._headers={},b.headers)for(var g=h(b.headers),i=0;i<g.length;i++){var j=g[i];if(c.isSafeRequestHeader(j)){var k=b.headers[j];c.setHeader(j,k)}}b.auth&&this.setHeader("Authorization","Basic "+e.btoa(b.auth));var l=new d;l.on("close",function(){c.emit("close")}),l.on("ready",function(){c.emit("response",l)}),a.onreadystatechange=function(){a.__aborted||l.handle(a)}};f(g,c),g.prototype.setHeader=function(a,b){this._headers[a.toLowerCase()]=b},g.prototype.getHeader=function(a){return this._headers[a.toLowerCase()]},g.prototype.removeHeader=function(a){delete this._headers[a.toLowerCase()]},g.prototype.write=function(a){this.body.push(a)},g.prototype.destroy=function(){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},g.prototype.end=function(a){void 0!==a&&this.body.push(a);for(var b=h(this._headers),c=0;c<b.length;c++){var d=b[c],e=this._headers[d];if(i(e))for(var f=0;f<e.length;f++)this.xhr.setRequestHeader(d,e[f]);else this.xhr.setRequestHeader(d,e)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(i(this.body[0])){for(var g=[],c=0;c<this.body.length;c++)g.push.apply(g,this.body[c]);this.xhr.send(g)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var j=0,c=0;c<this.body.length;c++)j+=this.body[c].length;for(var g=new this.body[0].constructor(j),k=0,c=0;c<this.body.length;c++)for(var l=this.body[c],f=0;f<l.length;f++)g[k++]=l[f];this.xhr.send(g)}else{for(var g="",c=0;c<this.body.length;c++)g+=this.body[c].toString();this.xhr.send(g)}},g.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],g.prototype.isSafeRequestHeader=function(a){return a?-1===j(g.unsafeHeaders,a.toLowerCase()):!1};var h=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},i=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},j=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}},{"./response":25,Base64:26,inherits:27,stream:47}],25:[function(a,b){function c(a){for(var b=a.getAllResponseHeaders().split(/\r?\n/),c={},d=0;d<b.length;d++){var e=b[d];if(""!==e){var f=e.match(/^([^:]+):\s*(.*)/);if(f){var g=f[1].toLowerCase(),i=f[2];void 0!==c[g]?h(c[g])?c[g].push(i):c[g]=[c[g],i]:c[g]=i}else c[e]=!0}}return c}var d=a("stream"),e=a("util"),f=b.exports=function(){this.offset=0,this.readable=!0};e.inherits(f,d);var g={streaming:!0,status2:!0};f.prototype.getResponse=function(a){var b=String(a.responseType).toLowerCase();return"blob"===b?a.responseBlob||a.response:"arraybuffer"===b?a.response:a.responseText},f.prototype.getHeader=function(a){return this.headers[a.toLowerCase()]},f.prototype.handle=function(a){if(2===a.readyState&&g.status2){try{this.statusCode=a.status,this.headers=c(a)}catch(b){g.status2=!1}g.status2&&this.emit("ready")}else if(g.streaming&&3===a.readyState){try{this.statusCode||(this.statusCode=a.status,this.headers=c(a),this.emit("ready"))}catch(b){}try{this._emitData(a)}catch(b){g.streaming=!1}}else 4===a.readyState&&(this.statusCode||(this.statusCode=a.status,this.emit("ready")),this._emitData(a),a.error?this.emit("error",this.getResponse(a)):this.emit("end"),this.emit("close"))},f.prototype._emitData=function(a){var b=this.getResponse(a);return b.toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(b,this.offset)),void(this.offset=b.byteLength)):void(b.length>this.offset&&(this.emit("data",b.slice(this.offset)),this.offset=b.length))};var h=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{stream:47,util:50}],26:[function(a,b,c){!function(){function a(a){this.message=a}var b="undefined"!=typeof c?c:this,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.prototype=new Error,a.prototype.name="InvalidCharacterError",b.btoa||(b.btoa=function(b){for(var c,e,f=0,g=d,h="";b.charAt(0|f)||(g="=",f%1);h+=g.charAt(63&c>>8-f%1*8)){if(e=b.charCodeAt(f+=.75),e>255)throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");c=c<<8|e}return h}),b.atob||(b.atob=function(b){if(b=b.replace(/=+$/,""),b.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var c,e,f=0,g=0,h="";e=b.charAt(g++);~e&&(c=f%4?64*c+e:e,f++%4)?h+=String.fromCharCode(255&c>>(-2*f&6)):0)e=d.indexOf(e);return h})}()},{}],27:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],28:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("+xKvab"))},{"+xKvab":29}],29:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],30:[function(a,b,c){(function(a){!function(d){function e(a){throw RangeError(H[a])}function f(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function g(a,b){return f(a.split(G),b).join(".")}function h(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function i(a){return f(a,function(a){var b="";return a>65535&&(a-=65536,b+=K(a>>>10&1023|55296),a=56320|1023&a),b+=K(a)}).join("")}function j(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:w}function k(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function l(a,b,c){var d=0;for(a=c?J(a/A):a>>1,a+=J(a/b);a>I*y>>1;d+=w)a=J(a/I);return J(d+(I+1)*a/(a+z))}function m(a){var b,c,d,f,g,h,k,m,n,o,p=[],q=a.length,r=0,s=C,t=B;for(c=a.lastIndexOf(D),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&e("not-basic"),p.push(a.charCodeAt(d));for(f=c>0?c+1:0;q>f;){for(g=r,h=1,k=w;f>=q&&e("invalid-input"),m=j(a.charCodeAt(f++)),(m>=w||m>J((v-r)/h))&&e("overflow"),r+=m*h,n=t>=k?x:k>=t+y?y:k-t,!(n>m);k+=w)o=w-n,h>J(v/o)&&e("overflow"),h*=o;b=p.length+1,t=l(r-g,b,0==g),J(r/b)>v-s&&e("overflow"),s+=J(r/b),r%=b,p.splice(r++,0,s)}return i(p)}function n(a){var b,c,d,f,g,i,j,m,n,o,p,q,r,s,t,u=[];for(a=h(a),q=a.length,b=C,c=0,g=B,i=0;q>i;++i)p=a[i],128>p&&u.push(K(p));for(d=f=u.length,f&&u.push(D);q>d;){for(j=v,i=0;q>i;++i)p=a[i],p>=b&&j>p&&(j=p);for(r=d+1,j-b>J((v-c)/r)&&e("overflow"),c+=(j-b)*r,b=j,i=0;q>i;++i)if(p=a[i],b>p&&++c>v&&e("overflow"),p==b){for(m=c,n=w;o=g>=n?x:n>=g+y?y:n-g,!(o>m);n+=w)t=m-o,s=w-o,u.push(K(k(o+t%s,0))),m=J(t/s);u.push(K(k(m,0))),g=l(c,r,d==f),c=0,++d}++c,++b}return u.join("")}function o(a){return g(a,function(a){return E.test(a)?m(a.slice(4).toLowerCase()):a})}function p(a){return g(a,function(a){return F.test(a)?"xn--"+n(a):a})}var q="object"==typeof c&&c,r="object"==typeof b&&b&&b.exports==q&&b,s="object"==typeof a&&a;(s.global===s||s.window===s)&&(d=s);var t,u,v=2147483647,w=36,x=1,y=26,z=38,A=700,B=72,C=128,D="-",E=/^xn--/,F=/[^ -~]/,G=/\x2E|\u3002|\uFF0E|\uFF61/g,H={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=w-x,J=Math.floor,K=String.fromCharCode;if(t={version:"1.2.4",ucs2:{decode:h,encode:i},decode:m,encode:n,toASCII:p,toUnicode:o},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return t});else if(q&&!q.nodeType)if(r)r.exports=t;else for(u in t)t.hasOwnProperty(u)&&(q[u]=t[u]);else d.punycode=t}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(a,b){"use strict";function c(a,b){return Object.prototype.hasOwnProperty.call(a,b)
}b.exports=function(a,b,e,f){b=b||"&",e=e||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(e);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),c(g,n)?d(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var d=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],32:[function(a,b){"use strict";function c(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var d=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,g,h){return b=b||"&",g=g||"=",null===a&&(a=void 0),"object"==typeof a?c(f(a),function(f){var h=encodeURIComponent(d(f))+g;return e(a[f])?c(a[f],function(a){return h+encodeURIComponent(d(a))}).join(b):h+encodeURIComponent(d(a[f]))}).join(b):h?encodeURIComponent(d(h))+g+encodeURIComponent(d(a)):""};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},f=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],33:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":31,"./encode":32}],34:[function(a,b){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":35}],35:[function(a,b){(function(c){function d(a){return this instanceof d?(i.call(this,a),j.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||c.nextTick(this.end.bind(this))}function f(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}b.exports=d;var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},h=a("core-util-is");h.inherits=a("inherits");var i=a("./_stream_readable"),j=a("./_stream_writable");h.inherits(d,i),f(g(j.prototype),function(a){d.prototype[a]||(d.prototype[a]=j.prototype[a])})}).call(this,a("+xKvab"))},{"+xKvab":29,"./_stream_readable":37,"./_stream_writable":39,"core-util-is":40,inherits:27}],36:[function(a,b){function c(a){return this instanceof c?void d.call(this,a):new c(a)}b.exports=c;var d=a("./_stream_transform"),e=a("core-util-is");e.inherits=a("inherits"),e.inherits(c,d),c.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":38,"core-util-is":40,inherits:27}],37:[function(a,b){(function(c){function d(b){b=b||{};var c=b.highWaterMark;this.highWaterMark=c||0===c?c:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!b.objectMode,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(C||(C=a("string_decoder/").StringDecoder),this.decoder=new C(b.encoding),this.encoding=b.encoding)}function e(a){return this instanceof e?(this._readableState=new d(a,this),this.readable=!0,void A.call(this)):new e(a)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c||void 0===c)b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):(b.reading=!1,b.buffer.push(c)),b.needReadable&&l(a),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=D)a=D;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:isNaN(a)||null===a?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return y.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||c||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,b.length>0?l(a):u(a)}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(b.emittedReadable=!0,b.sync?c.nextTick(function(){m(a)}):m(a))}function m(a){a.emit("readable")}function n(a,b){b.readingMore||(b.readingMore=!0,c.nextTick(function(){o(a,b)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;b.awaitDrain--,0===b.awaitDrain&&q(a)}}function q(a){function b(a){var b=a.write(c);!1===b&&d.awaitDrain++}var c,d=a._readableState;for(d.awaitDrain=0;d.pipesCount&&null!==(c=a.read());)if(1===d.pipesCount?b(d.pipes,0,null):v(d.pipes,b),a.emit("data",c),d.awaitDrain>0)return;return 0===d.pipesCount?(d.flowing=!1,void(z.listenerCount(a,"data")>0&&s(a))):void(d.ranOut=!0)}function r(){this._readableState.ranOut&&(this._readableState.ranOut=!1,q(this))}function s(a,b){var d=a._readableState;if(d.flowing)throw new Error("Cannot switch to old mode now.");var e=b||!1,f=!1;a.readable=!0,a.pipe=A.prototype.pipe,a.on=a.addListener=A.prototype.on,a.on("readable",function(){f=!0;for(var b;!e&&null!==(b=a.read());)a.emit("data",b);null===b&&(f=!1,a._readableState.needReadable=!0)}),a.pause=function(){e=!0,this.emit("pause")},a.resume=function(){e=!1,f?c.nextTick(function(){a.emit("readable")}):this.read(0),this.emit("resume")},a.emit("readable")}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):y.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new y(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");!b.endEmitted&&b.calledRead&&(b.ended=!0,c.nextTick(function(){b.endEmitted||0!==b.length||(b.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}b.exports=e;var x=a("isarray"),y=a("buffer").Buffer;e.ReadableState=d;var z=a("events").EventEmitter;z.listenerCount||(z.listenerCount=function(a,b){return a.listeners(b).length});var A=a("stream"),B=a("core-util-is");B.inherits=a("inherits");var C;B.inherits(e,A),e.prototype.push=function(a,b){var c=this._readableState;return"string"!=typeof a||c.objectMode||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new y(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.setEncoding=function(b){C||(C=a("string_decoder/").StringDecoder),this._readableState.decoder=new C(b),this._readableState.encoding=b};var D=8388608;e.prototype.read=function(a){var b=this._readableState;b.calledRead=!0;var c=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&u(this),null;var d=b.needReadable;b.length-a<=b.highWaterMark&&(d=!0),(b.ended||b.reading)&&(d=!1),d&&(b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?t(a,b):null,null===e&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),b.ended&&!b.endEmitted&&0===b.length&&u(this),e},e.prototype._read=function(){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){a===k&&f()}function e(){a.end()}function f(){a.removeListener("close",h),a.removeListener("finish",i),a.removeListener("drain",o),a.removeListener("error",g),a.removeListener("unpipe",d),k.removeListener("end",e),k.removeListener("end",f),(!a._writableState||a._writableState.needDrain)&&o()}function g(b){j(),a.removeListener("error",g),0===z.listenerCount(a,"error")&&a.emit("error",b)}function h(){a.removeListener("finish",i),j()}function i(){a.removeListener("close",h),j()}function j(){k.unpipe(a)}var k=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=a;break;case 1:l.pipes=[l.pipes,a];break;default:l.pipes.push(a)}l.pipesCount+=1;var m=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,n=m?e:f;l.endEmitted?c.nextTick(n):k.once("end",n),a.on("unpipe",d);var o=p(k);return a.on("drain",o),a._events&&a._events.error?x(a._events.error)?a._events.error.unshift(g):a._events.error=[g,a._events.error]:a.on("error",g),a.once("close",h),a.once("finish",i),a.emit("pipe",k),l.flowing||(this.on("readable",r),l.flowing=!0,c.nextTick(function(){q(k)})),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=A.prototype.on.call(this,a,b);if("data"!==a||this._readableState.flowing||s(this),"readable"===a&&this.readable){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,d.reading?d.length&&l(this,d):this.read(0))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){s(this),this.read(0),this.emit("resume")},e.prototype.pause=function(){s(this,!0),this.emit("pause")},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(b.decoder&&(e=b.decoder.write(e)),e&&(b.objectMode||e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)"function"==typeof a[e]&&"undefined"==typeof this[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return v(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(){c&&(c=!1,a.resume())},d},e._fromList=t}).call(this,a("+xKvab"))},{"+xKvab":29,buffer:13,"core-util-is":40,events:22,inherits:27,isarray:41,stream:47,"string_decoder/":42}],38:[function(a,b){function c(a,b){this.afterTransform=function(a,c){return d(b,a,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function d(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function e(a){if(!(this instanceof e))return new e(a);g.call(this,a);var b=(this._transformState=new c(a,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(a){f(b,a)}):f(b)})}function f(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=(a._readableState,a._transformState);if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=e;var g=a("./_stream_duplex"),h=a("core-util-is");h.inherits=a("inherits"),h.inherits(e,g),e.prototype.push=function(a,b){return this._transformState.needTransform=!1,g.prototype.push.call(this,a,b)},e.prototype._transform=function(){throw new Error("not implemented")},e.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},e.prototype._read=function(){var a=this._transformState;null!==a.writechunk&&a.writecb&&!a.transforming?(a.transforming=!0,this._transform(a.writechunk,a.writeencoding,a.afterTransform)):a.needTransform=!0}},{"./_stream_duplex":35,"core-util-is":40,inherits:27}],39:[function(a,b){(function(c){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(a,b){a=a||{};var c=a.highWaterMark;this.highWaterMark=c||0===c?c:16384,this.objectMode=!!a.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var d=a.decodeStrings===!1;this.decodeStrings=!d,this.defaultEncoding=a.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(b,a)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function f(b){var c=a("./_stream_duplex");return this instanceof f||this instanceof c?(this._writableState=new e(b,this),this.writable=!0,void w.call(this)):new f(b)}function g(a,b,d){var e=new Error("write after end");a.emit("error",e),c.nextTick(function(){d(e)})}function h(a,b,d,e){var f=!0;if(!u.isBuffer(d)&&"string"!=typeof d&&null!==d&&void 0!==d&&!b.objectMode){var g=new TypeError("Invalid non-string/buffer chunk");a.emit("error",g),c.nextTick(function(){e(g)}),f=!1}return f}function i(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new u(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e),u.isBuffer(c)&&(e="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return h||(b.needDrain=!0),b.writing?b.buffer.push(new d(c,e,f)):k(a,b,g,c,e,f),h}function k(a,b,c,d,e,f){b.writelen=c,b.writecb=f,b.writing=!0,b.sync=!0,a._write(d,e,b.onwrite),b.sync=!1}function l(a,b,d,e,f){d?c.nextTick(function(){f(e)}):f(e),a._writableState.errorEmitted=!0,a.emit("error",e)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,b){var d=a._writableState,e=d.sync,f=d.writecb;if(m(d),b)l(a,d,e,b,f);else{var g=r(a,d);g||d.bufferProcessing||!d.buffer.length||q(a,d),e?c.nextTick(function(){o(a,d,g,f)}):o(a,d,g,f)}}function o(a,b,c,d){c||p(a,b),d(),c&&s(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){b.bufferProcessing=!0;for(var c=0;c<b.buffer.length;c++){var d=b.buffer[c],e=d.chunk,f=d.encoding,g=d.callback,h=b.objectMode?1:e.length;if(k(a,b,h,e,f,g),b.writing){c++;break}}b.bufferProcessing=!1,c<b.buffer.length?b.buffer=b.buffer.slice(c):b.buffer.length=0}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){var c=r(a,b);return c&&(b.finished=!0,a.emit("finish")),c}function t(a,b,d){b.ending=!0,s(a,b),d&&(b.finished?c.nextTick(d):a.once("finish",d)),b.ended=!0}b.exports=f;var u=a("buffer").Buffer;f.WritableState=e;var v=a("core-util-is");v.inherits=a("inherits");var w=a("stream");v.inherits(f,w),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return"function"==typeof b&&(c=b,b=null),u.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(e=j(this,d,a,b,c)),e},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),"undefined"!=typeof a&&null!==a&&this.write(a,b),d.ending||d.finished||t(this,d,c)}}).call(this,a("+xKvab"))},{"+xKvab":29,"./_stream_duplex":35,buffer:13,"core-util-is":40,inherits:27,stream:47}],40:[function(a,b,c){(function(a){function b(a){return Array.isArray(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return l(a)&&"[object RegExp]"===r(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return l(a)&&"[object Date]"===r(a)}function n(a){return l(a)&&("[object Error]"===r(a)||a instanceof Error)}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(b){return a.isBuffer(b)}function r(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=q}).call(this,a("buffer").Buffer)},{buffer:13}],41:[function(a,b){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],42:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){var b=this.charReceived=a.length%2;return this.charLength=b?2:0,b}function g(a){var b=this.charReceived=a.length%3;return this.charLength=b?3:0,b}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="",c=0;this.charLength;){var d=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,c,d),this.charReceived+=d-c,c=d,this.charReceived<this.charLength)return"";b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var e=b.charCodeAt(b.length-1);if(!(e>=55296&&56319>=e)){if(this.charReceived=this.charLength=0,d==a.length)return b;a=a.slice(d,a.length);break}this.charLength+=this.surrogateSize,b=""}var f=this.detectIncompleteChar(a),g=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-f,g),this.charReceived=f,g-=f),b+=a.toString(this.encoding,0,g);var g=b.length-1,e=b.charCodeAt(g);if(e>=55296&&56319>=e){var h=this.surrogateSize;return this.charLength+=h,this.charReceived+=h,this.charBuffer.copy(this.charBuffer,h,0,h),this.charBuffer.write(b.charAt(b.length-1),this.encoding),b.substring(0,g)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(2>=b&&c>>4==14){this.charLength=3;break}if(3>=b&&c>>3==30){this.charLength=4;break}}return b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:13}],43:[function(a,b){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":36}],44:[function(a,b,c){c=b.exports=a("./lib/_stream_readable.js"),c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":35,"./lib/_stream_passthrough.js":36,"./lib/_stream_readable.js":37,"./lib/_stream_transform.js":38,"./lib/_stream_writable.js":39}],45:[function(a,b){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":38}],46:[function(a,b){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":39}],47:[function(a,b){function c(){d.call(this)}b.exports=c;var d=a("events").EventEmitter,e=a("inherits");e(c,d),c.Readable=a("readable-stream/readable.js"),c.Writable=a("readable-stream/writable.js"),c.Duplex=a("readable-stream/duplex.js"),c.Transform=a("readable-stream/transform.js"),c.PassThrough=a("readable-stream/passthrough.js"),c.Stream=c,c.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function e(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===d.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",e),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",e),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:22,inherits:27,"readable-stream/duplex.js":34,"readable-stream/passthrough.js":43,"readable-stream/readable.js":44,"readable-stream/transform.js":45,"readable-stream/writable.js":46}],48:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","	"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||h>k)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||h>k)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;B>j;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;F>E;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname=this.hostname.length>u?"":this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;B>j;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.path=c.search?"/"+c.search:null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:30,querystring:33}],49:[function(a,b){b.exports=a(10)},{}],50:[function(a,b){b.exports=a(11)},{"+xKvab":29,"./support/isBuffer":49,inherits:27}],51:[function(a,b,c){function d(a){return a.substr(1).split("|").reduce(function(a,b){var c=b.split(":"),d=c.shift(),e=c.join(":")||"";return e&&(e=", "+e),"filters."+d+"("+a+e+")"})}function e(a,b,c,d){var e=b.split("\n"),f=Math.max(d-3,0),g=Math.min(e.length,d+3),h=e.slice(f,g).map(function(a,b){var c=b+f+1;return(c==d?" >> ":"    ")+c+"| "+a}).join("\n");throw a.path=c,a.message=(c||"ejs")+":"+d+"\n"+h+"\n\n"+a.message,a}function f(a,b){var c=k(i(b),a),d=j(a);return d||(c+=".ejs"),c}var g=a("./utils"),h=a("path"),i=h.dirname,j=h.extname,k=h.join,l=a("fs"),m=l.readFileSync,n=c.filters=a("./filters"),o={};c.clearCache=function(){o={}};var p=(c.parse=function(a,b){var b=b||{},e=b.open||c.open||"<%",g=b.close||c.close||"%>",h=b.filename,i=b.compileDebug!==!1,j="";j+="var buf = [];",!1!==b._with&&(j+="\nwith (locals || {}) { (function(){ "),j+="\n buf.push('";for(var k=1,l=!1,n=0,o=a.length;o>n;++n){var p=a[n];if(a.slice(n,e.length+n)==e){n+=e.length;var q,r,s=(i?"__stack.lineno=":"")+k;switch(a[n]){case"=":q="', escape(("+s+", ",r=")), '",++n;break;case"-":q="', ("+s+", ",r="), '",++n;break;default:q="');"+s+";",r="; buf.push('"}var t=a.indexOf(g,n);if(0>t)throw new Error('Could not find matching close tag "'+g+'".');var u=a.substring(n,t),v=n,w=null,x=0;if("-"==u[u.length-1]&&(u=u.substring(0,u.length-2),l=!0),0==u.trim().indexOf("include")){var y=u.trim().slice(7).trim();if(!h)throw new Error("filename option is required for includes");var z=f(y,h);w=m(z,"utf8"),w=c.parse(w,{filename:z,_with:!1,open:e,close:g,compileDebug:i}),j+="' + (function(){"+w+"})() + '",u=""}for(;~(x=u.indexOf("\n",x));)x++,k++;":"==u.substr(0,1)&&(u=d(u)),u&&(u.lastIndexOf("//")>u.lastIndexOf("\n")&&(u+="\n"),j+=q,j+=u,j+=r),n+=t-v+g.length-1}else"\\"==p?j+="\\\\":"'"==p?j+="\\'":"\r"==p||("\n"==p?l?l=!1:(j+="\\n",k++):j+=p)}return j+=!1!==b._with?"'); })();\n} \nreturn buf.join('');":"');\nreturn buf.join('');"},c.compile=function(a,b){b=b||{};var d=b.escape||g.escape,f=JSON.stringify(a),h=b.compileDebug!==!1,i=b.client,j=b.filename?JSON.stringify(b.filename):"undefined";a=h?["var __stack = { lineno: 1, input: "+f+", filename: "+j+" };",e.toString(),"try {",c.parse(a,b),"} catch (err) {","  rethrow(err, __stack.input, __stack.filename, __stack.lineno);","}"].join("\n"):c.parse(a,b),b.debug&&console.log(a),i&&(a="escape = escape || "+d.toString()+";\n"+a);try{var k=new Function("locals, filters, escape, rethrow",a)}catch(l){throw"SyntaxError"==l.name&&(l.message+=b.filename?" in "+j:" while compiling ejs"),l}return i?k:function(a){return k.call(this,a,n,d,e)}});
c.render=function(a,b){var c,b=b||{};if(b.cache){if(!b.filename)throw new Error('"cache" option requires "filename".');c=o[b.filename]||(o[b.filename]=p(a,b))}else c=p(a,b);return b.__proto__=b.locals,c.call(b.scope,b)},c.renderFile=function(a,b,d){var e=a+":string";"function"==typeof b&&(d=b,b={}),b.filename=a;var f;try{f=b.cache?o[e]||(o[e]=m(a,"utf8")):m(a,"utf8")}catch(g){return void d(g)}d(null,c.render(f,b))},c.__express=c.renderFile,a.extensions?a.extensions[".ejs"]=function(a,b){b=b||a.filename;var c={filename:b,client:!0},d=l.readFileSync(b).toString(),e=p(d,c);a._compile("module.exports = "+e.toString()+";",b)}:a.registerExtension&&a.registerExtension(".ejs",function(a){return p(a,{})})},{"./filters":52,"./utils":53,fs:8,path:28}],52:[function(a,b,c){c.first=function(a){return a[0]},c.last=function(a){return a[a.length-1]},c.capitalize=function(a){return a=String(a),a[0].toUpperCase()+a.substr(1,a.length)},c.downcase=function(a){return String(a).toLowerCase()},c.upcase=function(a){return String(a).toUpperCase()},c.sort=function(a){return Object.create(a).sort()},c.sort_by=function(a,b){return Object.create(a).sort(function(a,c){return a=a[b],c=c[b],a>c?1:c>a?-1:0})},c.size=c.length=function(a){return a.length},c.plus=function(a,b){return Number(a)+Number(b)},c.minus=function(a,b){return Number(a)-Number(b)},c.times=function(a,b){return Number(a)*Number(b)},c.divided_by=function(a,b){return Number(a)/Number(b)},c.join=function(a,b){return a.join(b||", ")},c.truncate=function(a,b,c){return a=String(a),a.length>b&&(a=a.slice(0,b),c&&(a+=c)),a},c.truncate_words=function(a,b){var a=String(a),c=a.split(/ +/);return c.slice(0,b).join(" ")},c.replace=function(a,b,c){return String(a).replace(b,c||"")},c.prepend=function(a,b){return Array.isArray(a)?[b].concat(a):b+a},c.append=function(a,b){return Array.isArray(a)?a.concat(b):a+b},c.map=function(a,b){return a.map(function(a){return a[b]})},c.reverse=function(a){return Array.isArray(a)?a.reverse():String(a).split("").reverse().join("")},c.get=function(a,b){return a[b]},c.json=function(a){return JSON.stringify(a)}},{}],53:[function(a,b,c){c.escape=function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")}},{}],54:[function(a,b,c){var d=a("./lib/executor");c=b.exports=function(b){var c=a("loopback-boot#instructions");d(b,c)},c.execute=d},{"./lib/executor":55,"loopback-boot#instructions":"N8PlnM"}],55:[function(a,b){(function(c){function d(a){var b="1.x || 2.x",c=a.loopback||{},d=c.version||"1.0.0";if(!t.satisfies(d,b))throw new Error("The `app` is powered by an incompatible loopback version %s. Supported versions: %s",c.version||"<1.9",b)}function e(a,b){var d=c.env.npm_config_host||c.env.OPENSHIFT_SLS_IP||c.env.OPENSHIFT_NODEJS_IP||c.env.HOST||b.config.host||c.env.npm_package_config_host||a.get("host");void 0!==d&&(q("string"==typeof d,"app.host must be a string"),a.set("host",d))}function f(a,b){var d=r.find([c.env.npm_config_port,c.env.OPENSHIFT_SLS_PORT,c.env.OPENSHIFT_NODEJS_PORT,c.env.PORT,b.config.port,c.env.npm_package_config_port,a.get("port"),3e3],r.isFinite);if(void 0!==d){var e=typeof d;q("string"===e||"number"===e,"app.port must be a string or number"),a.set("port",d)}}function g(a,b){var c=b.config.restApiRoot||a.get("restApiRoot")||"/api";q(void 0!==c,"app.restBasePath is required"),q("string"==typeof c,"app.restApiRoot must be a string"),q(/^\//.test(c),'app.restApiRoot must start with "/"'),a.set("restApiRoot",c)}function h(a,b){var c=b.config;for(var d in c){var e=a.get(d);(void 0===e||null===e)&&a.set(d,c[d])}}function i(a,b){l(b.dataSources,function(b,c){a.dataSource(b,c)})}function j(a,b){k(b),b.models.forEach(function(b){b.config&&a.model(b._model,b.config)})}function k(b){b.models.forEach(function(b){var c,d=b.name;if(b.definition){if(u("Creating new model %s %j",d,b.definition),c=s.createModel(b.definition),b.sourceFile){u("Loading customization script %s",b.sourceFile);var e=a(b.sourceFile);"function"==typeof e?(u("Customizing model %s",d),e(c,c.super_)):u("Skipping model file %s - `module.exports` is not a function",b.sourceFile)}}else{if(c=s.getModel(d),!c)throw new Error("Cannot configure unknown model "+d);u("Configuring existing model %s",d)}b._model=c})}function l(a,b){"object"==typeof a&&Object.keys(a).forEach(function(c){b(c,a[c])})}function m(a,b){b&&b.length&&b.forEach(function(b){var c=n(b);"function"==typeof c&&c(a)})}function n(b){try{return a.apply(this,arguments)}catch(c){if("MODULE_NOT_FOUND"===c.code)return void u("Warning: cannot require %s - module not found.",b);throw console.error('failed to require "%s"',b),c}}function o(a,b){m(a,b.files.boot)}function p(a,b){var c=a.remotes().exports.swagger;if(c){var d=b.config,e=d.swagger&&d.swagger.requireToken;c.requireToken=e||!1}}var q=a("assert"),r=a("underscore"),s=a("loopback"),t=a("semver"),u=a("debug")("loopback:boot:executor");b.exports=function(a,b){d(a),e(a,b),f(a,b),g(a,b),h(a,b),i(a,b),j(a,b),o(a,b),p(a,b)}}).call(this,a("+xKvab"))},{"+xKvab":29,assert:9,debug:56,loopback:89,semver:59,underscore:60}],56:[function(a,b){function c(a){return c.enabled(a)?function(b){b=d(b);var e=new Date,f=e-(c[a]||e);c[a]=e,b=a+" "+b+" +"+c.humanize(f),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function d(a){return a instanceof Error?a.stack||a.message:a}b.exports=c,c.names=[],c.skips=[],c.enable=function(a){try{localStorage.debug=a}catch(b){}for(var d=(a||"").split(/[\s,]+/),e=d.length,f=0;e>f;f++)a=d[f].replace("*",".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$"))},c.disable=function(){c.enable("")},c.humanize=function(a){var b=1e3,c=6e4,d=60*c;return a>=d?(a/d).toFixed(1)+"h":a>=c?(a/c).toFixed(1)+"m":a>=b?(a/b|0)+"s":a+"ms"},c.enabled=function(a){for(var b=0,d=c.skips.length;d>b;b++)if(c.skips[b].test(a))return!1;for(var b=0,d=c.names.length;d>b;b++)if(c.names[b].test(a))return!0;return!1};try{window.localStorage&&c.enable(localStorage.debug)}catch(e){}},{}],"loopback-boot#instructions":[function(a,b){b.exports=a("N8PlnM")},{}],N8PlnM:[function(a,b){b.exports={config:{},dataSources:{remote:{connector:"remote",url:"/api"},local:{connector:"memory",localStorage:"todo-db"}},models:[{name:"Todo",config:{dataSource:"remote"},definition:{name:"Todo",base:"PersistedModel",trackChanges:!0,properties:{id:{id:!0,type:"string"},title:"string",completed:{type:"boolean","default":!1},created:{type:"number"}}},sourceFile:"loopback-boot#models#todo.js"},{name:"LocalTodo",config:{dataSource:"local"},definition:{name:"LocalTodo",base:"Todo"}},{name:"user",config:{dataSource:"remote"},definition:{name:"user",base:"PersistedModel",trackChanges:!0,properties:{id:{id:!0,type:"string"},title:"string",completed:{type:"boolean","default":!1},created:{type:"number"}}}}],files:{boot:["loopback-boot#boot#replication.js"]}}},{}],59:[function(a,b,c){!function(a){function c(a,b){var c=b?P[eb]:P[bb];return c.test(a)?new f(a,b):null}function d(a,b){var d=c(a,b);return d?d.version:null}function e(a,b){var d=c(a,b);return d?d.version:null}function f(a,b){if(a instanceof f){if(a.loose===b)return a;a=a.version}else if("string"!=typeof a)throw new TypeError("Invalid Version: "+a);if(!(this instanceof f))return new f(a,b);this.loose=b;var c=a.trim().match(b?P[eb]:P[bb]);if(!c)throw new TypeError("Invalid Version: "+a);this.raw=a,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],this.prerelease=c[4]?c[4].split(".").map(function(a){return/^[0-9]+$/.test(a)?+a:a}):[],this.build=c[5]?c[5].split("."):[],this.format()}function g(a,b,c){try{return new f(a,c).inc(b).version}catch(d){return null}}function h(a,b){var c=Eb.test(a),d=Eb.test(b);return c&&d&&(a=+a,b=+b),c&&!d?-1:d&&!c?1:b>a?-1:a>b?1:0}function i(a,b){return h(b,a)}function j(a,b,c){return new f(a,c).compare(b)}function k(a,b){return j(a,b,!0)}function l(a,b,c){return j(b,a,c)}function m(b,c){return b.sort(function(b,d){return a.compare(b,d,c)})}function n(b,c){return b.sort(function(b,d){return a.rcompare(b,d,c)})}function o(a,b,c){return j(a,b,c)>0}function p(a,b,c){return j(a,b,c)<0}function q(a,b,c){return 0===j(a,b,c)}function r(a,b,c){return 0!==j(a,b,c)}function s(a,b,c){return j(a,b,c)>=0}function t(a,b,c){return j(a,b,c)<=0}function u(a,b,c,d){var e;switch(b){case"===":e=a===c;break;case"!==":e=a!==c;break;case"":case"=":case"==":e=q(a,c,d);break;case"!=":e=r(a,c,d);break;case">":e=o(a,c,d);break;case">=":e=s(a,c,d);break;case"<":e=p(a,c,d);break;case"<=":e=t(a,c,d);break;default:throw new TypeError("Invalid operator: "+b)}return e}function v(a,b){if(a instanceof v){if(a.loose===b)return a;a=a.value}return this instanceof v?(this.loose=b,this.parse(a),void(this.value=this.semver===Fb?"":this.operator+this.semver.version)):new v(a,b)}function w(a,b){if(a instanceof w&&a.loose===b)return a;if(!(this instanceof w))return new w(a,b);if(this.loose=b,this.raw=a,this.set=a.split(/\s*\|\|\s*/).map(function(a){return this.parseRange(a.trim())},this).filter(function(a){return a.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+a);this.format()}function x(a,b){return new w(a,b).set.map(function(a){return a.map(function(a){return a.value}).join(" ").trim().split(" ")})}function y(a,b){return a=C(a,b),a=A(a,b),a=E(a,b),a=G(a,b)}function z(a){return!a||"x"===a.toLowerCase()||"*"===a}function A(a,b){return a.trim().split(/\s+/).map(function(a){return B(a,b)}).join(" ")}function B(a,b){var c=b?P[qb]:P[pb];return a.replace(c,function(a,b,c,d,e){var f;return z(b)?f="":z(c)?f=">="+b+".0.0-0 <"+(+b+1)+".0.0-0":z(d)?f=">="+b+"."+c+".0-0 <"+b+"."+(+c+1)+".0-0":e?("-"!==e.charAt(0)&&(e="-"+e),f=">="+b+"."+c+"."+d+e+" <"+b+"."+(+c+1)+".0-0"):f=">="+b+"."+c+"."+d+"-0 <"+b+"."+(+c+1)+".0-0",f})}function C(a,b){return a.trim().split(/\s+/).map(function(a){return D(a,b)}).join(" ")}function D(a,b){var c=b?P[vb]:P[ub];return a.replace(c,function(a,b,c,d,e){var f;return z(b)?f="":z(c)?f=">="+b+".0.0-0 <"+(+b+1)+".0.0-0":z(d)?f="0"===b?">="+b+"."+c+".0-0 <"+b+"."+(+c+1)+".0-0":">="+b+"."+c+".0-0 <"+(+b+1)+".0.0-0":e?("-"!==e.charAt(0)&&(e="-"+e),f="0"===b?"0"===c?"="+b+"."+c+"."+d+e:">="+b+"."+c+"."+d+e+" <"+b+"."+(+c+1)+".0-0":">="+b+"."+c+"."+d+e+" <"+(+b+1)+".0.0-0"):f="0"===b?"0"===c?"="+b+"."+c+"."+d:">="+b+"."+c+"."+d+"-0 <"+b+"."+(+c+1)+".0-0":">="+b+"."+c+"."+d+"-0 <"+(+b+1)+".0.0-0",f})}function E(a,b){return a.split(/\s+/).map(function(a){return F(a,b)}).join(" ")}function F(a,b){a=a.trim();var c=b?P[lb]:P[kb];return a.replace(c,function(a,b,c,d,e){var f=z(c),g=f||z(d),h=g||z(e),i=h;return"="===b&&i&&(b=""),b&&i?(f&&(c=0),g&&(d=0),h&&(e=0),">"===b&&(b=">=",f||(g?(c=+c+1,d=0,e=0):h&&(d=+d+1,e=0))),a=b+c+"."+d+"."+e+"-0"):f?a="*":g?a=">="+c+".0.0-0 <"+(+c+1)+".0.0-0":h&&(a=">="+c+"."+d+".0-0 <"+c+"."+(+d+1)+".0-0"),a})}function G(a){return a.trim().replace(P[Cb],"")}function H(a,b,c,d,e,f,g,h,i,j,k,l){return b=z(c)?"":z(d)?">="+c+".0.0-0":z(e)?">="+c+"."+d+".0-0":">="+b,h=z(i)?"":z(j)?"<"+(+i+1)+".0.0-0":z(k)?"<"+i+"."+(+j+1)+".0-0":l?"<="+i+"."+j+"."+k+"-"+l:"<="+h,(b+" "+h).trim()}function I(a,b){for(var c=0;c<a.length;c++)if(!a[c].test(b))return!1;return!0}function J(a,b,c){try{b=new w(b,c)}catch(d){return!1}return b.test(a)}function K(a,b,c){return a.filter(function(a){return J(a,b,c)}).sort(function(a,b){return l(a,b,c)})[0]||null}function L(a,b){try{return new w(a,b).range||"*"}catch(c){return null}}function M(a,b,c){return O(a,b,"<",c)}function N(a,b,c){return O(a,b,">",c)}function O(a,b,c,d){a=new f(a,d),b=new w(b,d);var e,g,h,i,j;switch(c){case">":e=o,g=t,h=p,i=">",j=">=";break;case"<":e=p,g=s,h=o,i="<",j="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(J(a,b,d))return!1;for(var k=0;k<b.set.length;++k){var l=b.set[k],m=null,n=null;if(l.forEach(function(a){m=m||a,n=n||a,e(a.semver,m.semver,d)?m=a:h(a.semver,n.semver,d)&&(n=a)}),m.operator===i||m.operator===j)return!1;if((!n.operator||n.operator===i)&&g(a,n.semver))return!1;if(n.operator===j&&h(a,n.semver))return!1}return!0}"object"==typeof b&&b.exports===a&&(a=b.exports=f),a.SEMVER_SPEC_VERSION="2.0.0";var P=a.re=[],Q=a.src=[],R=0,S=R++;Q[S]="0|[1-9]\\d*";var T=R++;Q[T]="[0-9]+";var U=R++;Q[U]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var V=R++;Q[V]="("+Q[S]+")\\.("+Q[S]+")\\.("+Q[S]+")";var W=R++;Q[W]="("+Q[T]+")\\.("+Q[T]+")\\.("+Q[T]+")";var X=R++;Q[X]="(?:"+Q[S]+"|"+Q[U]+")";var Y=R++;Q[Y]="(?:"+Q[T]+"|"+Q[U]+")";var Z=R++;Q[Z]="(?:-("+Q[X]+"(?:\\."+Q[X]+")*))";var $=R++;Q[$]="(?:-?("+Q[Y]+"(?:\\."+Q[Y]+")*))";var _=R++;Q[_]="[0-9A-Za-z-]+";var ab=R++;Q[ab]="(?:\\+("+Q[_]+"(?:\\."+Q[_]+")*))";var bb=R++,cb="v?"+Q[V]+Q[Z]+"?"+Q[ab]+"?";Q[bb]="^"+cb+"$";var db="[v=\\s]*"+Q[W]+Q[$]+"?"+Q[ab]+"?",eb=R++;Q[eb]="^"+db+"$";var fb=R++;Q[fb]="((?:<|>)?=?)";var gb=R++;Q[gb]=Q[T]+"|x|X|\\*";var hb=R++;Q[hb]=Q[S]+"|x|X|\\*";var ib=R++;Q[ib]="[v=\\s]*("+Q[hb]+")(?:\\.("+Q[hb]+")(?:\\.("+Q[hb]+")(?:("+Q[Z]+"))?)?)?";var jb=R++;Q[jb]="[v=\\s]*("+Q[gb]+")(?:\\.("+Q[gb]+")(?:\\.("+Q[gb]+")(?:("+Q[$]+"))?)?)?";var kb=R++;Q[kb]="^"+Q[fb]+"\\s*"+Q[ib]+"$";var lb=R++;Q[lb]="^"+Q[fb]+"\\s*"+Q[jb]+"$";var mb=R++;Q[mb]="(?:~>?)";var nb=R++;Q[nb]="(\\s*)"+Q[mb]+"\\s+",P[nb]=new RegExp(Q[nb],"g");var ob="$1~",pb=R++;Q[pb]="^"+Q[mb]+Q[ib]+"$";var qb=R++;Q[qb]="^"+Q[mb]+Q[jb]+"$";var rb=R++;Q[rb]="(?:\\^)";var sb=R++;Q[sb]="(\\s*)"+Q[rb]+"\\s+",P[sb]=new RegExp(Q[sb],"g");var tb="$1^",ub=R++;Q[ub]="^"+Q[rb]+Q[ib]+"$";var vb=R++;Q[vb]="^"+Q[rb]+Q[jb]+"$";var wb=R++;Q[wb]="^"+Q[fb]+"\\s*("+db+")$|^$";var xb=R++;Q[xb]="^"+Q[fb]+"\\s*("+cb+")$|^$";var yb=R++;Q[yb]="(\\s*)"+Q[fb]+"\\s*("+db+"|"+Q[ib]+")",P[yb]=new RegExp(Q[yb],"g");var zb="$1$2$3",Ab=R++;Q[Ab]="^\\s*("+Q[ib]+")\\s+-\\s+("+Q[ib]+")\\s*$";var Bb=R++;Q[Bb]="^\\s*("+Q[jb]+")\\s+-\\s+("+Q[jb]+")\\s*$";var Cb=R++;Q[Cb]="(<|>)?=?\\s*\\*";for(var Db=0;R>Db;Db++)P[Db]||(P[Db]=new RegExp(Q[Db]));a.parse=c,a.valid=d,a.clean=e,a.SemVer=f,f.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},f.prototype.inspect=function(){return'<SemVer "'+this+'">'},f.prototype.toString=function(){return this.version},f.prototype.compare=function(a){return a instanceof f||(a=new f(a,this.loose)),this.compareMain(a)||this.comparePre(a)},f.prototype.compareMain=function(a){return a instanceof f||(a=new f(a,this.loose)),h(this.major,a.major)||h(this.minor,a.minor)||h(this.patch,a.patch)},f.prototype.comparePre=function(a){if(a instanceof f||(a=new f(a,this.loose)),this.prerelease.length&&!a.prerelease.length)return-1;if(!this.prerelease.length&&a.prerelease.length)return 1;if(!this.prerelease.length&&!a.prerelease.length)return 0;var b=0;do{var c=this.prerelease[b],d=a.prerelease[b];if(void 0===c&&void 0===d)return 0;if(void 0===d)return 1;if(void 0===c)return-1;if(c!==d)return h(c,d)}while(++b)},f.prototype.inc=function(a){switch(a){case"premajor":this.inc("major"),this.inc("pre");break;case"preminor":this.inc("minor"),this.inc("pre");break;case"prepatch":this.prerelease.length=0,this.inc("patch"),this.inc("pre");break;case"prerelease":0===this.prerelease.length&&this.inc("patch"),this.inc("pre");break;case"major":this.major++,this.minor=-1;case"minor":this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var b=this.prerelease.length;--b>=0;)"number"==typeof this.prerelease[b]&&(this.prerelease[b]++,b=-2);-1===b&&this.prerelease.push(0)}break;default:throw new Error("invalid increment argument: "+a)}return this.format(),this},a.inc=g,a.compareIdentifiers=h;var Eb=/^[0-9]+$/;a.rcompareIdentifiers=i,a.compare=j,a.compareLoose=k,a.rcompare=l,a.sort=m,a.rsort=n,a.gt=o,a.lt=p,a.eq=q,a.neq=r,a.gte=s,a.lte=t,a.cmp=u,a.Comparator=v;var Fb={};v.prototype.parse=function(a){var b=this.loose?P[wb]:P[xb],c=a.match(b);if(!c)throw new TypeError("Invalid comparator: "+a);this.operator=c[1],c[2]?(this.semver=new f(c[2],this.loose),"<"!==this.operator||this.semver.prerelease.length||(this.semver.prerelease=["0"],this.semver.format())):this.semver=Fb},v.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'},v.prototype.toString=function(){return this.value},v.prototype.test=function(a){return this.semver===Fb?!0:u(a,this.operator,this.semver,this.loose)},a.Range=w,w.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'},w.prototype.format=function(){return this.range=this.set.map(function(a){return a.join(" ").trim()}).join("||").trim(),this.range},w.prototype.toString=function(){return this.range},w.prototype.parseRange=function(a){var b=this.loose;a=a.trim();var c=b?P[Bb]:P[Ab];a=a.replace(c,H),a=a.replace(P[yb],zb),a=a.replace(P[nb],ob),a=a.replace(P[sb],tb),a=a.split(/\s+/).join(" ");var d=b?P[wb]:P[xb],e=a.split(" ").map(function(a){return y(a,b)}).join(" ").split(/\s+/);return this.loose&&(e=e.filter(function(a){return!!a.match(d)})),e=e.map(function(a){return new v(a,b)})},a.toComparators=x,w.prototype.test=function(a){if(!a)return!1;for(var b=0;b<this.set.length;b++)if(I(this.set[b],a))return!0;return!1},a.satisfies=J,a.maxSatisfying=K,a.validRange=L,a.ltr=M,a.gtr=N,a.outside=O,"function"==typeof define&&define.amd&&define(a)}("object"==typeof c?c:"function"==typeof define&&define.amd?{}:semver={})},{}],60:[function(a,b,c){(function(){var a=this,d=a._,e={},f=Array.prototype,g=Object.prototype,h=Function.prototype,i=f.push,j=f.slice,k=f.concat,l=g.toString,m=g.hasOwnProperty,n=f.forEach,o=f.map,p=f.reduce,q=f.reduceRight,r=f.filter,s=f.every,t=f.some,u=f.indexOf,v=f.lastIndexOf,w=Array.isArray,x=Object.keys,y=h.bind,z=function(a){return a instanceof z?a:this instanceof z?void(this._wrapped=a):new z(a)};"undefined"!=typeof c?("undefined"!=typeof b&&b.exports&&(c=b.exports=z),c._=z):a._=z,z.VERSION="1.6.0";var A=z.each=z.forEach=function(a,b,c){if(null==a)return a;if(n&&a.forEach===n)a.forEach(b,c);else if(a.length===+a.length){for(var d=0,f=a.length;f>d;d++)if(b.call(c,a[d],d,a)===e)return}else for(var g=z.keys(a),d=0,f=g.length;f>d;d++)if(b.call(c,a[g[d]],g[d],a)===e)return;return a};z.map=z.collect=function(a,b,c){var d=[];return null==a?d:o&&a.map===o?a.map(b,c):(A(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var B="Reduce of empty array with no initial value";z.reduce=z.foldl=z.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),p&&a.reduce===p)return d&&(b=z.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(A(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(B);return c},z.reduceRight=z.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),q&&a.reduceRight===q)return d&&(b=z.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=z.keys(a);f=g.length}if(A(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(B);return c},z.find=z.detect=function(a,b,c){var d;return C(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},z.filter=z.select=function(a,b,c){var d=[];return null==a?d:r&&a.filter===r?a.filter(b,c):(A(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},z.reject=function(a,b,c){return z.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},z.every=z.all=function(a,b,c){b||(b=z.identity);var d=!0;return null==a?d:s&&a.every===s?a.every(b,c):(A(a,function(a,f,g){return(d=d&&b.call(c,a,f,g))?void 0:e}),!!d)};var C=z.some=z.any=function(a,b,c){b||(b=z.identity);var d=!1;return null==a?d:t&&a.some===t?a.some(b,c):(A(a,function(a,f,g){return d||(d=b.call(c,a,f,g))?e:void 0}),!!d)};z.contains=z.include=function(a,b){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(b):C(a,function(a){return a===b})},z.invoke=function(a,b){var c=j.call(arguments,2),d=z.isFunction(b);return z.map(a,function(a){return(d?b:a[b]).apply(a,c)})},z.pluck=function(a,b){return z.map(a,z.property(b))},z.where=function(a,b){return z.filter(a,z.matches(b))},z.findWhere=function(a,b){return z.find(a,z.matches(b))},z.max=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);var d=-1/0,e=-1/0;return A(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h>e&&(d=a,e=h)}),d},z.min=function(a,b,c){if(!b&&z.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);var d=1/0,e=1/0;return A(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;e>h&&(d=a,e=h)}),d},z.shuffle=function(a){var b,c=0,d=[];return A(a,function(a){b=z.random(c++),d[c-1]=d[b],d[b]=a}),d},z.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=z.values(a)),a[z.random(a.length-1)]):z.shuffle(a).slice(0,Math.max(0,b))};var D=function(a){return null==a?z.identity:z.isFunction(a)?a:z.property(a)};z.sortBy=function(a,b,c){return b=D(b),z.pluck(z.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var E=function(a){return function(b,c,d){var e={};return c=D(c),A(b,function(f,g){var h=c.call(d,f,g,b);a(e,h,f)}),e}};z.groupBy=E(function(a,b,c){z.has(a,b)?a[b].push(c):a[b]=[c]}),z.indexBy=E(function(a,b,c){a[b]=c}),z.countBy=E(function(a,b){z.has(a,b)?a[b]++:a[b]=1}),z.sortedIndex=function(a,b,c,d){c=D(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},z.toArray=function(a){return a?z.isArray(a)?j.call(a):a.length===+a.length?z.map(a,z.identity):z.values(a):[]},z.size=function(a){return null==a?0:a.length===+a.length?a.length:z.keys(a).length},z.first=z.head=z.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:j.call(a,0,b)},z.initial=function(a,b,c){return j.call(a,0,a.length-(null==b||c?1:b))},z.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:j.call(a,Math.max(a.length-b,0))},z.rest=z.tail=z.drop=function(a,b,c){return j.call(a,null==b||c?1:b)},z.compact=function(a){return z.filter(a,z.identity)};var F=function(a,b,c){return b&&z.every(a,z.isArray)?k.apply(c,a):(A(a,function(a){z.isArray(a)||z.isArguments(a)?b?i.apply(c,a):F(a,b,c):c.push(a)}),c)};z.flatten=function(a,b){return F(a,b,[])},z.without=function(a){return z.difference(a,j.call(arguments,1))},z.partition=function(a,b){var c=[],d=[];return A(a,function(a){(b(a)?c:d).push(a)}),[c,d]},z.uniq=z.unique=function(a,b,c,d){z.isFunction(b)&&(d=c,c=b,b=!1);var e=c?z.map(a,c,d):a,f=[],g=[];return A(e,function(c,d){(b?d&&g[g.length-1]===c:z.contains(g,c))||(g.push(c),f.push(a[d]))}),f},z.union=function(){return z.uniq(z.flatten(arguments,!0))},z.intersection=function(a){var b=j.call(arguments,1);return z.filter(z.uniq(a),function(a){return z.every(b,function(b){return z.contains(b,a)})})},z.difference=function(a){var b=k.apply(f,j.call(arguments,1));return z.filter(a,function(a){return!z.contains(b,a)})},z.zip=function(){for(var a=z.max(z.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=z.pluck(arguments,""+c);return b},z.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},z.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=z.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(u&&a.indexOf===u)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},z.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(v&&a.lastIndexOf===v)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},z.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var G=function(){};z.bind=function(a,b){var c,d;if(y&&a.bind===y)return y.apply(a,j.call(arguments,1));if(!z.isFunction(a))throw new TypeError;return c=j.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(j.call(arguments)));G.prototype=a.prototype;var e=new G;G.prototype=null;var f=a.apply(e,c.concat(j.call(arguments)));return Object(f)===f?f:e}},z.partial=function(a){var b=j.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===z&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},z.bindAll=function(a){var b=j.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return A(b,function(b){a[b]=z.bind(a[b],a)}),a},z.memoize=function(a,b){var c={};return b||(b=z.identity),function(){var d=b.apply(this,arguments);return z.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},z.delay=function(a,b){var c=j.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},z.defer=function(a){return z.delay.apply(z,[a,1].concat(j.call(arguments,1)))},z.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:z.now(),g=null,f=a.apply(d,e),d=e=null};return function(){var j=z.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),d=e=null):g||c.trailing===!1||(g=setTimeout(i,k)),f}},z.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=z.now()-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),f=e=null))};return function(){f=this,e=arguments,g=z.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},z.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},z.wrap=function(a,b){return z.partial(b,a)},z.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},z.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},z.keys=function(a){if(!z.isObject(a))return[];if(x)return x(a);var b=[];for(var c in a)z.has(a,c)&&b.push(c);return b},z.values=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},z.pairs=function(a){for(var b=z.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},z.invert=function(a){for(var b={},c=z.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},z.functions=z.methods=function(a){var b=[];for(var c in a)z.isFunction(a[c])&&b.push(c);return b.sort()},z.extend=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},z.pick=function(a){var b={},c=k.apply(f,j.call(arguments,1));return A(c,function(c){c in a&&(b[c]=a[c])}),b},z.omit=function(a){var b={},c=k.apply(f,j.call(arguments,1));for(var d in a)z.contains(c,d)||(b[d]=a[d]);return b},z.defaults=function(a){return A(j.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},z.clone=function(a){return z.isObject(a)?z.isArray(a)?a.slice():z.extend({},a):a},z.tap=function(a,b){return b(a),a};var H=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof z&&(a=a._wrapped),b instanceof z&&(b=b._wrapped);var e=l.call(a);if(e!=l.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(z.isFunction(g)&&g instanceof g&&z.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1;c.push(a),d.push(b);var i=0,j=!0;if("[object Array]"==e){if(i=a.length,j=i==b.length)for(;i--&&(j=H(a[i],b[i],c,d)););}else{for(var k in a)if(z.has(a,k)&&(i++,!(j=z.has(b,k)&&H(a[k],b[k],c,d))))break;if(j){for(k in b)if(z.has(b,k)&&!i--)break;j=!i}}return c.pop(),d.pop(),j};z.isEqual=function(a,b){return H(a,b,[],[])},z.isEmpty=function(a){if(null==a)return!0;if(z.isArray(a)||z.isString(a))return 0===a.length;for(var b in a)if(z.has(a,b))return!1;return!0},z.isElement=function(a){return!(!a||1!==a.nodeType)},z.isArray=w||function(a){return"[object Array]"==l.call(a)},z.isObject=function(a){return a===Object(a)},A(["Arguments","Function","String","Number","Date","RegExp"],function(a){z["is"+a]=function(b){return l.call(b)=="[object "+a+"]"}}),z.isArguments(arguments)||(z.isArguments=function(a){return!(!a||!z.has(a,"callee"))}),"function"!=typeof/./&&(z.isFunction=function(a){return"function"==typeof a}),z.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},z.isNaN=function(a){return z.isNumber(a)&&a!=+a},z.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==l.call(a)},z.isNull=function(a){return null===a},z.isUndefined=function(a){return void 0===a},z.has=function(a,b){return m.call(a,b)},z.noConflict=function(){return a._=d,this},z.identity=function(a){return a},z.constant=function(a){return function(){return a}},z.property=function(a){return function(b){return b[a]}},z.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}},z.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},z.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},z.now=Date.now||function(){return(new Date).getTime()};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=z.invert(I.escape);var J={escape:new RegExp("["+z.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+z.keys(I.unescape).join("|")+")","g")};z.each(["escape","unescape"],function(a){z[a]=function(b){return null==b?"":(""+b).replace(J[a],function(b){return I[a][b]})}}),z.result=function(a,b){if(null==a)return void 0;var c=a[b];return z.isFunction(c)?c.call(a):c},z.mixin=function(a){A(z.functions(a),function(b){var c=z[b]=a[b];z.prototype[b]=function(){var a=[this._wrapped];return i.apply(a,arguments),O.call(this,c.apply(z,a))}})};var K=0;z.uniqueId=function(a){var b=++K+"";return a?a+b:b},z.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,M={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;z.template=function(a,b,c){var d;c=z.defaults({},c,z.templateSettings);var e=new RegExp([(c.escape||L).source,(c.interpolate||L).source,(c.evaluate||L).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(N,function(a){return"\\"+M[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,z);var i=function(a){return d.call(this,a,z)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},z.chain=function(a){return z(a).chain()};var O=function(a){return this._chain?z(a).chain():a};z.mixin(z),A(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=f[a];z.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],O.call(this,c)}}),A(["concat","join","slice"],function(a){var b=f[a];z.prototype[a]=function(){return O.call(this,b.apply(this._wrapped,arguments))}}),z.extend(z.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return z})}).call(this)},{}],61:[function(a,b,c){c.ModelBuilder=c.LDL=a("./lib/model-builder.js").ModelBuilder,c.DataSource=c.Schema=a("./lib/datasource.js").DataSource,c.ModelBaseClass=a("./lib/model.js"),c.ValidationError=a("./lib/validations.js").ValidationError,c.__defineGetter__("version",function(){return a("./package.json").version
});var d="./test/common_test";c.__defineGetter__("test",function(){return a(d)})},{"./lib/datasource.js":64,"./lib/model-builder.js":71,"./lib/model.js":73,"./lib/validations.js":79,"./package.json":88}],62:[function(a,b,c){(function(b){function d(a,b){a instanceof d?(this.isTransaction=!0,this.cache=a.cache,this.ids=a.ids,this.constructor.super_.call(this,"memory",b),this._models=a._models):(this.isTransaction=!1,this.cache={},this.ids={},this.constructor.super_.call(this,"memory",b))}function e(a){return null===a||void 0===a?a:JSON.stringify(a)}function f(a){return null===a||void 0===a?a:"string"==typeof a?JSON.parse(a):a}function g(a){function b(a){if(a instanceof RegExp)return a;var b="";a=a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1");for(var c=0,d=a.length;d>c;c++){var e=a.charAt(c);"\\"!==e?b+="%"===e?".*":"_"===e?".":"."===e?"\\.":"*"===e?"\\*":e:(c++,d>c&&(b+=a.charAt(c)))}return b}function c(a,c){if("string"==typeof c&&a instanceof RegExp)return c.match(a);if(void 0===a||void 0===c)return void 0;if("object"==typeof a){if(a.near)return!0;if(a.inq){for(var d=0;d<a.inq.length;d++)if(a.inq[d]==c)return!0;return!1}if(a.like||a.nlike){var f=a.like||a.nlike;if("string"==typeof f&&(f=b(f)),a.like)return!!new RegExp(f).test(c);if(a.nlike)return!new RegExp(f).test(c)}if(e(a,c))return!0}return(null!==a?a.toString():a)==(null!==c?c.toString():c)}function d(a,b){if(null==a||null==b)return a==b?0:0/0;if("number"==typeof a)return a-b;if("string"==typeof a)return a>b?1:b>a?-1:a==b?0:0/0;if("boolean"==typeof a)return a-b;if(a instanceof Date){var c=a-b;return c}return a==b?0:0/0}function e(a,b){return"gt"in a?d(b,a.gt)>0:"gte"in a?d(b,a.gte)>=0:"lt"in a?d(b,a.lt)<0:"lte"in a?d(b,a.lte)<=0:!1}var f=a.where;if("function"==typeof f)return f;var h=Object.keys(f);return function(a){var b=!0;return h.forEach(function(d){if(("and"===d||"or"===d)&&Array.isArray(f[d])){if("and"===d)return b=f[d].every(function(b){return g({where:b})(a)});if("or"===d)return b=f[d].some(function(b){return g({where:b})(a)})}c(f[d],a&&a[d])||(b=!1)}),b}}function h(a,b){if(!a)return b;for(var c in b){var d=b[c];"function"!=typeof d&&(a[c]=d)}return a}var i=a("util"),j=a("loopback-connector").Connector,k=a("../geo"),l=a("../utils"),m=a("fs"),n=a("async");c.initialize=function(a,b){a.connector=new d(null,a.settings),a.connector.connect(b)},c.Memory=d,i.inherits(d,j),d.prototype.getDefaultIdType=function(){return Number},d.prototype.getTypes=function(){return["db","nosql","memory"]},d.prototype.connect=function(a){this.isTransaction?this.onTransactionExec=a:this.loadFromFile(a)},d.prototype.loadFromFile=function(a){function c(b){if(b){try{b=JSON.parse(b.toString())}catch(c){return a(c)}d.ids=b.ids||{},d.cache=b.models||{}}else d.cache||(d.ids={},d.cache={});a&&a()}var d=this,e="undefined"!=typeof window&&window.localStorage,f=e&&this.settings.localStorage;if(d.settings.file)m.readFile(d.settings.file,{encoding:"utf8",flag:"r"},function(b,d){b&&"ENOENT"!==b.code?a&&a(b):c(d)});else if(f){var g=window.localStorage.getItem(f);g=g||"{}",c(g)}else b.nextTick(a)},d.prototype.saveToFile=function(a,c){var d=this,e=this.settings.file,f="undefined"!=typeof window&&window.localStorage,g=f&&this.settings.localStorage;if(e)d.writeQueue||(d.writeQueue=n.queue(function(a,b){var c=JSON.stringify({ids:d.ids,models:d.cache},null,"  ");m.writeFile(d.settings.file,c,function(c){b(c),a.callback&&a.callback(c,a.data)})},1)),d.writeQueue.push({data:a,callback:c});else if(g){var h=JSON.stringify({ids:d.ids,models:d.cache},null,"  ");window.localStorage.setItem(g,h),b.nextTick(function(){c&&c(null,a)})}else b.nextTick(function(){c&&c(null,a)})},d.prototype.define=function(a){this.constructor.super_.prototype.define.apply(this,[].slice.call(arguments));var b=a.model.modelName;this.cache[b]||(this.cache[b]={},this.ids[b]=1)},d.prototype.create=function(a,b,c){var d=this.ids[a];void 0===d&&(this.ids[a]=1,d=1);var f=this.getIdValue(a,b)||d;f>d&&(d=f),this.ids[a]=Number(d)+1;var g=this._models[a].properties,h=this.idName(a);f=g[h]&&g[h].type&&g[h].type(f)||f,this.setIdValue(a,b,f),this.cache[a]||(this.cache[a]={}),this.cache[a][f]=e(b),this.saveToFile(f,c)},d.prototype.updateOrCreate=function(a,b,c){var d=this;this.exists(a,d.getIdValue(a,b),function(e,f){f?d.save(a,b,c):d.create(a,b,function(e,f){d.setIdValue(a,b,f),c(e,b)})})},d.prototype.save=function(a,b,c){var d=this.getIdValue(a,b),g=this.cache[a],i=g&&this.cache[a][d];i=i&&f(i),i&&(b=h(i,b)),this.cache[a][d]=e(b),this.saveToFile(b,c)},d.prototype.exists=function(a,c,d){b.nextTick(function(){d(null,this.cache[a]&&this.cache[a].hasOwnProperty(c))}.bind(this))},d.prototype.find=function(a,c,d){b.nextTick(function(){d(null,c in this.cache[a]&&this.fromDb(a,this.cache[a][c]))}.bind(this))},d.prototype.destroy=function(a,b,c){delete this.cache[a][b],this.saveToFile(null,c)},d.prototype.fromDb=function(a,b){if(!b)return null;b=f(b);var c=this._models[a].properties;for(var d in b){var e=b[d];if(void 0!==e&&null!==e){if(c[d])switch(c[d].type.name){case"Date":e=new Date(e.toString().replace(/GMT.*$/,"GMT"));break;case"Boolean":e=Boolean(e);break;case"Number":e=Number(e)}b[d]=e}}return b},d.prototype.all=function(a,c,d){function e(a,b){for(var c=0,d=this.length;d>c;c++){if(a[this[c].key]>b[this[c].key])return 1*this[c].reverse;if(a[this[c].key]<b[this[c].key])return-1*this[c].reverse}return 0}var f=this,h=Object.keys(this.cache[a]).map(function(b){return this.fromDb(a,this.cache[a][b])}.bind(this));if(c){if(c.order){var i=c.order;"string"==typeof c.order&&(i=[c.order]),i.forEach(function(a,b){var c=1,d=a.match(/\s+(A|DE)SC$/i);d&&(a=a.replace(/\s+(A|DE)SC/i,""),"de"===d[1].toLowerCase()&&(c=-1)),i[b]={key:a,reverse:c}}),h=h.sort(e.bind(i))}var j=k.nearFilter(c.where);j&&(h=k.filter(h,j)),c.where&&(h=h?h.filter(g(c)):h),c.fields&&(h=h.map(l.selectFields(c.fields)));var m=c.skip||c.offset||0,n=c.limit||h.length;h=h.slice(m,m+n)}b.nextTick(function(){c&&c.include?f._models[a].model.include(h,c.include,d):d(null,h)})},d.prototype.destroyAll=function(a,b,c){c||"function"!=typeof b||(c=b,b=void 0);var d=this.cache[a],e=null;b&&(e=g({where:b})),Object.keys(d).forEach(function(b){(!e||e(this.fromDb(a,d[b])))&&delete d[b]}.bind(this)),b||(this.cache[a]={}),this.saveToFile(null,c)},d.prototype.count=function(a,c,d){var e=this.cache[a],f=Object.keys(e);if(d){var h={where:d};f=f.map(function(b){return this.fromDb(a,e[b])}.bind(this)),f=f.filter(g(h))}b.nextTick(function(){c(null,f.length)})},d.prototype.update=d.prototype.updateAll=function(a,c,d,e){var f=this,h=this.cache[a],i=null;c=c||{},i=g({where:c});var j=Object.keys(h);n.each(j,function(c,e){var g=f.fromDb(a,h[c]);!i||i(g)?f.updateAttributes(a,c,d,e):b.nextTick(e)},function(a){a||f.saveToFile(null,e)})},d.prototype.updateAttributes=function(a,b,c,d){if(!b){var e=new Error("You must provide an id when updating attributes!");if(d)return d(e);throw e}this.setIdValue(a,c,b);var f=this.cache[a],g=f&&this.cache[a][b];g?this.save(a,c,d):d(new Error("Could not update attributes. Object with id "+b+" does not exist!"))},d.prototype.transaction=function(){return new d(this)},d.prototype.exec=function(a){this.onTransactionExec(),setTimeout(a,50)},d.prototype.buildNearFilter=function(){}}).call(this,a("+xKvab"))},{"+xKvab":29,"../geo":65,"../utils":78,async:80,fs:8,"loopback-connector":83,util:50}],63:[function(a,b){(function(c){function d(){if(d._mixins){var a=this,b=arguments;d._mixins.forEach(function(c){c.call(a,b)})}}function e(a){return a.getDataSource().idName?a.getDataSource().idName(a.modelName):"id"}function f(a,b){return b&&b[a.getDataSource().idName(a.modelName)]}function g(a,b,c){b&&(b[e(a)]=c)}function h(a,b,c){return a.ready(b,c)}function i(a,b,c){Object.defineProperty(a,b,{writable:!1,enumerable:!0,configurable:!0,value:c})}b.exports=d;var j=a("./jutil"),k=a("./validations.js"),l=k.ValidationError,m=a("./relations.js"),n=a("./include.js"),o=a("./list.js"),p=a("./geo"),q=a("./connectors/memory").Memory,r=a("./utils"),s=r.fieldsToArray,t=r.removeUndefined,u=a("util"),v=a("assert");d._forDB=function(a){if(!this.getDataSource().isRelational||!this.getDataSource().isRelational())return a;var b={};for(var c in a){var d=this.getPropertyType(c);b[c]="JSON"===d||"Any"===d||"Object"===d||a[c]instanceof Array?JSON.stringify(a[c]):a[c]}return b},d.create=function(a,b){function c(){0===--o&&(b(n?m:null,k),n||k.forEach(g.emit.bind("changed")))}function d(){q.trigger("create",function(a){q.trigger("save",function(c){var d=e(g);this._adapter().create(j,this.constructor._forDB(q.toObject(!0)),function(e,f,h){return f&&(q.__data[d]=f,i(q,d,f)),h&&(q._rev=h),e?b(e,q):void c.call(q,function(){a.call(q,function(){b(e,q),e||g.emit("changed",q)})})},q)},q)},q)}if(!h(this.getDataSource(),this,arguments)){var g=this,j=g.modelName;if("function"==typeof a&&(b=a,a={}),"function"!=typeof b&&(b=function(){}),a||(a={}),Array.isArray(a)){var k=[],m=Array(a.length),n=!1,o=a.length;0===o&&b(null,[]);for(var p=0;p<a.length;p+=1)!function(a,b){k.push(g.create(a,function(a){a&&(m[b]=a,n=!0),c()}))}(a[p],p);return k}var q;return q=a instanceof g&&!f(this,a)?a:new g(a),a=q.toObject(!0),q.isValid(function(a){a?d():b(new l(q),q)},a),q}},d.upsert=d.updateOrCreate=function(a,b){if(!h(this.getDataSource(),this,arguments)){var c=this;if(!f(this,a))return this.create(a,b);if(this.getDataSource().connector.updateOrCreate){var d=a,e=a;a instanceof c||(e=new c(a)),d=e.toObject(!1),d=t(d),this.getDataSource().connector.updateOrCreate(c.modelName,d,function(a,d){var f;!d||d instanceof c?f=d:(e._initProperties(d),f=e),b(a,f),a||c.emit("changed",e)})}else this.findById(f(this,a),function(d,e){if(d)return b(d);if(e)e.updateAttributes(a,b);else{var f=new c(a);f.save(a,b)}})}},d.findOrCreate=function(a,b,c){void 0===a&&(a={where:{}}),("function"==typeof b||"undefined"==typeof b)&&(c=b,b=a&&a.where),"undefined"==typeof c&&(c=function(){});var d=this;this.findOne(a,function(a,e){return a?c(a):e?c(null,e):void d.create(b,c)})},d.exists=function(a,b){h(this.getDataSource(),this,arguments)||(void 0!==a&&null!==a&&""!==a?this.dataSource.connector.exists(this.modelName,a,b):b(new Error("Model::exists requires the id argument")))},d.findById=function(a,b){h(this.getDataSource(),this,arguments)||this.getDataSource().connector.find(this.modelName,a,function(c,d){var e=null;d&&(f(this,d)||g(this,d,a),e=new this(d,{applySetters:!1})),b(c,e)}.bind(this))},d.all=function(){d.find.apply(this,arguments)};var w={gt:">",gte:">=",lt:"<",lte:"<=",between:"BETWEEN",inq:"IN",nin:"NOT IN",neq:"!=",like:"LIKE",nlike:"NOT LIKE"};d._normalize=function(a){if(!a)return void 0;var b=null;if("object"!=typeof a||Array.isArray(a))throw b=new Error(u.format("The query filter %j is not an object",a)),b.statusCode=400,b;if(a.limit||a.skip||a.offset){var c=Number(a.limit||100),d=Number(a.skip||a.offset||0);if(isNaN(c)||0>=c||Math.ceil(c)!==c)throw b=new Error(u.format("The limit parameter %j is not valid",a.limit)),b.statusCode=400,b;if(isNaN(d)||0>d||Math.ceil(d)!==d)throw b=new Error(u.format("The offset/skip parameter %j is not valid",a.skip||a.offset)),b.statusCode=400,b;a.limit=c,a.offset=d,a.skip=d}return a.fields&&(a.fields=s(a.fields,Object.keys(this.definition.properties))),a=t(a),this._coerce(a.where),a},d._coerce=function(a){var b=this;if(!a)return a;var c;if("object"!=typeof a||Array.isArray(a))throw c=new Error(u.format("The where clause %j is not an object",a)),c.statusCode=400,c;var d=b.definition.properties;for(var e in a){if("and"===e||"or"===e||"nor"===e){var f=a[e];if(!Array.isArray(f))throw c=new Error(u.format("The %p operator has invalid clauses %j",e,f)),c.statusCode=400,c;for(var g=0;g<f.length;g++)b._coerce(f[g]);return a}var h=d[e]&&d[e].type;if(h){if((Array.isArray(h)||h===Array)&&(h=h[0]),h===Date){var i=Date;h=function(a){return new i(a)}}else h===Boolean?h=function(a){return"true"===a?!0:"false"===a?!1:Boolean(a)}:h===Number&&(h=function(a){var b=Number(a);return isNaN(b)?a:b});if(h&&h!==p.GeoPoint){var j=a[e];if(null!==j&&void 0!==j){var k=null;if("object"==typeof j){if(1!==Object.keys(j).length)continue;for(var l in w)if(l in j){j=j[l],k=l;break}}if(Array.isArray(j))for(var g=0;g<j.length;g++)null!==j[g]&&void 0!==j[g]&&(j[g]=h(j[g]));else null!==j&&void 0!==j&&(j=h(j));if(k){var m={};m[k]=j,j=m}a[e]=j}}}}return a},d.find=function(a,b){if(!h(this.getDataSource(),this,arguments)){1===arguments.length&&(b=a,a=null);var d=this;a=a||{};try{this._normalize(a)}catch(e){return c.nextTick(function(){b&&b(e)})}var f=a&&p.nearFilter(a.where),g=!!this.getDataSource().connector.buildNearFilter;if(f)if(g)this.getDataSource().connector.buildNearFilter(a,f);else if(a.where)return void this.getDataSource().connector.all(this.modelName,{},function(c,e){var f=new q,g=d.modelName;c?b(c):Array.isArray(e)?(f.define({properties:d.dataSource.definitions[d.modelName].properties,settings:d.dataSource.definitions[d.modelName].settings,model:d}),e.forEach(function(a){f.create(g,a,function(){})}),f.all(g,a,b)):b(null,[])}.bind(this));this.getDataSource().connector.all(this.modelName,a,function(c,e){e&&e.forEach?(e.forEach(function(b,c){var f=new d(b,{fields:a.fields,applySetters:!1});if(a&&a.include)if(a.collect)f=f.__cachedRelations[a.collect];else{var g=a.include||[];"string"==typeof g?g=[g]:Array.isArray(g)||"object"!=typeof g||(g=Object.keys(g)),g.forEach(function(a){var b=f.__cachedRelations[a];Array.isArray(b)&&(b=new o(b,null,f)),f.__data[a]=b}),delete f.__data.__cachedRelations}e[c]=f}),e&&e.countBeforeLimit&&(e.countBeforeLimit=e.countBeforeLimit),!g&&f&&(e=p.filter(e,f)),b(c,e)):b(c,[])})}},d.findOne=function(a,b){h(this.getDataSource(),this,arguments)||("function"==typeof a&&(b=a,a={}),a=a||{},a.limit=1,this.find(a,function(a,c){return a||!c||!c.length>0?b(a,null):void b(a,c[0])}))},d.remove=d.deleteAll=d.destroyAll=function(a,b){if(!h(this.getDataSource(),this,arguments)){var d=this;if(b||"function"!=typeof a||(b=a,a=void 0),a){try{a=t(a),a=this._coerce(a)}catch(e){return c.nextTick(function(){b&&b(e)})}this.getDataSource().connector.destroyAll(this.modelName,a,function(c,e){b&&b(c,e),c||d.emit("deletedAll",a)}.bind(this))}else this.getDataSource().connector.destroyAll(this.modelName,function(a,c){b&&b(a,c),a||d.emit("deletedAll")}.bind(this))}},d.removeById=d.deleteById=d.destroyById=function(a,b){if(!h(this.getDataSource(),this,arguments)){var c=this;this.getDataSource().connector.destroy(this.modelName,a,function(d){"function"==typeof b&&b(d),d||c.emit("deleted",a)}.bind(this))}},d.count=function(a,b){if(!h(this.getDataSource(),this,arguments)){"function"==typeof a&&(b=a,a=null);try{a=t(a),a=this._coerce(a)}catch(d){return c.nextTick(function(){b&&b(d)})}this.getDataSource().connector.count(this.modelName,b,a)}},d.prototype.save=function(a,b){function c(){e.trigger("save",function(a){e.trigger("update",function(c){g=t(g),e._adapter().save(i,e.constructor._forDB(g),function(f){return f?b(f,e):(e._initProperties(g),void c.call(e,function(){a.call(e,function(){b(f,e),f||d.emit("changed",e)})}))})},g)},g)}if(!h(this.getDataSource(),this,arguments)){var d=this.constructor;"function"==typeof a&&(b=a,a={}),b=b||function(){},a=a||{},"validate"in a||(a.validate=!0),"throws"in a||(a.throws=!1);var e=this,g=e.toObject(!0),i=d.modelName;return f(d,this)?a.validate?void e.isValid(function(d){if(d)c();else{var f=new l(e);if(a.throws)throw f;b(f,e)}}):c():d.create(this,b)}},d.update=d.updateAll=function(a,b,d){if(!h(this.getDataSource(),this,arguments)){1===arguments.length?(b=a,a=null,d=null):2===arguments.length&&("function"==typeof b?(d=b,b=a,a=null):d=null),v("object"==typeof a,"The where argument should be an object"),v("object"==typeof b,"The data argument should be an object"),v(null===d||"function"==typeof d,"The cb argument should be a function");try{a=t(a),a=this._coerce(a)}catch(e){return c.nextTick(function(){d&&d(e)})}var f=this.getDataSource().connector;f.update(this.modelName,a,b,d)}},d.prototype.isNewRecord=function(){return!f(this.constructor,this)},d.prototype._adapter=function(){return this.getDataSource().connector},d.prototype.remove=d.prototype.delete=d.prototype.destroy=function(a){if(!h(this.getDataSource(),this,arguments)){var b=this.constructor,c=f(this.constructor,this);this.trigger("destroy",function(d){this._adapter().destroy(this.constructor.modelName,c,function(e){return e?a(e):void d(function(){a&&a(),b.emit("deleted",c)})}.bind(this))})}},d.prototype.updateAttribute=function(a,b,c){var d={};d[a]=b,this.updateAttributes(d,c)},d.prototype.updateAttributes=function(a,b){if(!h(this.getDataSource(),this,arguments)){var c=this,d=this.constructor,e=d.modelName;"function"==typeof a&&(b=a,a=null),a||(a={});for(var g in a)c[g]=a[g];c.isValid(function(g){g?c.trigger("save",function(g){c.trigger("update",function(h){var i={};for(var j in a)c[j]=a[j],i[j]=c[j];c._adapter().updateAttributes(e,f(c.constructor,c),c.constructor._forDB(i),function(a){h.call(c,function(){g.call(c,function(){b&&b(a,c),a||d.emit("changed",c)})})})},a)},a):b&&b(new l(c),c)},a)}},d.prototype.reload=function(a){h(this.getDataSource(),this,arguments)||this.constructor.findById(f(this.constructor,this),a)};var x=a("./scope.js").defineScope;d.scope=function(a,b,c){x(this,c||this,a,b)},j.mixin(d,n),j.mixin(d,m)}).call(this,a("+xKvab"))},{"+xKvab":29,"./connectors/memory":62,"./geo":65,"./include.js":67,"./jutil":69,"./list.js":70,"./relations.js":75,"./scope.js":76,"./utils":78,"./validations.js":79,assert:9,util:50}],64:[function(a,b,c){(function(b){function d(a,b,c){if(!(this instanceof d))return new d(a,b);"object"==typeof a&&void 0===b&&(b=a,a=void 0),"string"==typeof a&&-1!==a.indexOf("://")&&(a=o.parseSettings(a)),"string"==typeof b&&-1!==b.indexOf("://")&&(b=o.parseSettings(b)),this.modelBuilder=c||new l,this.models=this.modelBuilder.models,this.definitions=this.modelBuilder.definitions,this._operations={},this.setup(a,b),this._setupConnector();var e=this.connector,f=e&&e.DataAccessObject||this.constructor.DataAccessObject;this.DataAccessObject=function(){},Object.keys(f).forEach(function(a){var b=f[a];this.DataAccessObject[a]=b,"function"==typeof b&&this.defineOperation(a,{accepts:b.accepts,returns:b.returns,http:b.http,remoteEnabled:b.shared?!0:!1,scope:this.DataAccessObject,fnName:a})}.bind(this)),Object.keys(f.prototype).forEach(function(a){var b=f.prototype[a];this.DataAccessObject.prototype[a]=b,"function"==typeof b&&this.defineOperation(a,{prototype:!0,accepts:b.accepts,returns:b.returns,http:b.http,remoteEnabled:b.shared?!0:!1,scope:this.DataAccessObject.prototype,fnName:a})}.bind(this))}function e(a){var b=[];return a.match(/^\//)||(b.push("./connectors/"+a),0!==a.indexOf("loopback-connector-")&&b.push("loopback-connector-"+a)),-1===["mongodb","oracle","mysql","postgresql","mssql","rest","soap"].indexOf(a)&&b.push(a),b}function f(b,c){var d;c=c||a;for(var e=0;e<b.length;e++){try{d=c(b[e])}catch(f){}if(d)break}return d}function g(a){return a?a.prototype instanceof p:!1}function h(a){return a&&!a.settings.unresolved&&a.dataSource instanceof d}function i(a){return a?a.charAt(0).toUpperCase()+(a.length>1?a.slice(1).toLowerCase():""):a}function j(a,b){if(!a)return a;var c=a.split(/-|_/);c[0]=b?c[0].toLowerCase():i(c[0]);for(var d=1;d<c.length;d++)c[d]=i(c[d]);return c.join("")}function k(a,b,c){Object.defineProperty(a,b,{writable:!1,enumerable:!1,configurable:!1,value:c})}var l=a("./model-builder.js").ModelBuilder,m=a("./model-definition.js"),n=a("./jutil"),o=a("./utils"),p=a("./model.js"),q=a("./dao.js"),r=a("./scope.js").defineScope,s=a("events").EventEmitter,t=a("util"),u=a("assert"),v=a("async");"loopback"===b.env.DEBUG&&(b.env.DEBUG="loopback:*");var w=a("debug")("loopback:datasource");c.DataSource=d;var x=Array.prototype.slice;t.inherits(d,s),d.DataAccessObject=q,d.prototype._setupConnector=function(){if(this.connector=this.connector||this.adapter,this.adapter=this.connector,this.connector){this.connector.dataSource||(this.connector.dataSource=this);var a=this;this.connector.log=function(b,c){a.log(b,c)},this.connector.logger=function(a){var b=Date.now(),c=this.log;return function(d){c(d||a,b)}}}},d._resolveConnector=function(a,b){var c=e(a),d=f(c,b),g=null;return d||(g='\nWARNING: LoopBack connector "'+a+'" is not installed at any of the locations '+c+". To fix, run:\n\n    npm install "+a+"\n"),{connector:d,error:g}},d.prototype.setup=function(a,c){var e,f=this;if(a&&"object"==typeof a&&!c&&(c=a,a=void 0),"object"==typeof c&&(c.initialize?e=c:c.connector?e=c.connector:c.adapter&&(e=c.adapter)),this.settings=c||{},this.settings.debug=this.settings.debug||w.enabled,this.settings.debug&&w("Settings: %j",this.settings),this.connected=!1,this.connecting=!1,"string"==typeof e&&(a=e,e=void 0),a=a||e&&e.name,this.name=a,a&&!e)if("object"==typeof a)e=a,this.name=e.name;else{var g=d._resolveConnector(a);if(e=g.connector,!e)return void console.error(g.error)}if(e){var h=function(a){if(this._setupConnector(),!this.connector)throw new Error("Connector is not defined correctly: it should create `connector` member of dataSource");this.connected=!a,this.connected?this.emit("connected"):(console.error("Connection fails: ",a,"\nIt will be retried for the next request."),this.connecting=!1)}.bind(this);"function"==typeof e.initialize?e.initialize(this,h):"function"==typeof e&&(this.connector=new e(this.settings),h())}f.connect=function(a){var c=this;return c.connected||c.connecting?void b.nextTick(function(){a&&a()}):(c.connecting=!0,void(c.connector.connect?c.connector.connect(function(b,d){b?(c.connected=!1,c.connecting=!1,c.emit("error",b)):(c.connected=!0,c.connecting=!1,c.emit("connected")),a&&a(b,d)}):b.nextTick(function(){c.connected=!0,c.connecting=!1,c.emit("connected"),a&&a()})))}},d.relationTypes=["belongsTo","hasMany","hasAndBelongsToMany"],d.prototype.defineScopes=function(a,b){if(b)for(var c in b)r(a,a,c,b[c])},d.prototype.defineRelations=function(a,b){var c=function(b,c,d,e){h(d)||d.once("dataSourceAttached",function(d){if(!e||h(e)){var f={foreignKey:c.foreignKey,as:b,model:d};e&&(f.through=e),a[c.type].call(a,b,f)}}),e&&!h(e)&&e.once("dataSourceAttached",function(e){if(h(d)){var f={foreignKey:c.foreignKey,as:b,model:d,through:e};a[c.type].call(a,b,f)}})};if(b)for(var e in b){var f=b[e];u(-1!==d.relationTypes.indexOf(f.type),"Invalid relation type: "+f.type);var i=g(f.model)?f.model:this.getModel(f.model,!0),j=null;if(f.through&&(j=g(f.through)?f.through:this.getModel(f.through,!0)),!h(i)||j&&!h(j))c(e,f,i,j);else{var k={foreignKey:f.foreignKey,as:e,model:i};j&&(k.through=j),a[f.type].call(a,e,k)}}},d.prototype.setupDataAccess=function(a,b){if(this.connector){var c=a.definition.idName(),d=a.definition.rawProperties[c];if(d&&d.generated&&this.connector.getDefaultIdType){var e=this.connector.getDefaultIdType()||String;d.type=e,a.definition.properties[c].type=e}this.connector.define&&this.connector.define({model:a,properties:a.definition.properties,settings:b})}this.mixin(a);var f=b.relationships||b.relations;this.defineRelations(a,f);var g=b.scopes||{};this.defineScopes(a,g)},d.prototype.createModel=d.prototype.define=function(a,b,c){var d=x.call(arguments);if(!a)throw new Error("Class name required");1===d.length&&(b={},d.push(b)),2===d.length&&(c={},d.push(c)),b=b||{},c=c||{},this.isRelational()&&((void 0===c.strict||null===c.strict)&&(c.strict=!0),c.strict===!1&&(c.strict="throw"));var e=this.modelBuilder.define(a,b,c);return e.dataSource=this,c.unresolved?e:(this.setupDataAccess(e,c),e.emit("dataSourceAttached",e),e)},d.prototype.mixin=function(a){var b=this.operations(),c=this.DataAccessObject;n.mixin(a,c,{proxyFunctions:!0,override:!0}),Object.keys(b).forEach(function(c){var d,e=b[c];e.enabled&&(d=e.prototype?a.prototype:a,Object.keys(e).filter(function(a){return~["scope","fnName","prototype"].indexOf(a)}).forEach(function(a){"undefined"!=typeof e[a]&&(e.scope[e.fnName][a]=e[a])}))})},d.prototype.getModel=function(a,b){return this.modelBuilder.getModel(a,b)},d.prototype.getModelDefinition=function(a){return this.modelBuilder.getModelDefinition(a)},d.prototype.getTypes=function(){var a=this.connector&&this.connector.getTypes()||[];return"string"==typeof a&&(a=a.split(/[\s,\/]+/)),a},d.prototype.supportTypes=function(a){var b=this.getTypes();if(Array.isArray(a)){for(var c=0;c<a.length;c++)if(-1===b.indexOf(a[c]))return!1;return!0}return-1!==b.indexOf(a)},d.prototype.attach=function(a){return a.dataSource===this?a:(a.modelBuilder!==this.modelBuilder&&(this.modelBuilder.definitions[a.modelName]=a.definition,this.modelBuilder.models[a.modelName]=a,a.modelBuilder=this.modelBuilder),a.dataSource=this,this.setupDataAccess(a,a.settings),a.emit("dataSourceAttached",a),a)},d.prototype.defineProperty=function(a,b,c){this.modelBuilder.defineProperty(a,b,c);var d=this.getModelDefinition(a).properties[b];this.connector&&this.connector.defineProperty&&this.connector.defineProperty(a,b,d)},d.prototype.automigrate=function(a,c){this.freeze(),this.connector.automigrate?this.connector.automigrate(a,c):(c||"function"!=typeof a||(c=a,a=void 0),c&&b.nextTick(c))},d.prototype.autoupdate=function(a,c){this.freeze(),this.connector.autoupdate?this.connector.autoupdate(a,c):(c||"function"!=typeof a||(c=a,a=void 0),c&&b.nextTick(c))},d.prototype.discoverModelDefinitions=function(a,c){this.freeze(),this.connector.discoverModelDefinitions?this.connector.discoverModelDefinitions(a,c):c&&b.nextTick(c)},d.prototype.discoverModelDefinitionsSync=function(a){return this.freeze(),this.connector.discoverModelDefinitionsSync?this.connector.discoverModelDefinitionsSync(a):null},d.prototype.discoverModelProperties=function(a,c,d){this.freeze(),this.connector.discoverModelProperties?this.connector.discoverModelProperties(a,c,d):d&&b.nextTick(d)},d.prototype.discoverModelPropertiesSync=function(a,b){return this.freeze(),this.connector.discoverModelPropertiesSync?this.connector.discoverModelPropertiesSync(a,b):null},d.prototype.discoverPrimaryKeys=function(a,c,d){this.freeze(),this.connector.discoverPrimaryKeys?this.connector.discoverPrimaryKeys(a,c,d):d&&b.nextTick(d)},d.prototype.discoverPrimaryKeysSync=function(a,b){return this.freeze(),this.connector.discoverPrimaryKeysSync?this.connector.discoverPrimaryKeysSync(a,b):null},d.prototype.discoverForeignKeys=function(a,c,d){this.freeze(),this.connector.discoverForeignKeys?this.connector.discoverForeignKeys(a,c,d):d&&b.nextTick(d)},d.prototype.discoverForeignKeysSync=function(a,b){return this.freeze(),this.connector.discoverForeignKeysSync?this.connector.discoverForeignKeysSync(a,b):null},d.prototype.discoverExportedForeignKeys=function(a,c,d){this.freeze(),this.connector.discoverExportedForeignKeys?this.connector.discoverExportedForeignKeys(a,c,d):d&&b.nextTick(d)},d.prototype.discoverExportedForeignKeysSync=function(a,b){return this.freeze(),this.connector.discoverExportedForeignKeysSync?this.connector.discoverExportedForeignKeysSync(a,b):null},d.prototype.discoverSchema=function(a,b,c){b=b||{},c||"function"!=typeof b||(c=b,b={}),b.visited={},b.relations=!1,this.discoverSchemas(a,b,function(a,b){if(a)return void(c&&c(a,b));for(var d in b)return void(c&&c(null,b[d]))})},d.prototype.discoverSchemas=function(a,b,c){b=b||{},c||"function"!=typeof b||(c=b,b={});var e=this,f=this.connector.name||this.name,g=[this.discoverModelProperties.bind(this,a,b),this.discoverPrimaryKeys.bind(this,a,b)],h=b.associations||b.relations;h&&g.push(this.discoverForeignKeys.bind(this,a,b)),v.parallel(g,function(g,i){if(g)return void(c&&c(g));var k=i[0];if(!k||0===k.length)return void(c&&c());var l=i[1],m={};l.forEach(function(a){m[a.columnName]=a.keySeq}),e.settings.debug&&w("Primary keys: ",m);var n={name:j(a,!1),options:{idInjection:!1},properties:{}};n.options[f]={schema:k[0].owner,table:a},k.forEach(function(a){var b=a,c=j(a.columnName,!0);n.properties[c]={type:a.type,required:"N"===a.nullable,length:a.dataLength,precision:a.dataPrecision,scale:a.dataScale},m[a.columnName]&&(n.properties[c].id=m[a.columnName]),n.properties[c][f]={columnName:b.columnName,dataType:b.dataType,dataLength:b.dataLength,dataPrecision:a.dataPrecision,dataScale:a.dataScale,nullable:b.nullable}}),b.visited=b.visited||{};var o=k[0].owner+"."+a;b.visited.hasOwnProperty(o)||(e.settings.debug&&w("Adding schema for "+o),b.visited[o]=n);var p={};if(h){var q={},r=i[2];r.forEach(function(a){var b={keySeq:a.keySeq,owner:a.pkOwner,tableName:a.pkTableName,columnName:a.pkColumnName};q[a.fkName]?q[a.fkName].push(b):q[a.fkName]=[b]}),e.settings.debug&&w("Foreign keys: ",q),n.options.relations={},r.forEach(function(a){var c=j(a.pkTableName,!0);n.options.relations[c]={model:j(a.pkTableName,!1),type:"belongsTo",foreignKey:j(a.fkColumnName,!0)};var d=a.pkOwner+"."+a.pkTableName;b.visited.hasOwnProperty(d)||p.hasOwnProperty(d)||(p[d]={owner:a.pkOwner,tableName:a.pkTableName})})}if(0===Object.keys(p).length)c&&c(null,b.visited);else{var s=[];for(var t in p){e.settings.debug&&w("Discovering related schema for "+o);var u={};for(var x in b)u[x]=b[x];u.owner=p[t].owner,s.push(d.prototype.discoverSchemas.bind(e,p[t].tableName,u))}v.parallel(s,function(a,b){var d=b&&b[0];c&&c(a,d)})}})},d.prototype.discoverSchemasSync=function(a,b){var c=this,d=this.name||this.connector.name,e=this.discoverModelPropertiesSync(a,b);if(!e||0===e.length)return[];var f=this.discoverPrimaryKeysSync(a,b),g={};f.forEach(function(a){g[a.columnName]=a.keySeq}),c.settings.debug&&w("Primary keys: ",g);var h={name:j(a,!1),options:{idInjection:!1},properties:{}};h.options[d]={schema:e.length>0&&e[0].owner,table:a},e.forEach(function(a){var b=a,c=j(a.columnName,!0);h.properties[c]={type:a.type,required:"N"===a.nullable,length:a.dataLength,precision:a.dataPrecision,scale:a.dataScale},g[a.columnName]&&(h.properties[c].id=g[a.columnName]),h.properties[c][d]={columnName:b.columnName,dataType:b.dataType,dataLength:b.dataLength,dataPrecision:a.dataPrecision,dataScale:a.dataScale,nullable:b.nullable}}),b.visited=b.visited||{};var i=e[0].owner+"."+a;b.visited.hasOwnProperty(i)||(c.settings.debug&&w("Adding schema for "+i),b.visited[i]=h);var k={},l=b.associations||b.relations;if(l){var m={},n=this.discoverForeignKeysSync(a,b);n.forEach(function(a){var b={keySeq:a.keySeq,owner:a.pkOwner,tableName:a.pkTableName,columnName:a.pkColumnName};m[a.fkName]?m[a.fkName].push(b):m[a.fkName]=[b]}),c.settings.debug&&w("Foreign keys: ",m),h.options.relations={},n.forEach(function(a){var c=j(a.pkTableName,!0);h.options.relations[c]={model:j(a.pkTableName,!1),type:"belongsTo",foreignKey:j(a.fkColumnName,!0)};var d=a.pkOwner+"."+a.pkTableName;b.visited.hasOwnProperty(d)||k.hasOwnProperty(d)||(k[d]={owner:a.pkOwner,tableName:a.pkTableName})})}if(0===Object.keys(k).length)return b.visited;for(var o in k){c.settings.debug&&w("Discovering related schema for "+i);var p={};for(var q in b)p[q]=b[q];p.owner=k[o].owner,c.discoverSchemasSync(k[o].tableName,p)}return b.visited},d.prototype.discoverAndBuildModels=function(a,b,c){var d=this;this.discoverSchemas(a,b,function(a,b){if(a)return void(c&&c(a,b));var e=[];for(var f in b){var g=b[f];e.push(g)}var h=d.modelBuilder.buildModels(e);for(var i in h)h[i].attachTo(d);c&&c(a,h)})},d.prototype.discoverAndBuildModelsSync=function(a,b){var c=this.discoverSchemasSync(a,b),d=[];for(var e in c){var f=c[e];d.push(f)}var g=this.modelBuilder.buildModels(d);return g},d.prototype.isActual=function(a,c){this.freeze(),this.connector.isActual?this.connector.isActual(a,c):(c||"function"!=typeof a||(c=a,a=void 0),c&&b.nextTick(function(){c(null,!0)}))},d.prototype.log=function(a,b){w(a,b),this.emit("log",a,b)},d.prototype.freeze=function(){if(!this.connector)throw new Error("The connector has not been initialized.");this.connector.freezeDataSource&&this.connector.freezeDataSource(),this.connector.freezeSchema&&this.connector.freezeSchema()},d.prototype.tableName=function(a){return this.getModelDefinition(a).tableName(this.connector.name)},d.prototype.columnName=function(a,b){return this.getModelDefinition(a).columnName(this.connector.name,b)
},d.prototype.columnMetadata=function(a,b){return this.getModelDefinition(a).columnMetadata(this.connector.name,b)},d.prototype.columnNames=function(a){return this.getModelDefinition(a).columnNames(this.connector.name)},d.prototype.idColumnName=function(a){return this.getModelDefinition(a).idColumnName(this.connector.name)},d.prototype.idName=function(a){return this.getModelDefinition(a).idName||console.error("No id name",this.getModelDefinition(a)),this.getModelDefinition(a).idName()},d.prototype.idNames=function(a){return this.getModelDefinition(a).idNames()},d.prototype.idProperty=function(a){var b=this.getModelDefinition(a),c=b&&b.ids();return c&&c[0]&&c[0].property},d.prototype.defineForeignKey=function(a,b,c){if(!this.getModelDefinition(a).rawProperties[b]){var d=Number;if(c){var e=this.getModelDefinition(c),f=e&&e.idName();f&&(d=e.properties[f].type)}if(this.connector.defineForeignKey){var g=function(c,e){if(c)throw c;this.defineProperty(a,b,{type:e||d})}.bind(this);switch(this.connector.defineForeignKey.length){case 4:this.connector.defineForeignKey(a,b,c,g);break;default:case 3:this.connector.defineForeignKey(a,b,g)}}else this.defineProperty(a,b,{type:d})}},d.prototype.disconnect=function(a){var c=this;this.connected&&"function"==typeof this.connector.disconnect?this.connector.disconnect(function(b,d){c.connected=!1,a&&a(b,d)}):b.nextTick(function(){a&&a()})},d.prototype.copyModel=function(a){var b=this,c=a.modelName,d=a.modelBuilder.getModelDefinition(c),e=function(){a.apply(this,[].slice.call(arguments))};return t.inherits(e,a),e.__proto__=a,k(e,"dataSource",b),k(e,"modelName",c),k(e,"relations",a.relations),c in b.modelBuilder.models||(b.modelBuilder.models[c]=e,b.modelBuilder.definitions[c]=new m(b.modelBuilder,d.name,d.properties,d.settings),!b.isTransaction&&b.connector&&b.connector.define&&b.connector.define({model:e,properties:d.properties,settings:d.settings})),e},d.prototype.transaction=function(){var a=this,b=new s;for(var c in a)b[c]=a[c];b.isTransaction=!0,b.origin=a,b.name=a.name,b.settings=a.settings,b.connected=!1,b.connecting=!1,b.connector=a.connector.transaction(),b.modelBuilder=new l,b.models=b.modelBuilder.models,b.definitions=b.modelBuilder.definitions;for(var d in a.modelBuilder.models)a.copyModel.call(b,a.modelBuilder.models[d]);return b.exec=function(a){b.connector.exec(a)},b},d.prototype.enableRemote=function(a){var b=this.getOperation(a);if(!b)throw new Error(a+" is not provided by the attached connector");b.remoteEnabled=!0},d.prototype.disableRemote=function(a){var b=this.getOperation(a);if(!b)throw new Error(a+" is not provided by the attached connector");b.remoteEnabled=!1},d.prototype.getOperation=function(a){for(var b=this.operations(),c=Object.keys(b),d=0;d<c.length;d++){var e=b[c[d]];if(e.name===a)return e}},d.prototype.operations=function(){return this._operations},d.prototype.defineOperation=function(a,b,c){b.fn=c,b.name=a,this._operations[a]=b},d.prototype.isRelational=function(){return this.connector&&this.connector.relational},d.prototype.ready=function(a,b){var c=this;if(this.connected)return!1;var d=b.callee,e=null,f=null;return e=function(){c.removeListener("error",f),d.apply(a,[].slice.call(b))},f=function(a){c.removeListener("connected",e);var d=[].slice.call(b),f=d.pop();"function"==typeof f&&f(a)},this.once("connected",e),this.once("error",f),this.connecting||this.connect(),!0},d.Text=l.Text,d.JSON=l.JSON,d.Any=l.Any,d.registerType=function(a){l.registerType(a)}}).call(this,a("+xKvab"))},{"+xKvab":29,"./dao.js":63,"./jutil":69,"./model-builder.js":71,"./model-definition.js":72,"./model.js":73,"./scope.js":76,"./utils":78,assert:9,async:80,debug:81,events:22,util:50}],65:[function(a,b,c){function d(a){return this instanceof d?("string"==typeof a&&(a=a.split(/,\s*/),f(2===a.length,'must provide a string "lng,lat" creating a GeoPoint with a string')),Array.isArray(a)?a={lng:Number(a[0]),lat:Number(a[1])}:(a.lng=Number(a.lng),a.lat=Number(a.lat)),f("object"==typeof a,"must provide a lat and lng object when creating a GeoPoint"),f("number"==typeof a.lat&&!isNaN(a.lat),"lat must be a number when creating a GeoPoint"),f("number"==typeof a.lng&&!isNaN(a.lng),"lng must be a number when creating a GeoPoint"),f(a.lng<=180,"lng must be <= 180"),f(a.lng>=-180,"lng must be >= -180"),f(a.lat<=90,"lat must be <= 90"),f(a.lat>=-90,"lat must be >= -90"),this.lat=a.lat,void(this.lng=a.lng)):new d(a)}function e(a,b,c,d,e){a*=g,b*=g,c*=g,d*=g;var f=Math.pow(Math.sin((d-b)/2),2),h=Math.pow(Math.sin((c-a)/2),2),j=Math.sqrt(f+Math.cos(d)*Math.cos(b)*h),k=e&&e.type||"miles";return 2*Math.asin(j)*i[k]}var f=a("assert");c.nearFilter=function(a){var b=!1;return a&&"object"==typeof a&&Object.keys(a).forEach(function(c){var d=a[c];d&&d.near&&(b={near:d.near,maxDistance:d.maxDistance,key:c})}),b},c.filter=function(a,b){var c=b.near,e=b.maxDistance>0?b.maxDistance:!1,f=b.key,g={},h=[];return a.forEach(function(a){var b=a[f];if(b&&(b instanceof d||(b=d(b)),"number"==typeof b.lat&&"number"==typeof b.lng)){var i=d.distanceBetween(c,b);e&&i>e||(g[a.id]=i,h.push(a))}}),h.sort(function(a,b){var c=b[f],d=b[f];if(c&&d){var e=g[a.id],h=g[b.id];return h===e?0:e>h?1:-1}return 0})},c.GeoPoint=d,d.distanceBetween=function(a,b,c){a instanceof d||(a=d(a)),b instanceof d||(b=d(b));var f=a.lat,g=a.lng,h=b.lat,i=b.lng;return e(f,g,h,i,c)},d.prototype.distanceTo=function(a,b){return d.distanceBetween(this,a,b)},d.prototype.toString=function(){return this.lng+","+this.lat};var g=.01745329252,h=57.29577951308,i={kilometers:6370.99056,meters:6370990.56,miles:3958.75,feet:20902200,radians:1,degrees:h}},{assert:9}],66:[function(a,b){function c(){}function d(a){return a.charAt(0).toUpperCase()+a.slice(1)}b.exports=c,c.afterInitialize=null,c.beforeValidate=null,c.afterValidate=null,c.beforeSave=null,c.afterSave=null,c.beforeCreate=null,c.afterCreate=null,c.beforeUpdate=null,c.afterUpdate=null,c.beforeDestroy=null,c.afterDestroy=null,c.prototype.trigger=function(a,b,c){function e(a){h?h.call(i,a):a&&a.call(this)}var f=d(a),g=this.constructor["before"+f]||this.constructor["pre"+f],h=this.constructor["after"+f]||this.constructor["post"+f];"validate"===a&&(g=g||this.constructor.beforeValidation,h=h||this.constructor.afterValidation);var i=this;b?g?g.call(i,function(){b.call(i,e)},c):b.call(i,e):e()}},{}],67:[function(a,b){(function(c){function d(){}var e=a("async"),f=a("./utils"),g=f.isPlainObject,h=f.defineCachedRelations;b.exports=d,d.include=function(a,b,d){function f(a){if("string"==typeof a)return[a];if(g(a)){var b=[];for(var c in a){var d={};d[c]=a[c],b.push(d)}return b}return a}function i(a,b,c){var d,f,i=j.relations;g(b)?(d=Object.keys(b)[0],f=b[d]):(d=b,f=null);var k=i[d];return k?void e.each(a,function(a,b){if("belongsTo"===k.type&&(null===a[k.keyFrom]||void 0===a[k.keyFrom]))return h(a),a.__cachedRelations[d]=null,a===c?a.__data[d]=null:a[d]=null,b();var c=a instanceof j?a:new j(a);c[d](function(e,g){if(e)return b(e);if(h(a),a.__cachedRelations[d]=g,a===c?(a.__data[d]=g,a.strict=!1):a[d]=g,f&&g){var i=k.multiple?g:[g];k.modelTo.include(i,f,b)}else b(null,g)})},c):void c(new Error('Relation "'+d+'" is not defined for '+j.modelName+" model"))}var j=this;return!b||Array.isArray(b)&&0===b.length||g(b)&&0===Object.keys(b).length?c.nextTick(function(){d&&d(null,a)}):(b=f(b),void e.each(b,function(b,c){i(a,b,c)},function(b){d&&d(b,a)}))}}).call(this,a("+xKvab"))},{"+xKvab":29,"./utils":78,async:80}],68:[function(a,b){b.exports=function(a){function b(c){if(null===c||void 0===c)return a.Any;for(var d in a.schemaTypes){var e=a.schemaTypes[d];if(e!==Object&&e!==Array&&c instanceof e)return d}var f=typeof c;if("string"===f||"number"===f||"boolean"===f)return f;if(c instanceof Date)return"date";if(Array.isArray(c)){for(var g=0;g<c.length;g++)if(null!==c[g]&&void 0!==c[g]){var h=b(c[g]);if(h)return[h]}return"array"}if("function"===f)return c.constructor.name;var i={};for(var j in c){var h=b(c[j]);h&&(i[j]=h)}return 0===Object.keys(i).length?"object":i}return b}},{}],69:[function(a,b,c){function d(a,b,c){Object.keys(a).forEach(function(d){var e=b.hasOwnProperty(d),f=Object.getOwnPropertyDescriptor(a,d),g=e&&Object.getOwnPropertyDescriptor(b,d),h="function"==typeof f.value,i=e&&"function"==typeof g.value,j=i&&g.value._delegate,k=c.override||!e||j;k&&(h&&(f.value=f.value),Object.defineProperty(b,d,f))})}var e=a("util");c.inherits=function(a,b,c){e.inherits(a,b),c=c||{staticProperties:!0,override:!1},c.staticProperties&&Object.keys(b).forEach(function(d){if("super_"!==d&&(!a.hasOwnProperty(d)||c.override)){var e=Object.getOwnPropertyDescriptor(b,d);Object.defineProperty(a,d,e)}})},c.mixin=function(a,b,c){if(Array.isArray(a._mixins)){if(-1!==a._mixins.indexOf(b))return;a._mixins.push(b)}else a._mixins=[b];return c=c||{staticProperties:!0,instanceProperties:!0,override:!1,proxyFunctions:!1},void 0===c.staticProperties&&(c.staticProperties=!0),void 0===c.instanceProperties&&(c.instanceProperties=!0),c.staticProperties&&d(b,a,c),c.instanceProperties&&b.prototype&&d(b.prototype,a.prototype,c),a}},{util:50}],70:[function(a,b){function c(a,b,f){var g=this;if(!(g instanceof c))return new c(a,b,f);if("string"==typeof a)try{a=JSON.parse(a)}catch(h){throw new Error(d.format("could not create List from JSON string: %j",a))}var i=[];if(i.__proto__=c.prototype,a=a||[],!Array.isArray(a))throw new Error(d.format("Items must be an array: %j",a));return b||(b=a[0]&&a[0].constructor),Array.isArray(b)&&(b=b[0]),b===Array&&(b=e),Object.defineProperty(i,"itemType",{writable:!0,enumerable:!1,value:b}),f&&Object.defineProperty(i,"parent",{writable:!0,enumerable:!1,value:f}),a.forEach(function(a,c){i[c]=!b||a instanceof b?a:b(a)}),i}var d=a("util"),e=a("./types").Types.Any;b.exports=c,d.inherits(c,Array);var f=c.prototype.push;c.prototype.push=function(a){var b=this.itemType&&a instanceof this.itemType?a:this.itemType(a);return f.call(this,b),b},c.prototype.toObject=function(a,b){var c=[];return this.forEach(function(d){c.push(d.toObject?d.toObject(a,b):d)}),c},c.prototype.toJSON=function(){return this.toObject(!0)},c.prototype.toString=function(){return JSON.stringify(this.toJSON())}},{"./types":77,util:50}],71:[function(a,b,c){function d(){this.models={},this.definitions={}}function e(a){return a?a.prototype instanceof l:!1}function f(a){return new Date(a)}function g(a,b,c){Object.defineProperty(a,b,{writable:!0,enumerable:!1,configurable:!0,value:c})}var h=a("inflection"),i=a("events").EventEmitter,j=a("util"),k=a("assert"),l=a("./model.js"),m=a("./list.js"),n=a("./model-definition.js"),o=a("./utils").mergeSettings;a("./types")(d);var p=a("./introspection")(d);c.ModelBuilder=c.Schema=d;var q=Array.prototype.slice;j.inherits(d,i),d.defaultInstance=new d,d.prototype.getModel=function(a,b){var c=this.models[a];return!c&&b&&(c=this.define(a,{},{unresolved:!0})),c},d.prototype.getModelDefinition=function(a){return this.definitions[a]},d.prototype.define=function(a,b,c,d){var p=this,r=q.call(arguments),s=c&&c.plural||h.pluralize(a);if(!a)throw new Error("Class name required");1===r.length&&(b={},r.push(b)),2===r.length&&(c={},r.push(c)),b=b||{},c=c||{},(void 0===c.strict||null===c.strict)&&(c.strict=!1);var t=d||l,u=c.base||c["super"];u&&(e(u)?t=u:(t=this.models[u],k(t,"Base model is not found: "+u)));var v=this.models[a];if(!v||!v.settings.unresolved){v=function H(a,b){if(!(this instanceof H))return new H(a,b);if(v.settings.unresolved)throw new Error("Model "+v.modelName+" is not defined.");t.apply(this,arguments)};var w=new i;for(var x in i.prototype)"function"==typeof i.prototype[x]&&(v[x]=i.prototype[x].bind(w));g(v,"modelName",a)}if(j.inherits(v,t),this.models[a]=v,c.unresolved)return v.settings={unresolved:!0},v;g(v,"modelBuilder",p),g(v,"dataSource",p),g(v,"pluralModelName",s),g(v,"relations",{}),g(v,"http",{path:"/"+s});for(var y in t)"_mixins"===y||y in v||(v[y]=t[y]);c.models&&Object.keys(c.models).forEach(function(a){var b=c.models[a];v[a]="string"==typeof b?p.getModel(b,!0):b}),v.getter={},v.setter={};var z=new n(this,a,b,c);this.definitions[a]=z,v.definition=z,v.settings=z.settings;var A=c.idInjection;A!==!1&&(A=!0);var B=z.idNames();if(B.length>0&&(A=!1),A&&v.definition.defineProperty("id",{type:Number,id:1,generated:!0}),B=z.idNames(),1===B.length){var C=B[0];"id"!==C&&Object.defineProperty(v.prototype,"id",{get:function(){var a=v.definition.idNames[0];return this.__data[a]},configurable:!0,enumerable:!1})}else Object.defineProperty(v.prototype,"id",{get:function(){var a={},b=v.definition.idNames();for(var c in b)a[c]=this.__data[c];return a},configurable:!0,enumerable:!1});v.forEachProperty=function(a){for(var b=v.definition.properties,c=Object.keys(b),d=0,e=c.length;e>d;d++)a(c[d],b[c[d]])},v.attachTo=function(a){a.attach(this)},v.extend=function(a,b,c){var d=v.definition.properties,e=v.definition.settings;b=b||{},c=c||{};var f=!1;for(var g in b)if(b[g].id){f=!0;break}for(var h=Object.keys(d),i=0,j=h.length;j>i;i++){var k=h[i];f&&d[k].id||void 0===b[k]&&(b[k]=d[k])}c=o(e,c);var l=p.define(a,b,c,v);return"function"==typeof l.setup&&l.setup.call(l),l},v.registerProperty=function(a){var b=z.build(),c=b[a],d=c.type;if(!d)throw new Error("Invalid type for property "+a);if(c.required){var e="object"==typeof c.required?c.required:void 0;v.validatesPresenceOf(a,e)}Object.defineProperty(v.prototype,a,{get:function(){return v.getter[a]?v.getter[a].call(this):this.__data&&this.__data[a]},set:function(c){var d=v.definition.properties[a].type;Array.isArray(d)||d===Array?d=m:d===Date?d=f:"string"==typeof d&&(d=p.resolveType(d)),v.setter[a]?v.setter[a].call(this,c):(this.__data=this.__data||{},this.__data[a]=null===c||void 0===c?c:d===m?d(c,b[a].type,this.__data):c instanceof d?c:d(c))},configurable:!0,enumerable:!0}),Object.defineProperty(v.prototype,"$"+a,{get:function(){return this.__data&&this.__data[a]},set:function(b){this.__data||(this.__data={}),this.__data[a]=b},configurable:!0,enumerable:!1})};var D=v.definition.properties,E=Object.keys(D),F=E.length;for(y=0;F>y;y++){var G=E[y];v.registerProperty(G)}return v.emit("defined",v),v},d.prototype.defineProperty=function(a,b,c){this.definitions[a].defineProperty(b,c),this.models[a].registerProperty(b)},d.prototype.defineValueType=function(a,b){d.registerType(a,b)},d.prototype.extendModel=function(a,b){for(var c=this,d=Object.keys(b),e=0;e<d.length;e++){var f=b[d[e]];c.defineProperty(a,d[e],f)}},d.prototype.copyModel=function(a){var b=this,c=a.modelName,d=a.modelBuilder.definitions[c],e=function(){a.apply(this,[].slice.call(arguments))};return j.inherits(e,a),e.__proto__=a,g(e,"modelBuilder",b),g(e,"modelName",c),g(e,"relations",a.relations),c in b.models||(b.models[c]=e,b.definitions[c]={properties:d.properties,settings:d.settings}),e},d.prototype.getSchemaName=function(a){return a?a:("number"!=typeof this._nameCount?this._nameCount=0:this._nameCount++,"AnonymousModel_"+this._nameCount)},d.prototype.resolveType=function(a){if(!a)return a;if(Array.isArray(a)&&a.length>0){var b=this.resolveType(a[0]);return"function"==typeof b?[b]:b}if("string"==typeof a){var c=d.schemaTypes[a.toLowerCase()]||this.models[a];return c?c:a=this.define(a,{},{unresolved:!0})}return"Object"===a.constructor.name?a.type?this.resolveType(a.type):this.define(this.getSchemaName(null),a,{anonymous:!0,idInjection:!1}):"function"==typeof a?a:a},d.prototype.buildModels=function(a){var b={};Array.isArray(a)||(a=a.properties&&a.name?[a]:[{name:this.getSchemaName(),properties:a,options:{anonymous:!0}}]);var c=[];for(var d in a){var e=this.getSchemaName(a[d].name);a[d].name=e;var f=this.define(a[d].name,a[d].properties,a[d].options);b[e]=f,c=c.concat(f.definition.relations)}for(var g=0;g<c.length;g++){var h=c[g],i=b[h.source],j=b[h.target];i&&j&&"function"==typeof i[h.type]&&i[h.type](j,{as:h.as})}return b},d.prototype.buildModelFromInstance=function(a,b,c){var d=p(b);return this.define(a,d,c)}},{"./introspection":68,"./list.js":70,"./model-definition.js":72,"./model.js":73,"./types":77,"./utils":78,assert:9,events:22,inflection:82,util:50}],72:[function(a,b){function c(a,b,d,f){if(!(this instanceof c))return new c(a,b,d,f);if(this.modelBuilder=a||j.defaultInstance,e(b,"name is missing"),2===arguments.length&&"object"==typeof b){var g=b;this.name=g.name,this.rawProperties=g.properties||{},this.settings=g.settings||{}}else e("string"==typeof b,"name must be a string"),this.name=b,this.rawProperties=d||{},this.settings=f||{};this.relations=[],this.properties=null,this.build()}function d(a){return a?a.prototype instanceof i:!1}var e=a("assert"),f=a("util"),g=a("events").EventEmitter,h=a("traverse"),i=a("./model"),j=a("./model-builder");b.exports=c,f.inherits(c,g),a("./types")(c),c.prototype.tableName=function(a){var b=this.settings;return b[a]?b[a].table||b[a].tableName||this.name:this.name},c.prototype.columnName=function(a,b){if(!b)return b;this.build();var c=this.properties[b];return c&&c[a]?c[a].column||c[a].columnName||b:b},c.prototype.columnMetadata=function(a,b){if(!b)return b;this.build();var c=this.properties[b];return c&&c[a]?c[a]:null},c.prototype.columnNames=function(a){this.build();var b=this.properties,c=[];for(var d in b)c.push(b[d][a]?property[a].column||b[d][a].columnName||d:d);return c},c.prototype.ids=function(){if(this._ids)return this._ids;var a=[];this.build();var b=this.properties;for(var c in b){var d=b[c].id;d&&("number"!=typeof d&&(d=1),a.push({name:c,id:d,property:b[c]}))}return a.sort(function(a,b){return a.key-b.key}),this._ids=a,a},c.prototype.idColumnName=function(a){return this.columnName(a,this.idName())},c.prototype.idName=function(){var a=this.ids()[0];return this.properties.id&&this.properties.id.id?"id":a&&a.name},c.prototype.idNames=function(){var a=this.ids(),b=a.map(function(a){return a.name});return b},c.prototype.indexes=function(){this.build();var a={};if(this.settings.indexes)for(var b in this.settings.indexes)a[b]=this.settings.indexes[b];for(var c in this.properties)this.properties[c].index&&(a[c+"_index"]=this.properties[c].index);return a},c.prototype.build=function(a){if(a&&(this.properties=null,this.relations=[],this._ids=null),this.properties)return this.properties;this.properties={};for(var b in this.rawProperties){var c=this.rawProperties[b],d=this.modelBuilder.resolveType(c);if("string"==typeof d)this.relations.push({source:this.name,target:d,type:Array.isArray(c)?"hasMany":"belongsTo",as:b});else{var e={type:d};if("object"==typeof c&&null!==c)for(var f in c)"type"!==f&&(e[f]=c[f]);this.properties[b]=e}}return this.properties},c.prototype.defineProperty=function(a,b){this.rawProperties[a]=b,this.build(!0)},c.prototype.toJSON=function(a){if(a&&(this.json=null),this.json)return b;var b={name:this.name,properties:{},settings:this.settings};this.build(a);var c=function(a){return void 0===a||null===a?a:"function"==typeof a.toJSON?a.toJSON():"function"==typeof a?d(a)?a.settings&&a.settings.anonymous?a.definition&&a.definition.toJSON().properties:a.modelName:a.name:a};for(var e in this.properties)b.properties[e]=h(this.properties[e]).map(c);return this.json=b,b}},{"./model":73,"./model-builder":71,"./types":77,assert:9,events:22,traverse:87,util:50}],73:[function(a,b){function c(a,b){b=b||{},"applySetters"in b||(b.applySetters=!0),this._initProperties(a,b)}b.exports=c;var d=a("util"),e=a("./jutil"),f=a("./list"),g=a("./hooks"),h=a("./validations.js"),i={String:!0,Boolean:!0,Number:!0,Date:!0,Text:!0,ObjectID:!0};c.prototype._initProperties=function(a,b){var c=this,d=this.constructor;a instanceof d&&(a=a.toObject(!1));var e=d.definition.properties;a=a||{},b=b||{};var g=b.applySetters,h=b.strict;void 0===h&&(h=d.definition.settings.strict),d.hideInternalProperties?Object.defineProperties(this,{__cachedRelations:{writable:!0,enumerable:!1,configurable:!0,value:{}},__data:{writable:!0,enumerable:!1,configurable:!0,value:{}},__dataSource:{writable:!0,enumerable:!1,configurable:!0,value:b.dataSource},__strict:{writable:!0,enumerable:!1,configurable:!0,value:h}}):(this.__cachedRelations={},this.__data={},this.__dataSource=b.dataSource,this.__strict=h),a.__cachedRelations&&(this.__cachedRelations=a.__cachedRelations);for(var j,k,l=Object.keys(a),m=l.length,n=0;m>n;n++)if(j=l[n],k=a[j],"function"!=typeof k)if(e[j])g?c[j]=k:c.__data[j]=k;else if(d.relations[j])"belongsTo"===d.relations[j].type&&null!=k&&(c.__data[d.relations[j].keyFrom]=k[d.relations[j].keyTo]),c.__cachedRelations[j]=k;else if(h===!1)c[j]=c.__data[j]=k;else if("throw"===h)throw new Error("Unknown property: "+j);for(l=Object.keys(e),m=l.length,n=0;m>n;n++){if(j=l[n],k=c.__data[j],void 0===k){var o=e[j]["default"];void 0!==o&&("function"==typeof o&&(o=o===Date?new Date:o()),c.__data[j]=o)}var p=e[j].type;if(!i[p.name]){if("object"!=typeof c.__data[j]&&c.__data[j])try{c.__data[j]=JSON.parse(c.__data[j]+"")}catch(q){c.__data[j]=String(c.__data[j])}("Array"===p.name||Array.isArray(p))&&(c.__data[j]instanceof f||void 0===c.__data[j]||null===c.__data[j]||(c.__data[j]=f(c.__data[j],p,c)))}}this.trigger("initialize")},c.defineProperty=function(a,b){this.dataSource.defineProperty(this.modelName,a,b)},c.getPropertyType=function(a){var b=this.definition.properties[a];if(!b)return null;if(!b.type)throw new Error("Type not defined for property "+this.modelName+"."+a);return b.type.name},c.prototype.getPropertyType=function(a){return this.constructor.getPropertyType(a)},c.toString=function(){return"[Model "+this.modelName+"]"},c.prototype.toObject=function(a,b){void 0===a&&(a=!0);var c={},d=this,e=this.constructor;if(e===Object)return d;for(var g,h,i=this.__strict,j=i===!1||!a,k=e.definition.properties,l=Object.keys(k),m=0;m<l.length;m++)g=l[m],h=d[g],"function"!=typeof h&&(b&&e.isHiddenProperty(g)||(c[g]=h instanceof f?h.toObject(!j,b):void 0!==h&&null!==h&&h.toObject?h.toObject(!j,b):h));if(j){l=Object.keys(d);var n=l.length;for(m=0;n>m;m++)if(g=l[m],!k[g]&&0!==g.indexOf("__")&&!(b&&e.isHiddenProperty(g)||(h=d[g],void 0===h||void 0!==c[g]))){if("function"==typeof h)continue;c[g]=null!==h&&h.toObject?h.toObject(!j,b):h}for(l=Object.keys(d.__data),n=l.length,m=0;n>m;m++)if(g=l[m],0!==g.indexOf("__")&&void 0===c[g]){if(b&&e.isHiddenProperty(g))continue;var o=d[g];if(h=void 0!==o&&"function"!=typeof o?o:d.__data[g],"function"==typeof h)continue;c[g]=void 0!==h&&null!==h&&h.toObject?h.toObject(!j,b):h}}return c},c.isHiddenProperty=function(a){var b=this,c=b.definition&&b.definition.settings,d=c&&(c.hiddenProperties||c.hidden);if(Array.isArray(d)){c.hiddenProperties={};for(var e=0;e<d.length;e++)c.hiddenProperties[d[e]]=!0;d=c.hiddenProperties}return d?d[a]:!1},c.prototype.toJSON=function(){return this.toObject(!1,!0)},c.prototype.fromObject=function(a){for(var b in a)this[b]=a[b]},c.prototype.reset=function(){var a=this;for(var b in a)"id"===b||a.constructor.dataSource.definitions[a.constructor.modelName].properties[b]||delete a[b]},c.prototype.inspect=function(){return d.inspect(this.__data,!1,4,!0)},c.mixin=function(a,b){return e.mixin(this,a,b)},c.prototype.getDataSource=function(){return this.__dataSource||this.constructor.dataSource},c.getDataSource=function(){return this.dataSource},c.prototype.setStrict=function(a){this.__strict=a},e.mixin(c,g),e.mixin(c,h.Validatable)},{"./hooks":66,"./jutil":69,"./list":70,"./validations.js":79,util:50}],74:[function(a,b,c){function d(a){if(!a)return a;var b=a.toLowerCase();for(var c in t)if(c.toLowerCase()===b)return c;return null}function e(a){return this instanceof e?(a=a||{},this.name=a.name,o(this.name,"Relation name is missing"),this.type=d(a.type),o(this.type,"Invalid relation type: "+a.type),this.modelFrom=a.modelFrom,o(this.modelFrom,"Source model is required"),this.keyFrom=a.keyFrom,this.modelTo=a.modelTo,o(this.modelTo,"Target model is required"),this.keyTo=a.keyTo,this.modelThrough=a.modelThrough,this.keyThrough=a.keyThrough,void(this.multiple="belongsTo"!==this.type&&"hasOne"!==this.type)):new e(a)}function f(a,b){return this instanceof f?(a instanceof e||(a=new e(a)),this.definition=a,void(this.modelInstance=b)):new f(a,b)}function g(a,b){return this instanceof g?(o(a.type===t.hasMany),void f.apply(this,arguments)):new g(a,b)}function h(a,b){return this instanceof h?(o(a.type===t.hasMany),o(a.modelThrough),void g.apply(this,arguments)):new h(a,b)}function i(a,b){return this instanceof i?(o(a.type===t.belongsTo),void f.apply(this,arguments)):new i(a,b)}function j(a,b){return this instanceof j?(o(a.type===t.hasAndBelongsToMany),void f.apply(this,arguments)):new j(a,b)}function k(a,b){return this instanceof k?(o(a.type===t.hasOne),void f.apply(this,arguments)):new k(a,b)}function l(a,b,c){for(var d=a.relations,e=Object.keys(d),f=0;f<e.length;f++){var g=d[e[f]];if(g.type===t.belongsTo&&g.modelTo===b&&(void 0===c||g.keyTo===c))return g.keyFrom}return null}function m(a,b){if(a[b])return a[b];var c=b.toLowerCase();for(var d in a)if(d.toLowerCase()===c)return a[d]}function n(a,b){var c=function(){var c=u[a.type];a.type===t.hasMany&&a.modelThrough&&(c=u.hasManyThrough);var d=new c(a,this);return d[b].apply(d,arguments)};return c}var o=a("assert"),p=a("util"),q=a("inflection"),r=a("./scope.js").defineScope,s=a("./model.js");c.Relation=f,c.RelationDefinition=e;var t={belongsTo:"belongsTo",hasMany:"hasMany",hasOne:"hasOne",hasAndBelongsToMany:"hasAndBelongsToMany"};c.RelationTypes=t,c.HasMany=g,c.HasManyThrough=h,c.HasOne=k,c.HasAndBelongsToMany=j,c.BelongsTo=i;var u={belongsTo:i,hasMany:g,hasManyThrough:h,hasOne:k,hasAndBelongsToMany:j};e.prototype.toJSON=function(){var a={name:this.name,type:this.type,modelFrom:this.modelFrom.modelName,keyFrom:this.keyFrom,modelTo:this.modelTo.modelName,keyTo:this.keyTo,multiple:this.multiple};return this.modelThrough&&(a.modelThrough=this.modelThrough.modelName,a.keyThrough=this.keyThrough),a},f.prototype.resetCache=function(a){a=a||void 0,this.modelInstance.__cachedRelations[this.definition.name]=a},f.prototype.getCache=function(){return this.modelInstance.__cachedRelations[this.definition.name]},p.inherits(g,f),g.prototype.removeFromCache=function(a){var b=this.modelInstance.__cachedRelations[this.definition.name],c=this.definition.modelTo.definition.idName();if(Array.isArray(b))for(var d=0,e=b.length;e>d;d++)if(b[d][c]===a)return b.splice(d,1);return null},g.prototype.addToCache=function(a){if(a){var b=this.modelInstance.__cachedRelations[this.definition.name];void 0===b&&(b=this.modelInstance.__cachedRelations[this.definition.name]=[]);var c=this.definition.modelTo.definition.idName();if(Array.isArray(b)){for(var d=0,e=b.length;e>d;d++)if(b[d][c]===a[c])return void(b[d]=a);b.push(a)}}},p.inherits(h,g),p.inherits(i,f),p.inherits(j,f),p.inherits(k,f),e.hasMany=function(a,b,c){var d=a.modelName;if(c=c||{},"string"==typeof b)if(c.as=b,c.model)b=c.model;else{var f=q.singularize(b).toLowerCase();b=m(a.dataSource.modelBuilder.models,f)}var g=c.as||q.camelize(b.pluralModelName,!0),h=c.foreignKey||q.camelize(d+"_id",!0),i=a.dataSource.idName(a.modelName)||"id",j=new e({name:g,type:t.hasMany,modelFrom:a,keyFrom:i,keyTo:h,modelTo:b,multiple:!0});if(c.through){j.modelThrough=c.through;var k=j.throughKey||q.camelize(b.modelName+"_id",!0);j.keyThrough=k}a.relations[g]=j,c.through||b.dataSource.defineForeignKey(b.modelName,h,this.modelName);var l={findById:n(j,"findById"),destroy:n(j,"destroyById")};j.modelThrough&&(l.create=n(j,"create"),l.add=n(j,"add"),l.remove=n(j,"remove")),r(a.prototype,c.through||b,g,function(){var a={};return a.where={},a.where[h]=this[i],c.through&&(a.collect=q.camelize(b.modelName,!0),a.include=a.collect),a},l)},g.prototype.findById=function(a,b){var c=this.definition.modelTo,d=this.definition.keyTo,e=this.definition.keyFrom,f=this.modelInstance;c.findById(a,function(a,c){return a?b(a):c?void(c[d]&&c[d].toString()===f[e].toString()?b(null,c):b(new Error("Permission denied: foreign key does not match the primary key"))):b(new Error("Not found"))})},g.prototype.destroyById=function(a,b){var c=this,d=this.definition.modelTo,e=this.definition.keyTo,f=this.definition.keyFrom,g=this.modelInstance;d.findById(a,function(a,d){return a?b(a):d?void(d[e]&&d[e].toString()===g[f].toString()?(c.removeFromCache(d[e]),d.destroy(b)):b(new Error("Permission denied: foreign key does not match the primary key"))):b(new Error("Not found"))})},h.prototype.create=function(a,b){var c=this,d=this.definition,e=d.modelTo,f=d.modelThrough;"function"!=typeof a||b||(b=a,a={});var g=this.modelInstance;e.create(a,function(a,e){if(a)return b&&b(a,e);var h=d.modelTo.definition.idName(),i=l(f,d.modelFrom,d.keyFrom),j=l(f,d.modelTo,h),k={};k[i]=g[d.keyFrom],k[j]=e[h],f.create(k,function(d){d?e.destroy(function(){b&&b(d)}):(c.addToCache(e),b&&b(a,e))})})},h.prototype.add=function(a,b){var c=this,d=this.definition,e=d.modelThrough,f=d.keyFrom,g={},h={},i=l(e,d.modelFrom,d.keyFrom),j=d.modelTo.definition.idName(),k=l(e,d.modelTo,j);h[i]=this.modelInstance[f],h[k]=a[j]||a,g[i]=this.modelInstance[f],g[k]=a[j]||a,e.findOrCreate({where:h},g,function(e,f){e||a instanceof d.modelTo&&c.addToCache(a),b(e,f)})},h.prototype.remove=function(a,b){var c=this,d=this.definition,e=d.modelThrough,f=d.keyFrom,g={},h=l(e,d.modelFrom,d.keyFrom),i=d.modelTo.definition.idName(),j=l(e,d.modelTo,i);g[h]=this.modelInstance[f],g[j]=a[i]||a,e.deleteAll(g,function(a){a||c.removeFromCache(g[j]),b(a)})},e.belongsTo=function(a,b,c){if(c=c||{},"string"==typeof b)if(c.as=b,c.model)b=c.model;else{var d=b.toLowerCase();b=m(a.dataSource.modelBuilder.models,d)}var f=a.dataSource.idName(b.modelName)||"id",g=c.as||q.camelize(b.modelName,!0),h=c.foreignKey||g+"Id",j=a.relations[g]=new e({name:g,type:t.belongsTo,modelFrom:a,keyFrom:h,keyTo:f,modelTo:b});a.dataSource.defineForeignKey(a.modelName,h,b.modelName),Object.defineProperty(a.prototype,g,{enumerable:!0,configurable:!0,get:function(){var a=new i(j,this),b=a.related.bind(a);return b.create=a.create.bind(a),b.build=a.build.bind(a),b._targetClass=j.modelTo.modelName,b}});var k=function(){var a=this[g];a.apply(this,arguments)};a.prototype["__get__"+g]=k},i.prototype.create=function(a,b){var c=this,d=this.definition.modelTo,e=this.definition.keyTo,f=this.definition.keyFrom,g=this.modelInstance;d.create(a,function(a,d){a?b&&b(a):(g[e]=d[f],c.resetCache(d),b&&b(a,d))})},i.prototype.build=function(a){var b=this.definition.modelTo;return new b(a)},i.prototype.related=function(a,b){var c=this,d=this.definition.modelTo,e=this.definition.keyTo,f=this.definition.keyFrom,g=this.modelInstance;if(1===arguments.length)b=a,a=!1;else if(arguments.length>2)throw new Error("Method can't be called with more than two arguments");var h;if(a||(h=c.getCache()),b instanceof s)g[f]=b[e],c.resetCache(b);else{if("function"==typeof b){var i=b;return void 0===h?(d.findById(g[f],function(a,b){return a?i(a):b?void(b[e]===g[f]?(c.resetCache(b),i(null,b)):i(new Error("Permission denied: foreign key does not match the primary key"))):i(null,null)}),g[f]):(i(null,h),h)}if(void 0===b)return g[f];g[f]=b,c.resetCache()}},e.hasAndBelongsToMany=function(a,b,c){c=c||{};var d=a.dataSource.modelBuilder.models;if("string"==typeof b&&(c.as=b,b=c.model?c.model:m(d,q.singularize(b))||b,"string"==typeof b))throw new Error('Could not find "'+b+'" relation for '+a.modelName);if(!c.through){var e=a.modelName+b.modelName,f=b.modelName+a.modelName;c.through=m(d,e)||m(d,f)||a.dataSource.define(e)}c.through.belongsTo(a),c.through.belongsTo(b),this.hasMany(a,b,{as:c.as,through:c.through})},e.hasOne=function(a,b,c){if(c=c||{},"string"==typeof b)if(c.as=b,c.model)b=c.model;else{var d=b.toLowerCase();b=m(a.dataSource.modelBuilder.models,d)}var f=a.dataSource.idName(b.modelName)||"id",g=c.as||q.camelize(b.modelName,!0),h=c.foreignKey||q.camelize(a.modelName+"_id",!0),i=a.relations[g]=new e({name:g,type:t.hasOne,modelFrom:a,keyFrom:f,keyTo:h,modelTo:b});a.dataSource.defineForeignKey(b.modelName,h,a.modelName),Object.defineProperty(a.prototype,g,{enumerable:!0,configurable:!0,get:function(){var a=new k(i,this),b=a.related.bind(a);return b.create=a.create.bind(a),b.build=a.build.bind(a),b}})},k.prototype.create=function(a,b){{var c=this,d=this.definition.modelTo,e=this.definition.keyTo,f=this.definition.keyFrom,g=this.modelInstance;
this.definition.name}a=a||{},a[e]=g[f],d.create(a,function(a,d){a?b&&b(a):(c.resetCache(d),b&&b(a,d))})},k.prototype.build=function(a){var b=this.definition.modelTo,c=this.definition.keyFrom,d=this.definition.keyTo;return a=a||{},a[d]=this.modelInstance[c],new b(a)},k.prototype.related=function(a,b){{var c=this,d=this.definition.modelTo,e=this.definition.keyTo,f=this.definition.keyFrom,g=this.modelInstance;this.definition.name}if(1===arguments.length)b=a,a=!1;else if(arguments.length>2)throw new Error("Method can't be called with more than two arguments");var h;if(a||(h=c.getCache()),b instanceof s)b[e]=g[f],c.resetCache(b);else{if("function"==typeof b){var i=b;if(void 0===h){var j={where:{}};return j.where[e]=g[f],d.findOne(j,function(a,b){return a?i(a):b?void(b[e]===g[f]?(c.resetCache(b),i(null,b)):i(new Error("Permission denied"))):i(null,null)}),g[f]}return i(null,h),h}if(void 0===b)return g[f];b[e]=g[f],c.resetCache()}}},{"./model.js":73,"./scope.js":76,assert:9,inflection:82,util:50}],75:[function(a,b){function c(){}var d=a("./relation-definition"),e=d.RelationDefinition;b.exports=c,c.hasMany=function(a,b){e.hasMany(this,a,b)},c.belongsTo=function(a,b){e.belongsTo(this,a,b)},c.hasAndBelongsToMany=function(a,b){e.hasAndBelongsToMany(this,a,b)},c.hasOne=function(a,b){e.hasOne(this,a,b)}},{"./relation-definition":74}],76:[function(a,b,c){function d(a){this.sourceModel=a.sourceModel,this.targetModel=a.targetModel||a.sourceModel,this.name=a.name,this.params=a.params,this.methods=a.methods}function e(a,b,c,e,h){function i(a,c){for(var d in c)if("and"!==d){var e=b.definition.properties[d];if(e){var f=c[d];("object"!=typeof f||f instanceof e.type)&&(a[d]=c[d])}}else for(var g=0,h=c[d].length;h>g;g++)i(a,c[d][g])}function j(a){a=a||{};var c=this._scope&&this._scope.where||{};return i(a,c),new b(a)}function k(a,b){"function"==typeof a&&(b=a,a={}),this.build(a).save(b)}function l(a){b.destroyAll(this._scope,a)}a._scopeMeta||(a._scopeMeta={}),a===b?a._scopeMeta[c]=e:b._scopeMeta||(b._scopeMeta={});var m=new d({sourceModel:a,targetModel:b,name:c,params:e,methods:h});Object.defineProperty(a,c,{enumerable:!1,configurable:!0,get:function(){var a=this,c=function(b,d){1===arguments.length?m.related(a,c._scope,b):m.related(a,c._scope,b,d)};c._scope="function"==typeof m.params?m.params.call(a):m.params,c._targetClass=m.targetModel.modelName,c._scope.collect&&(c._targetClass=g.capitalize(c._scope.collect)),c.build=j,c.create=k,c.destroyAll=l;for(var d in m.methods)c[d]=m.methods[d].bind(a);return Object.keys(b._scopeMeta).forEach(function(a){Object.defineProperty(c,a,{enumerable:!1,get:function(){return f(c._scope,b._scopeMeta[a]),c}})}.bind(a)),c}});var n=function(){var a=this[c];a.apply(this[c],arguments)};a["__get__"+c]=n;var o=function(){var a=this[c].create;a.apply(this[c],arguments)};a["__create__"+c]=o;var p=function(){var a=this[c].destroyAll;a.apply(this[c],arguments)};a["__delete__"+c]=p}function f(a,b){return b?(a=a||{},b.where&&Object.keys(b.where).length>0&&(a.where=a.where&&Object.keys(a.where).length>0?{and:[a.where,b.where]}:b.where),b.include&&(a.include=b.include),b.collect&&(a.collect=b.collect),b.order&&(a.order=b.order),void 0!==b.limit&&(a.limit=b.limit),void 0!==b.skip&&(a.skip=b.skip),void 0!==b.offset&&(a.offset=b.offset),void 0!==b.fields&&(a.fields=b.fields),a):void 0}var g=a("inflection"),h=a("./utils"),i=h.defineCachedRelations;c.defineScope=e,d.prototype.related=function(a,b,c,d){var e=this.name,g=a,h={},j=!1,k=!0;if(3===arguments.length)d=c;else{if(4!==arguments.length)throw new Error("Method can be only called with one or two arguments");"boolean"==typeof c?j=c:(h=c,j=!0,k=!1)}if(!g.__cachedRelations||void 0===g.__cachedRelations[e]||j){var l=f(h,b);return this.targetModel.find(l,function(a,b){!a&&k&&(i(g),g.__cachedRelations[e]=b),d(a,b)})}d(null,g.__cachedRelations[e])}},{"./utils":78,inflection:82}],77:[function(a,b){(function(c){var d={};d.Text=function e(a){return this instanceof e?void(this.value=a):a},d.Text.prototype.toObject=d.Text.prototype.toJSON=function(){return this.value},d.JSON=function f(a){return this instanceof f?void(this.value=a):a},d.JSON.prototype.toObject=d.JSON.prototype.toJSON=function(){return this.value},d.Any=function g(a){return this instanceof g?void(this.value=a):a},d.Any.prototype.toObject=d.Any.prototype.toJSON=function(){return this.value},b.exports=function(b){var e=a("./geo").GeoPoint;for(var f in d)b[f]=d[f];b.schemaTypes={},b.registerType=function(a,b){b=b||[],b=b.concat([a.name]);for(var c=0;c<b.length;c++)this.schemaTypes[b[c].toLowerCase()]=a},b.registerType(d.Text),b.registerType(d.JSON),b.registerType(d.Any),b.registerType(String),b.registerType(Number),b.registerType(Boolean),b.registerType(Date),b.registerType(c,["Binary"]),b.registerType(Array),b.registerType(e),b.registerType(Object)},b.exports.Types=d}).call(this,a("buffer").Buffer)},{"./geo":65,buffer:13}],78:[function(a,b,c){(function(b){function d(c){try{return a(c)}catch(d){console.log('Run "npm install loopback-datasource-juggler '+c+'" command to use loopback-datasource-juggler using '+c+" database engine"),b.exit(1)}}function e(a,b){if(a){var c=b;if("string"==typeof a)return[a];if(Array.isArray(a)&&a.length>0)return a;if("object"==typeof a){var d=[],e=[],f=Object.keys(a);if(!f.length)return;f.forEach(function(b){a[b]?d.push(b):b in a&&!a[b]&&e.push(b)}),d.length>0?c=d:e.length>0&&e.forEach(function(a){var b=c.indexOf(a);c.splice(b,1)})}return c}}function f(a){return function(b){for(var c,d={},e=0;e<a.length;e++)c=a[e],d[c]=b[c];return d}}function g(a){return"object"!=typeof a||null===a?a:l(a).forEach(function(a){return void 0===a&&this.remove(),Array.isArray(a)||"object"!=typeof a||null===a||a.constructor===Object?a:(this.update(a,!0),a)})}function h(a){if(!a)return{};var b=m.parse(a,!1),c={};if(c.connector=b.protocol&&b.protocol.split(":")[0],c.host=c.hostname=b.hostname,c.port=b.port&&Number(b.port),c.user=c.username=b.auth&&b.auth.split(":")[0],c.password=b.auth&&b.auth.split(":")[1],c.database=b.pathname&&b.pathname.split("/")[1],c.url=a,b.query){var d=n.parse(b.query);for(var e in d)c[e]=d[e]}return c}function i(a,b){var c=Array.isArray(b),d=c&&[]||{};return c?(a=a||[],d=d.concat(a),b.forEach(function(a){-1===d.indexOf(a)&&d.push(a)})):(a&&"object"==typeof a&&Object.keys(a).forEach(function(b){d[b]=a[b]}),Object.keys(b).forEach(function(c){d[c]="object"==typeof b[c]&&b[c]&&a[c]?i(a[c],b[c]):b[c]})),d}function j(a){a.__cachedRelations||Object.defineProperty(a,"__cachedRelations",{writable:!0,enumerable:!1,configurable:!0,value:{}})}function k(a){return"object"==typeof a&&null!==a&&a.constructor===Object}c.safeRequire=d,c.fieldsToArray=e,c.selectFields=f,c.removeUndefined=g,c.parseSettings=h,c.mergeSettings=i,c.isPlainObject=k,c.defineCachedRelations=j;var l=a("traverse"),m=a("url"),n=a("qs")}).call(this,a("+xKvab"))},{"+xKvab":29,qs:86,traverse:87,url:48}],79:[function(a,b,c){(function(b){function d(){}function e(a,b,c){r(this[a])&&c()}function f(a,b,c){if(!q.call(this,a,b,c)){var d=this[a].length;b.min&&d<b.min&&c("min"),b.max&&d>b.max&&c("max"),b.is&&d!==b.is&&c("is")}}function g(a,b,c){return q.call(this,a,b,c)?void 0:"number"!=typeof this[a]?c("number"):b.int&&this[a]!==Math.round(this[a])?c("int"):void 0}function h(a,b,c){q.call(this,a,b,c)||~b.in.indexOf(this[a])||c()}function i(a,b,c){q.call(this,a,b,c)||~b.in.indexOf(this[a])&&c()}function j(a,b,c){q.call(this,a,b,c)||("string"==typeof this[a]?this[a].match(b["with"])||c():c())}function k(a,b,c,d){b.customValidator.call(this,c,d)}function l(a,b,c,d){var e={where:{}};e.where[a]=this[a],b&&b.scopedTo&&b.scopedTo.forEach(function(a){var b=this[a];void 0!==b&&(e.where[a]=this[a])},this),this.constructor.find(e,function(a,b){return a?c():(b.length>1?c():1!==b.length||this.id&&b[0].id&&b[0].id.toString()==this.id.toString()||c(),void d())}.bind(this))}function m(a,b){return function(){s(this,a,arguments,b)}}function n(a){Object.defineProperty(a,"errors",{enumerable:!1,configurable:!0,value:!1})}function o(a,b,c){{var d=b[0],e=b[1];b[2]||{}}if("string"!=typeof d)return!1;if(p(a,e,"if"))return!1;if(p(a,e,"unless"))return!1;var f=!1,g=x[e.validation],h=[];return h.push(d),h.push(e),h.push(function(b){var c,g=e.validation;e.message&&(c=e.message),!c&&y[e.validation]&&(c=y[e.validation]),c||(c="is invalid"),b&&(g+="."+b,c=c[b]?c[b]:y.common[b]?y.common[b]:"is invalid"),a.errors.add(d,c,g),f=!0}),c&&h.push(function(){c(f)}),g.apply(a,h),f}function p(a,b,c){var d=!0;return"function"==typeof b[c]?(d=b[c].call(a),"unless"===c&&(d=!d)):"string"==typeof b[c]&&("function"==typeof a[b[c]]?(d=a[b[c]].call(a),"unless"===c&&(d=!d)):a.__data.hasOwnProperty(b[c])?(d=a[b[c]],"unless"===c&&(d=!d)):d="if"===c),!d}function q(a,b,c){var d=null===this[a]||!(a in this);return d?(b.allowNull||c("null"),!0):r(this[a])?(b.allowBlank||c("blank"),!0):!1}function r(a){return"undefined"==typeof a?!0:a instanceof Array&&0===a.length?!0:null===a?!0:"string"==typeof a&&""===a?!0:!1}function s(a,b,c,d){a._validations||Object.defineProperty(a,"_validations",{writable:!0,configurable:!0,enumerable:!1,value:[]}),c=[].slice.call(c);var e;e="object"==typeof c[c.length-1]?c.pop():{},"custom"===b&&"function"==typeof c[c.length-1]&&(e.customValidator=c.pop()),e.validation=b,c.forEach(function(b){a._validations.push([b,e,d])})}function t(){Object.defineProperty(this,"codes",{enumerable:!1,configurable:!0,value:{}})}function u(a){if(!(this instanceof u))return new u(a);this.name="ValidationError";var b=a&&a.constructor&&a.constructor.modelName;this.message=w.format("The %s instance is not valid. Details: %s.",b?"`"+b+"`":"model",v(a.errors)||"(unknown)"),this.statusCode=422,this.details={context:b,codes:a.errors&&a.errors.codes,messages:a.errors},Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):z&&(this.stack=(new Error).stack)}function v(a){var b="; ";return a=a||{},Object.getOwnPropertyNames(a).filter(function(b){return Array.isArray(a[b])}).map(function(c){var d=a[c];return d.map(function(a){return"`"+c+"` "+a}).join(b)}).join(b)}var w=a("util");c.ValidationError=u,c.Validatable=d,d.validatesPresenceOf=m("presence"),d.validatesLengthOf=m("length"),d.validatesNumericalityOf=m("numericality"),d.validatesInclusionOf=m("inclusion"),d.validatesExclusionOf=m("exclusion"),d.validatesFormatOf=m("format"),d.validate=m("custom"),d.validateAsync=m("custom",{async:!0}),d.validatesUniquenessOf=m("uniqueness",{async:!0});var x={presence:e,length:f,numericality:g,inclusion:h,exclusion:i,format:j,custom:k,uniqueness:l};d.prototype.isValid=function(a,c){var d=!0,e=this,f=0,g=!1;return this.constructor._validations?(Object.defineProperty(this,"errors",{enumerable:!1,configurable:!0,value:new t}),this.trigger("validate",function(c){function e(b){i=i||b,0===--f&&c.call(h,function(){d&&!i&&n(h),a&&a(d&&!i)})}var h=this,i=!1;this.constructor._validations.forEach(function(a){a[2]&&a[2].async?(g=!0,f+=1,b.nextTick(function(){o(h,a,e)})):o(h,a)&&(d=!1)}),g||c.call(h,function(){d&&n(h),a&&a(d)})},c),g?void 0:d):(n(this),a&&this.trigger("validate",function(b){b.call(e,function(){a(d)})}),d)};var y={presence:"can't be blank",length:{min:"too short",max:"too long",is:"length is wrong"},common:{blank:"is blank","null":"is null"},numericality:{"int":"is not an integer",number:"is not a number"},inclusion:"is not included in the list",exclusion:"is reserved",uniqueness:"is not unique"};t.prototype.add=function(a,b,c){c=c||"invalid",this[a]||(this[a]=[],this.codes[a]=[]),this[a].push(b),this.codes[a].push(c)},w.inherits(u,Error);var z=!!(new Error).stack}).call(this,a("+xKvab"))},{"+xKvab":29,util:50}],80:[function(a,b){(function(a){!function(){function c(a){var b=!1;return function(){if(b)throw new Error("Callback was already called.");b=!0,a.apply(d,arguments)}}var d,e,f={};d=this,null!=d&&(e=d.async),f.noConflict=function(){return d.async=e,f};var g=Object.prototype.toString,h=Array.isArray||function(a){return"[object Array]"===g.call(a)},i=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},j=function(a,b){if(a.map)return a.map(b);var c=[];return i(a,function(a,d,e){c.push(b(a,d,e))}),c},k=function(a,b,c){return a.reduce?a.reduce(b,c):(i(a,function(a,d,e){c=b(c,a,d,e)}),c)},l=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"!=typeof a&&a.nextTick?(f.nextTick=a.nextTick,f.setImmediate="undefined"!=typeof setImmediate?function(a){setImmediate(a)}:f.nextTick):"function"==typeof setImmediate?(f.nextTick=function(a){setImmediate(a)},f.setImmediate=f.nextTick):(f.nextTick=function(a){setTimeout(a,0)},f.setImmediate=f.nextTick),f.each=function(a,b,d){function e(b){b?(d(b),d=function(){}):(f+=1,f>=a.length&&d())}if(d=d||function(){},!a.length)return d();var f=0;i(a,function(a){b(a,c(e))})},f.forEach=f.each,f.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})};e()},f.forEachSeries=f.eachSeries,f.eachLimit=function(a,b,c,d){var e=m(b);e.apply(null,[a,c,d])},f.forEachLimit=f.eachLimit;var m=function(a){return function(b,c,d){if(d=d||function(){},!b.length||0>=a)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;a>g&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},n=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[f.each].concat(b))}},o=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[m(a)].concat(c))}},p=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[f.eachSeries].concat(b))}},q=function(a,b,c,d){if(b=j(b,function(a,b){return{index:b,value:a}}),d){var e=[];a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})}else a(b,function(a,b){c(a.value,function(a){b(a)})})};f.map=n(q),f.mapSeries=p(q),f.mapLimit=function(a,b,c,d){return r(b)(a,c,d)};var r=function(a){return o(a,q)};f.reduce=function(a,b,c,d){f.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){d(a,b)})},f.inject=f.reduce,f.foldl=f.reduce,f.reduceRight=function(a,b,c,d){var e=j(a,function(a){return a}).reverse();f.reduce(e,b,c,d)},f.foldr=f.reduceRight;var s=function(a,b,c,d){var e=[];b=j(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(){d(j(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};f.filter=n(s),f.filterSeries=p(s),f.select=f.filter,f.selectSeries=f.filterSeries;var t=function(a,b,c,d){var e=[];b=j(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(){d(j(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};f.reject=n(t),f.rejectSeries=p(t);var u=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(){d()})};f.detect=n(u),f.detectSeries=p(u),f.some=function(a,b,c){f.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(){c(!1)})},f.any=f.some,f.every=function(a,b,c){f.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(){c(!0)})},f.all=f.every,f.sortBy=function(a,b,c){f.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0};c(null,j(b.sort(d),function(a){return a.value}))})},f.auto=function(a,b){b=b||function(){};var c=l(a),d=c.length;if(!d)return b();var e={},g=[],j=function(a){g.unshift(a)},m=function(a){for(var b=0;b<g.length;b+=1)if(g[b]===a)return void g.splice(b,1)},n=function(){d--,i(g.slice(0),function(a){a()})};j(function(){if(!d){var a=b;b=function(){},a(null,e)}}),i(c,function(c){var d=h(a[c])?a[c]:[a[c]],g=function(a){var d=Array.prototype.slice.call(arguments,1);if(d.length<=1&&(d=d[0]),a){var g={};i(l(e),function(a){g[a]=e[a]}),g[c]=d,b(a,g),b=function(){}}else e[c]=d,f.setImmediate(n)},o=d.slice(0,Math.abs(d.length-1))||[],p=function(){return k(o,function(a,b){return a&&e.hasOwnProperty(b)},!0)&&!e.hasOwnProperty(c)};if(p())d[d.length-1](g,e);else{var q=function(){p()&&(m(q),d[d.length-1](g,e))};j(q)}})},f.retry=function(a,b,c){var d=5,e=[];"function"==typeof a&&(c=b,b=a,a=d),a=parseInt(a,10)||d;var g=function(d,g){for(var h=function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},g)}};a;)e.push(h(b,!(a-=1)));f.series(e,function(a,b){b=b[b.length-1],(d||c)(b.err,b.result)})};return c?g():g},f.waterfall=function(a,b){if(b=b||function(){},!h(a)){var c=new Error("First argument to waterfall must be an array of functions");return b(c)}if(!a.length)return b();var d=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var e=Array.prototype.slice.call(arguments,1),g=a.next();e.push(g?d(g):b),f.setImmediate(function(){a.apply(null,e)})}}};d(f.iterator(a))()};var v=function(a,b,c){if(c=c||function(){},h(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(l(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};f.parallel=function(a,b){v({map:f.map,each:f.each},a,b)},f.parallelLimit=function(a,b,c){v({map:r(b),each:m(b)},a,c)},f.series=function(a,b){if(b=b||function(){},h(a))f.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};f.eachSeries(l(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},f.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},f.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var w=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};f.concat=n(w),f.concatSeries=p(w),f.whilst=function(a,b,c){a()?b(function(d){return d?c(d):void f.whilst(a,b,c)}):c()},f.doWhilst=function(a,b,c){a(function(d){if(d)return c(d);var e=Array.prototype.slice.call(arguments,1);b.apply(null,e)?f.doWhilst(a,b,c):c()})},f.until=function(a,b,c){a()?c():b(function(d){return d?c(d):void f.until(a,b,c)})},f.doUntil=function(a,b,c){a(function(d){if(d)return c(d);var e=Array.prototype.slice.call(arguments,1);b.apply(null,e)?c():f.doUntil(a,b,c)})},f.queue=function(a,b){function d(a,b,c,d){return a.started||(a.started=!0),h(b)||(b=[b]),0==b.length?f.setImmediate(function(){a.drain&&a.drain()}):void i(b,function(b){var e={data:b,callback:"function"==typeof d?d:null};c?a.tasks.unshift(e):a.tasks.push(e),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),f.setImmediate(a.process)})}void 0===b&&(b=1);var e=0,g={tasks:[],concurrency:b,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(a,b){d(g,a,!1,b)},kill:function(){g.drain=null,g.tasks=[]},unshift:function(a,b){d(g,a,!0,b)},process:function(){if(!g.paused&&e<g.concurrency&&g.tasks.length){var b=g.tasks.shift();g.empty&&0===g.tasks.length&&g.empty(),e+=1;var d=function(){e-=1,b.callback&&b.callback.apply(b,arguments),g.drain&&g.tasks.length+e===0&&g.drain(),g.process()},f=c(d);a(b.data,f)}},length:function(){return g.tasks.length},running:function(){return e},idle:function(){return g.tasks.length+e===0},pause:function(){g.paused!==!0&&(g.paused=!0,g.process())},resume:function(){g.paused!==!1&&(g.paused=!1,g.process())}};return g},f.priorityQueue=function(a,b){function c(a,b){return a.priority-b.priority}function d(a,b,c){for(var d=-1,e=a.length-1;e>d;){var f=d+(e-d+1>>>1);c(b,a[f])>=0?d=f:e=f-1}return d}function e(a,b,e,g){return a.started||(a.started=!0),h(b)||(b=[b]),0==b.length?f.setImmediate(function(){a.drain&&a.drain()}):void i(b,function(b){var h={data:b,priority:e,callback:"function"==typeof g?g:null};a.tasks.splice(d(a.tasks,h,c)+1,0,h),a.saturated&&a.tasks.length===a.concurrency&&a.saturated(),f.setImmediate(a.process)})}var g=f.queue(a,b);return g.push=function(a,b,c){e(g,a,b,c)},delete g.unshift,g},f.cargo=function(a,b){var c=!1,d=[],e={tasks:d,payload:b,saturated:null,empty:null,drain:null,drained:!0,push:function(a,c){h(a)||(a=[a]),i(a,function(a){d.push({data:a,callback:"function"==typeof c?c:null}),e.drained=!1,e.saturated&&d.length===b&&e.saturated()}),f.setImmediate(e.process)},process:function g(){if(!c){if(0===d.length)return e.drain&&!e.drained&&e.drain(),void(e.drained=!0);var f="number"==typeof b?d.splice(0,b):d.splice(0,d.length),h=j(f,function(a){return a.data});e.empty&&e.empty(),c=!0,a(h,function(){c=!1;var a=arguments;i(f,function(b){b.callback&&b.callback.apply(null,a)}),g()})}},length:function(){return d.length},running:function(){return c}};return e};var x=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&i(c,function(b){console[a](b)}))}]))}};f.log=x("log"),f.dir=x("dir"),f.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),g=e.pop(),h=b.apply(null,e);h in c?f.nextTick(function(){g.apply(null,c[h])}):h in d?d[h].push(g):(d[h]=[g],a.apply(null,e.concat([function(){c[h]=arguments;var a=d[h];delete d[h];for(var b=0,e=a.length;e>b;b++)a[b].apply(null,arguments)}])))};return e.memo=c,e.unmemoized=a,e},f.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},f.times=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return f.map(d,b,c)},f.timesSeries=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return f.mapSeries(d,b,c)},f.seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),d=c.pop();f.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){d.apply(b,[a].concat(c))})}},f.compose=function(){return f.seq.apply(null,Array.prototype.reverse.call(arguments))};var y=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};f.applyEach=n(y),f.applyEachSeries=p(y),f.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d}a(c)}c()},"undefined"!=typeof b&&b.exports?b.exports=f:"undefined"!=typeof define&&define.amd?define([],function(){return f}):d.async=f}()}).call(this,a("+xKvab"))},{"+xKvab":29}],81:[function(a,b){b.exports=a(56)},{}],82:[function(a,b,c){!function(a,d){"function"==typeof define&&define.amd?define([],d):"object"==typeof c?b.exports=d():a.inflection=d()}(this,function(){var a=["equipment","information","rice","money","species","series","fish","sheep","moose","deer","news"],b=[[new RegExp("(m)en$","gi")],[new RegExp("(pe)ople$","gi")],[new RegExp("(child)ren$","gi")],[new RegExp("([ti])a$","gi")],[new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi")],[new RegExp("(hive)s$","gi")],[new RegExp("(tive)s$","gi")],[new RegExp("(curve)s$","gi")],[new RegExp("([lr])ves$","gi")],[new RegExp("([^fo])ves$","gi")],[new RegExp("([^aeiouy]|qu)ies$","gi")],[new RegExp("(s)eries$","gi")],[new RegExp("(m)ovies$","gi")],[new RegExp("(x|ch|ss|sh)es$","gi")],[new RegExp("([m|l])ice$","gi")],[new RegExp("(bus)es$","gi")],[new RegExp("(o)es$","gi")],[new RegExp("(shoe)s$","gi")],[new RegExp("(cris|ax|test)es$","gi")],[new RegExp("(octop|vir)i$","gi")],[new RegExp("(alias|status)es$","gi")],[new RegExp("^(ox)en","gi")],[new RegExp("(vert|ind)ices$","gi")],[new RegExp("(matr)ices$","gi")],[new RegExp("(quiz)zes$","gi")],[new RegExp("(m)an$","gi"),"$1en"],[new RegExp("(pe)rson$","gi"),"$1ople"],[new RegExp("(child)$","gi"),"$1ren"],[new RegExp("^(ox)$","gi"),"$1en"],[new RegExp("(ax|test)is$","gi"),"$1es"],[new RegExp("(octop|vir)us$","gi"),"$1i"],[new RegExp("(alias|status)$","gi"),"$1es"],[new RegExp("(bu)s$","gi"),"$1ses"],[new RegExp("(buffal|tomat|potat)o$","gi"),"$1oes"],[new RegExp("([ti])um$","gi"),"$1a"],[new RegExp("sis$","gi"),"ses"],[new RegExp("(?:([^f])fe|([lr])f)$","gi"),"$1$2ves"],[new RegExp("(hive)$","gi"),"$1s"],[new RegExp("([^aeiouy]|qu)y$","gi"),"$1ies"],[new RegExp("(x|ch|ss|sh)$","gi"),"$1es"],[new RegExp("(matr|vert|ind)ix|ex$","gi"),"$1ices"],[new RegExp("([m|l])ouse$","gi"),"$1ice"],[new RegExp("(quiz)$","gi"),"$1zes"],[new RegExp("s$","gi"),"s"],[new RegExp("$","gi"),"s"]],c=[[new RegExp("(m)an$","gi")],[new RegExp("(pe)rson$","gi")],[new RegExp("(child)$","gi")],[new RegExp("^(ox)$","gi")],[new RegExp("(ax|test)is$","gi")],[new RegExp("(octop|vir)us$","gi")],[new RegExp("(alias|status)$","gi")],[new RegExp("(bu)s$","gi")],[new RegExp("(buffal|tomat|potat)o$","gi")],[new RegExp("([ti])um$","gi")],[new RegExp("sis$","gi")],[new RegExp("(?:([^f])fe|([lr])f)$","gi")],[new RegExp("(hive)$","gi")],[new RegExp("([^aeiouy]|qu)y$","gi")],[new RegExp("(x|ch|ss|sh)$","gi")],[new RegExp("(matr|vert|ind)ix|ex$","gi")],[new RegExp("([m|l])ouse$","gi")],[new RegExp("(quiz)$","gi")],[new RegExp("(m)en$","gi"),"$1an"],[new RegExp("(pe)ople$","gi"),"$1rson"],[new RegExp("(child)ren$","gi"),"$1"],[new RegExp("([ti])a$","gi"),"$1um"],[new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi"),"$1$2sis"],[new RegExp("(hive)s$","gi"),"$1"],[new RegExp("(tive)s$","gi"),"$1"],[new RegExp("(curve)s$","gi"),"$1"],[new RegExp("([lr])ves$","gi"),"$1f"],[new RegExp("([^fo])ves$","gi"),"$1fe"],[new RegExp("(m)ovies$","gi"),"$1ovie"],[new RegExp("([^aeiouy]|qu)ies$","gi"),"$1y"],[new RegExp("(s)eries$","gi"),"$1eries"],[new RegExp("(x|ch|ss|sh)es$","gi"),"$1"],[new RegExp("([m|l])ice$","gi"),"$1ouse"],[new RegExp("(bus)es$","gi"),"$1"],[new RegExp("(o)es$","gi"),"$1"],[new RegExp("(shoe)s$","gi"),"$1"],[new RegExp("(cris|ax|test)es$","gi"),"$1is"],[new RegExp("(octop|vir)i$","gi"),"$1us"],[new RegExp("(alias|status)es$","gi"),"$1"],[new RegExp("^(ox)en","gi"),"$1"],[new RegExp("(vert|ind)ices$","gi"),"$1ex"],[new RegExp("(matr)ices$","gi"),"$1ix"],[new RegExp("(quiz)zes$","gi"),"$1"],[new RegExp("ss$","gi"),"ss"],[new RegExp("s$","gi"),""]],d=["and","or","nor","a","an","the","so","but","to","of","at","by","from","into","on","onto","off","out","in","over","with","for"],e=new RegExp("(_ids|_id)$","g"),f=new RegExp("_","g"),g=new RegExp("[ _]","g"),h=new RegExp("([A-Z])","g"),i=new RegExp("^_"),j={_apply_rules:function(a,b,c,d){if(d)a=d;else{var e=j.indexOf(c,a.toLowerCase())>-1;if(!e)for(var f=0,g=b.length;g>f;f++)if(a.match(b[f][0])){void 0!==b[f][1]&&(a=a.replace(b[f][0],b[f][1]));break}}return a},indexOf:function(a,b,c,d){c||(c=-1);for(var e=-1,f=c,g=a.length;g>f;f++)if(a[f]===b||d&&d(a[f],b)){e=f;break}return e},pluralize:function(c,d){return j._apply_rules(c,b,a,d)},singularize:function(b,d){return j._apply_rules(b,c,a,d)},camelize:function(a,b){for(var c,d,e,f,g=a.split("/"),h=0,i=g.length;i>h;h++){for(c=g[h].split("_"),d=0,e=c.length;e>d;d++)0!==d&&(c[d]=c[d].toLowerCase()),f=c[d].charAt(0),f=b&&0===h&&0===d?f.toLowerCase():f.toUpperCase(),c[d]=f+c[d].substring(1);g[h]=c.join("")}return g.join("::")},underscore:function(a,b){if(b&&a===a.toUpperCase())return a;for(var c=a.split("::"),d=0,e=c.length;e>d;d++)c[d]=c[d].replace(h,"_$1"),c[d]=c[d].replace(i,"");return c.join("/").toLowerCase()},humanize:function(a,b){return a=a.toLowerCase(),a=a.replace(e,""),a=a.replace(f," "),b||(a=j.capitalize(a)),a},capitalize:function(a){return a=a.toLowerCase(),a.substring(0,1).toUpperCase()+a.substring(1)},dasherize:function(a){return a.replace(g,"-")},titleize:function(a){a=a.toLowerCase().replace(f," ");for(var b,c,e,g=a.split(" "),h=0,i=g.length;i>h;h++){for(b=g[h].split("-"),c=0,e=b.length;e>c;c++)j.indexOf(d,b[c].toLowerCase())<0&&(b[c]=j.capitalize(b[c]));g[h]=b.join("-")}return a=g.join(" "),a=a.substring(0,1).toUpperCase()+a.substring(1)},demodulize:function(a){var b=a.split("::");return b[b.length-1]},tableize:function(a){return a=j.underscore(a),a=j.pluralize(a)},classify:function(a){return a=j.camelize(a),a=j.singularize(a)},foreign_key:function(a,b){return a=j.demodulize(a),a=j.underscore(a)+(b?"":"_")+"id"},ordinalize:function(a){for(var b=a.split(" "),c=0,d=b.length;d>c;c++){var e=parseInt(b[c],10);if(!isNaN(e)){var f=b[c].substring(b[c].length-2),g=b[c].substring(b[c].length-1),h="th";"11"!=f&&"12"!=f&&"13"!=f&&("1"===g?h="st":"2"===g?h="nd":"3"===g&&(h="rd")),b[c]+=h}}return b.join(" ")},transform:function(a,b){for(var c=0,d=b.length;d>c;c++){var e=b[c];this.hasOwnProperty(e)&&(a=this[e](a))}return a}};return j.version="1.3.7",j})},{}],83:[function(a,b,c){c.Connector=a("./lib/connector"),c.SqlConnector=a("./lib/sql")},{"./lib/connector":84,"./lib/sql":85}],84:[function(a,b){(function(a){function c(a,b){this._models={},this.name=a,this.settings=b||{}}b.exports=c,c.prototype.relational=!1,c.prototype.getTypes=function(){return["db","nosql"]},c.prototype.getDefaultIdType=function(){return String},c.prototype.getMedadata=function(){return this._metadata||(this._metadata={types:this.getTypes(),defaultIdType:this.getDefaultIdType(),isRelational:this.isRelational||-1!==this.getTypes().indexOf("rdbms"),schemaForSettings:{}}),this._metadata},c.prototype.execute=function(){throw new Error("query method should be declared in connector")},c.prototype.getDataSource=function(a){var b=this._models[a];return b||console.trace("Model not found: "+a),b&&b.model.dataSource},c.prototype.idName=function(a){return this.getDataSource(a).idName(a)},c.prototype.idNames=function(a){return this.getDataSource(a).idNames(a)},c.prototype.id=function(a,b){var c=this._models[a].properties[b];return c||console.trace("Property not found: "+a+"."+b),c.id},c.prototype.define=function(a){a.settings||(a.settings={}),this._models[a.model.modelName]=a},c.prototype.defineProperty=function(a,b,c){this._models[a].properties[b]=c},c.prototype.disconnect=function(b){b&&a.nextTick(b)},c.prototype.getIdValue=function(a,b){return b&&b[this.idName(a)]},c.prototype.setIdValue=function(a,b,c){b&&(b[this.idName(a)]=c)},c.prototype.getType=function(){return this.type}}).call(this,a("+xKvab"))},{"+xKvab":29}],85:[function(a,b){(function(c){function d(){j.apply(this,[].slice.call(arguments))}function e(a,b,d){try{return i(null!==a&&void 0!==a,"id value is required"),!0}catch(e){return c.nextTick(function(){b&&b(d?null:e)}),!1}}function f(a,b,c){if("function"==typeof a.buildWhere)return a.buildWhere(b,c);var d=a._models[b].properties,e=[];return Object.keys(c||{}).forEach(function(f){var g=a.columnEscaped(b,f);e.push(null===c[f]?g+" IS NULL":g+" = "+a.toDatabase(d[f],c[f]))}),e.length?" WHERE "+e.join(" AND "):""}var g=a("util"),h=a("async"),i=a("assert"),j=a("./connector");b.exports=d,g.inherits(d,j),d.prototype.relational=!0,d.prototype.getTypes=function(){return["db","rdbms","sql"]},d.prototype.getDefaultIdType=function(){return Number},d.prototype.query=function(){throw new Error("query method should be declared in connector")},d.prototype.command=function(a,b,c){return this.query(a,b,c)},d.prototype.queryOne=function(a,b){return this.query(a,function(a,c){return a?b(a):void b(a,c&&c[0])})},d.prototype.table=function(a){var b=this.getDataSource(a).tableName(a),c=this.dbName;return"function"==typeof c&&(b=c(b)),b},d.prototype.column=function(a,b){var c=this.getDataSource(a).columnName(a,b),d=this.dbName;return"function"==typeof d&&(c=d(c)),c
},d.prototype.columnMetadata=function(a,b){return this.getDataSource(a).columnMetadata(a,b)},d.prototype.propertyName=function(a,b){var c=this._models[a].properties;for(var d in c)if(this.column(a,d)===b)return d;return null},d.prototype.idColumn=function(a){var b=this.getDataSource(a).idColumnName(a),c=this.dbName;return"function"==typeof c&&(b=c(b)),b},d.prototype.idColumnEscaped=function(a){return this.escapeName(this.getDataSource(a).idColumnName(a))},d.prototype.escapeName=function(){throw new Error("escapeName method should be declared in connector")},d.prototype.tableEscaped=function(a){return this.escapeName(this.table(a))},d.prototype.columnEscaped=function(a,b){return this.escapeName(this.column(a,b))},d.prototype.save=function(a,b,c){var d=this.getDataSource(a).idName(a),f=b[d];if(e(f,c)){f=this._escapeIdValue(a,f);var g="UPDATE "+this.tableEscaped(a)+" SET "+this.toFields(a,b)+" WHERE "+this.idColumnEscaped(a)+" = "+f;this.query(g,function(a,b){c&&c(a,b)})}},d.prototype.exists=function(a,b,c){if(e(b,c,!0)){var d="SELECT 1 FROM "+this.tableEscaped(a)+" WHERE "+this.idColumnEscaped(a)+" = "+this._escapeIdValue(a,b)+" LIMIT 1";this.query(d,function(a,b){c&&(a?c(a):c(null,b.length>=1))})}},d.prototype.find=function(a,b,c){if(e(b,c,!0)){var d=this,f=this.idColumnEscaped(a)+" = "+this._escapeIdValue(a,b),g="SELECT * FROM "+this.tableEscaped(a)+" WHERE "+f+" LIMIT 1";this.query(g,function(b,e){var f=e&&e.length>=1?e[0]:null;c&&c(b,d.fromDatabase(a,f))})}},d.prototype.delete=d.prototype.destroy=function(a,b,c){if(e(b,c,!0)){var d="DELETE FROM "+this.tableEscaped(a)+" WHERE "+this.idColumnEscaped(a)+" = "+this._escapeIdValue(a,b);this.command(d,function(a,b){c&&c(a,b)})}},d.prototype._escapeIdValue=function(a,b){var c=this.getDataSource(a).idProperty(a);return"function"==typeof this.toDatabase?this.toDatabase(c,b):c.type===Number?b:"'"+b+"'"},d.prototype.deleteAll=d.prototype.destroyAll=function(a,b,c){this.command("DELETE FROM "+this.tableEscaped(a)+f(this,a,b),function(a,b){c&&c(a,b)})},d.prototype.count=function(a,b,c){var d=this,e=f(d,a,c);this.queryOne("SELECT count(*) as cnt FROM "+this.tableEscaped(a)+" "+e,function(a,c){return a?b(a):void b(a,c&&c.cnt)})},d.prototype.updateAttributes=function(a,b,c,d){if(e(b,d)){var f=this.getDataSource(a).idName(a);c[f]=b,this.save(a,c,d)}},d.prototype.disconnect=function(){},d.prototype.automigrate=function(a,b){var c=this;b||"function"!=typeof a||(b=a,a=void 0),"string"==typeof a&&(a=[a]),a=a||Object.keys(c._models),h.each(a,function(a,b){a in c._models&&c.dropTable(a,function(d){d&&console.error(d),c.createTable(a,function(a,c){a&&console.error(a),b(a,c)})})},b)},d.prototype.dropTable=function(a,b){this.command("DROP TABLE IF EXISTS "+this.tableEscaped(a),b)},d.prototype.createTable=function(a,b){this.command("CREATE TABLE "+this.tableEscaped(a)+" (\n  "+this.propertiesSQL(a)+"\n)",b)},d.prototype.update=d.prototype.updateAll=function(a,b,c,d){var e=f(this,a,b),g="UPDATE "+this.tableEscaped(a)+" SET "+this.toFields(a,c)+" "+e;this.query(g,function(a,b){d&&d(a,b)})}}).call(this,a("+xKvab"))},{"+xKvab":29,"./connector":84,assert:9,async:80,util:50}],86:[function(a,b,c){function d(a,b){if(0==a[b].length)return a[b]={};var c={};for(var d in a[b])q.call(a[b],d)&&(c[d]=a[b][d]);return a[b]=c,c}function e(a,b,c,f){var g=a.shift();if(!Object.getOwnPropertyDescriptor(Object.prototype,c))if(g){var h=b[c]=b[c]||[];"]"==g?s(h)?""!=f&&h.push(f):"object"==typeof h?h[t(h).length]=f:h=b[c]=[b[c],f]:~r(g,"]")?(g=g.substr(0,g.length-1),!w.test(g)&&s(h)&&(h=d(b,c)),e(a,h,g,f)):(!w.test(g)&&s(h)&&(h=d(b,c)),e(a,h,g,f))}else s(b[c])?b[c].push(f):b[c]="object"==typeof b[c]?f:"undefined"==typeof b[c]?f:[b[c],f]}function f(a,b,c){if(~r(b,"]")){{var d=b.split("[");d.length}e(d,a,"base",c)}else{if(!w.test(b)&&s(a.base)){var f={};for(var g in a.base)f[g]=a.base[g];a.base=f}m(a.base,b,c)}return a}function g(a){if("object"!=typeof a)return a;if(s(a)){var b=[];for(var c in a)q.call(a,c)&&b.push(a[c]);return b}for(var d in a)a[d]=g(a[d]);return a}function h(a){var b={base:{}};return u(t(a),function(c){f(b,c,a[c])}),g(b.base)}function i(a){var b=v(String(a).split("&"),function(a,b){var c=r(b,"="),d=n(b),e=b.substr(0,d||c),g=b.substr(d||c,b.length),g=g.substr(r(g,"=")+1,g.length);return""==e&&(e=b,g=""),""==e?a:f(a,o(e),o(g))},{base:{}}).base;return g(b)}function j(a,b){if(!b)throw new TypeError("stringify expects an object");return b+"="+encodeURIComponent(a)}function k(a,b){var c=[];if(!b)throw new TypeError("stringify expects an object");for(var d=0;d<a.length;d++)c.push(x(a[d],b+"["+d+"]"));return c.join("&")}function l(a,b){for(var c,d=[],e=t(a),f=0,g=e.length;g>f;++f)c=e[f],""!=c&&d.push(null==a[c]?encodeURIComponent(c)+"=":x(a[c],b?b+"["+encodeURIComponent(c)+"]":encodeURIComponent(c)));return d.join("&")}function m(a,b,c){var d=a[b];Object.getOwnPropertyDescriptor(Object.prototype,b)||(void 0===d?a[b]=c:s(d)?d.push(c):a[b]=[d,c])}function n(a){for(var b,c,d=a.length,e=0;d>e;++e)if(c=a[e],"]"==c&&(b=!1),"["==c&&(b=!0),"="==c&&!b)return e}function o(a){try{return decodeURIComponent(a.replace(/\+/g," "))}catch(b){return a}}var p=Object.prototype.toString,q=Object.prototype.hasOwnProperty,r="function"==typeof Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},s=Array.isArray||function(a){return"[object Array]"==p.call(a)},t=Object.keys||function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},u="function"==typeof Array.prototype.forEach?function(a,b){return a.forEach(b)}:function(a,b){for(var c=0;c<a.length;c++)b(a[c])},v=function(a,b,c){if("function"==typeof a.reduce)return a.reduce(b,c);for(var d=c,e=0;e<a.length;e++)d=b(d,a[e]);return d},w=/^[0-9]+$/;c.parse=function(a){return null==a||""==a?{}:"object"==typeof a?h(a):i(a)};var x=c.stringify=function(a,b){return s(a)?k(a,b):"[object Object]"==p.call(a)?l(a,b):"string"==typeof a?j(a,b):b+"="+encodeURIComponent(String(a))}},{}],87:[function(a,b){function c(a){this.value=a}function d(a,b,c){var d=[],f=[],g=!0;return function h(a){function i(){if("object"==typeof m.node&&null!==m.node){m.keys&&m.node_===m.node||(m.keys=n(m.node)),m.isLeaf=0==m.keys.length;for(var b=0;b<f.length;b++)if(f[b].node_===a){m.circular=f[b];break}}else m.isLeaf=!0,m.keys=null;m.notLeaf=!m.isLeaf,m.notRoot=!m.isRoot}var j=c?e(a):a,k={},l=!0,m={node:j,node_:a,path:[].concat(d),parent:f[f.length-1],parents:f,key:d.slice(-1)[0],isRoot:0===d.length,level:d.length,circular:null,update:function(a,b){m.isRoot||(m.parent.node[m.key]=a),m.node=a,b&&(l=!1)},"delete":function(a){delete m.parent.node[m.key],a&&(l=!1)},remove:function(a){o(m.parent.node)?m.parent.node.splice(m.key,1):delete m.parent.node[m.key],a&&(l=!1)},keys:null,before:function(a){k.before=a},after:function(a){k.after=a},pre:function(a){k.pre=a},post:function(a){k.post=a},stop:function(){g=!1},block:function(){l=!1}};if(!g)return m;i();var r=b.call(m,m.node);return void 0!==r&&m.update&&m.update(r),k.before&&k.before.call(m,m.node),l?("object"!=typeof m.node||null===m.node||m.circular||(f.push(m),i(),p(m.keys,function(a,b){d.push(a),k.pre&&k.pre.call(m,m.node[a],a);var e=h(m.node[a]);c&&q.call(m.node,a)&&(m.node[a]=e.node),e.isLast=b==m.keys.length-1,e.isFirst=0==b,k.post&&k.post.call(m,e),d.pop()}),f.pop()),k.after&&k.after.call(m,m.node),m):m}(a).node}function e(a){if("object"==typeof a&&null!==a){var b;if(o(a))b=[];else if(g(a))b=new Date(a.getTime?a.getTime():a);else if(h(a))b=new RegExp(a);else if(i(a))b={message:a.message};else if(j(a))b=new Boolean(a);else if(k(a))b=new Number(a);else if(l(a))b=new String(a);else if(Object.create&&Object.getPrototypeOf)b=Object.create(Object.getPrototypeOf(a));else if(a.constructor===Object)b={};else{var c=a.constructor&&a.constructor.prototype||a.__proto__||{},d=function(){};d.prototype=c,b=new d}return p(n(a),function(c){b[c]=a[c]}),b}return a}function f(a){return Object.prototype.toString.call(a)}function g(a){return"[object Date]"===f(a)}function h(a){return"[object RegExp]"===f(a)}function i(a){return"[object Error]"===f(a)}function j(a){return"[object Boolean]"===f(a)}function k(a){return"[object Number]"===f(a)}function l(a){return"[object String]"===f(a)}var m=b.exports=function(a){return new c(a)};c.prototype.get=function(a){for(var b=this.value,c=0;c<a.length;c++){var d=a[c];if(!b||!q.call(b,d)){b=void 0;break}b=b[d]}return b},c.prototype.has=function(a){for(var b=this.value,c=0;c<a.length;c++){var d=a[c];if(!b||!q.call(b,d))return!1;b=b[d]}return!0},c.prototype.set=function(a,b){for(var c=this.value,d=0;d<a.length-1;d++){var e=a[d];q.call(c,e)||(c[e]={}),c=c[e]}return c[a[d]]=b,b},c.prototype.map=function(a){return d(this.value,a,!0)},c.prototype.forEach=function(a){return this.value=d(this.value,a,!1),this.value},c.prototype.reduce=function(a,b){var c=1===arguments.length,d=c?this.value:b;return this.forEach(function(b){this.isRoot&&c||(d=a.call(this,d,b))}),d},c.prototype.paths=function(){var a=[];return this.forEach(function(){a.push(this.path)}),a},c.prototype.nodes=function(){var a=[];return this.forEach(function(){a.push(this.node)}),a},c.prototype.clone=function(){var a=[],b=[];return function c(d){for(var f=0;f<a.length;f++)if(a[f]===d)return b[f];if("object"==typeof d&&null!==d){var g=e(d);return a.push(d),b.push(g),p(n(d),function(a){g[a]=c(d[a])}),a.pop(),b.pop(),g}return d}(this.value)};var n=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},o=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},p=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c++)b(a[c],c,a)};p(n(c.prototype),function(a){m[a]=function(b){var d=[].slice.call(arguments,1),e=new c(b);return e[a].apply(e,d)}});var q=Object.hasOwnProperty||function(a,b){return b in a}},{}],88:[function(a,b){b.exports={name:"loopback-datasource-juggler",version:"2.0.0-beta2",description:"LoopBack DataSoure Juggler",keywords:["StrongLoop","LoopBack","DataSource","Connector","Database","Juggler","ORM"],repository:{type:"git",url:"https://github.com/strongloop/loopback-datasource-juggler"},main:"index.js",scripts:{test:"make test"},engines:["node >= 0.6"],devDependencies:{should:"~1.2.2",mocha:"~1.18.2"},dependencies:{async:"~0.9.0",inflection:"~1.3.5","loopback-connector":"1.x",traverse:"~0.6.6",qs:"~0.6.6",debug:"~0.8.1"},license:{name:"Dual MIT/StrongLoop",url:"https://github.com/strongloop/loopback-datasource-juggler/blob/master/LICENSE"},readme:"# LoopBack DataSource Juggler\n\nLoopBack DataSource Juggler is an ORM that provides a common set of interfaces\nfor interacting with databases, REST APIs, and other data sources. It was\ninitially forked from [JugglingDB](https://github.com/1602/jugglingdb).\n\n**For full documentation, see the official StrongLoop documentation**:\n * [Data sources and connectors](http://docs.strongloop.com/display/DOC/Data+sources+and+connectors)\n * [Data Source Juggler](http://docs.strongloop.com/display/DOC/Data+Source+Juggler).\n\n## Installation\n\n    npm install loopback-datasource-juggler\n\nAlso install the appropriated connector, for example for mongodb:\n\n    npm install loopback-connector-mongodb\n\nSee [StrongLoop Suite Documentation](http://docs.strongloop.com/) for up-to-date list of connectors supported.\n\n\n",readmeFilename:"README.md",bugs:{url:"https://github.com/strongloop/loopback-datasource-juggler/issues"},homepage:"https://github.com/strongloop/loopback-datasource-juggler",_id:"loopback-datasource-juggler@2.0.0-beta2",_shasum:"6d0fb1752032f5e35852cbd1da17ab6104bc2185",_from:"loopback-datasource-juggler@2.0.0-beta2",_resolved:"http://localhost:4873/loopback-datasource-juggler/-/loopback-datasource-juggler-2.0.0-beta2.tgz"}},{}],89:[function(a,b){var c=b.exports=a("./lib/loopback"),d=a("loopback-datasource-juggler");c.Connector=a("./lib/connectors/base-connector"),c.Memory=a("./lib/connectors/memory"),c.Mail=a("./lib/connectors/mail"),c.Remote=a("./lib/connectors/remote"),c.GeoPoint=a("loopback-datasource-juggler/lib/geo").GeoPoint,c.ValidationError=d.ValidationError},{"./lib/connectors/base-connector":93,"./lib/connectors/mail":94,"./lib/connectors/memory":95,"./lib/connectors/remote":96,"./lib/loopback":98,"loopback-datasource-juggler":61,"loopback-datasource-juggler/lib/geo":65}],90:[function(a,b,c){(function(d,e){function f(a,b){b&&s("object"==typeof b,a+" config must be a valid JSON object")}function g(a,b){"object"==typeof a&&Object.keys(a).forEach(function(c){b(c,a[c])})}function h(a){return y.classify(a)}function i(a){return y.camelize(a)}function j(b,c){var d;if(s("object"==typeof b,"cannont create data source without config object"),"string"==typeof b.connector){var f=b.connector;c[f]?b.connector=c[f]:(d=z.join(e,"connectors",f+".js"),t.existsSync(d)&&(b.connector=a(d)))}return r.createDataSource(b)}function k(a,b,c){s(a.prototype instanceof r.Model,"Model must be a descendant of loopback.Model");var d=b.dataSource;"string"==typeof d&&(d=c.dataSources[d]),s(d instanceof q,a.modelName+' is referencing a dataSource that does not exist: "'+b.dataSource+'"'),b=u({},b),b.dataSource=d,r.configureModel(a,b)}function l(b,c){s(b,"cannot require directory contents without directory name");var d={};if(2===arguments.length)c.forEach(function(a){var c=Path.resolve(Path.join(b,a));d[a]=m(c)});else if(1===arguments.length){var e=n(b);e.sort(function(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),b>a?-1:a>b?1:0}),e.forEach(function(c){if("index.js"!==c&&"_"!==c[0]){var e=z.resolve(z.join(b,c)),f=z.extname(c),g=t.statSync(e);if(!g.isFile()||f in a.extensions){var h=z.basename(c,f);d[h]=m(e)}}})}return d}function m(b){try{return a.apply(this,arguments)}catch(c){throw console.error('failed to require "%s"',b),c}}function n(){try{return t.readdirSync.apply(t,arguments)}catch(a){return[]}}function o(b,c){try{return a(z.join(b,c+".json"))}catch(d){if("MODULE_NOT_FOUND"!==d.code)throw d}}function p(a){a._handlers=void 0}var q=a("loopback-datasource-juggler").DataSource,r=a("./registry"),s=(a("./compat"),a("assert")),t=a("fs"),u=a("util")._extend,v=a("underscore"),w=a("strong-remoting"),x=a("strong-remoting/ext/swagger"),y=a("underscore.string"),z=a("path"),A=c=b.exports={};A.remotes=function(){if(this._remotes)return this._remotes;var a={};return this.get&&(a=this.get("remoting")),this._remotes=w.create(a)},A.disuse=function(a){if(this.stack)for(var b=0;b<this.stack.length;b++)this.stack[b].route===a&&this.stack.splice(b,1)},A.model=function(a,b){var c=!0;if(arguments.length>1){if(b=b||{},"string"==typeof a){var d=u({},b);d.options=u({},b.options),d.name=a,delete d.dataSource,a=r.createModel(d),["relations","base","acls","hidden"].forEach(function(a){delete b[a],b.options&&delete b.options[a]}),delete b.properties}k(a,b,this),c=b.public!==!1}else s(a.prototype instanceof r.Model,"Model must be a descendant of loopback.Model");var e=a.modelName;return this.models[e]=this.models[h(e)]=this.models[i(e)]=a,this.models().push(a),c&&a.sharedClass&&(this.remotes().addClass(a.sharedClass),p(this)),a.shared=c,a.app=this,a.emit("attached",this),a},A.models=function(){return this._models||(this._models=[])},A.dataSource=function(a,b){this.dataSources[a]=this.dataSources[h(a)]=this.dataSources[i(a)]=j(b,this.connectors)},A.connector=function(a,b){this.connectors[a]=this.connectors[h(a)]=this.connectors[i(a)]=b},A.remoteObjects=function(){var a={};return this.remotes().classes().forEach(function(b){a[b.name]=b.ctor}),a},A.docs=function(a){var b=this.remotes();x(b,a)},A.handler=function(a){var b=this._handlers||(this._handlers={});if(b[a])return b[a];var c=this.remotes(),d=this._handlers[a]=c.handler(a);return d},A.dataSources=A.datasources={},A.enableAuth=function(){var a=this.remotes(),b=this;a.before("**",function(a,c,d){var e=a.req,f=d.ctor,g=a.instance,h=g&&g.id||e.param("id"),i=f.settings||{},j=i.aclErrorStatus||b.get("aclErrorStatus")||401;e.accessToken||(j=401),f.checkAccess?(e.pause(),f.checkAccess(e.accessToken,h,d,function(a,b){if(e.resume(),a)console.log(a),c(a);else if(b)c();else{var d={403:"Access Denied",404:"could not find a model with id "+h,401:"Authorization Required"},f=new Error(d[j]||d[403]);f.statusCode=j,c(f)}})):c()}),this.isAuthEnabled=!0},A.boot=function(a){a=a||{},"string"==typeof a&&(a={appRootDir:a});var b=this,c=a.appRootDir=a.appRootDir||d.cwd(),e=a.app,h=a.models,i=a.dataSources;if(e||(e=o(c,"app")||{}),h||(h=o(c,"models")||{}),i||(i=o(c,"datasources")||{}),f("app",e),f("model",h),f("data source",i),e.host=d.env.npm_config_host||d.env.OPENSHIFT_SLS_IP||d.env.OPENSHIFT_NODEJS_IP||d.env.HOST||e.host||d.env.npm_package_config_host||b.get("host"),e.port=v.find([d.env.npm_config_port,d.env.OPENSHIFT_SLS_PORT,d.env.OPENSHIFT_NODEJS_PORT,d.env.PORT,e.port,d.env.npm_package_config_port,b.get("port"),3e3],v.isFinite),e.restApiRoot=e.restApiRoot||b.get("restApiRoot")||"/api",void 0!==e.host&&(s("string"==typeof e.host,"app.host must be a string"),b.set("host",e.host)),void 0!==e.port){var j=typeof e.port;s("string"===j||"number"===j,"app.port must be a string or number"),b.set("port",e.port)}s(void 0!==e.restApiRoot,"app.restApiRoot is required"),s("string"==typeof e.restApiRoot,"app.restApiRoot must be a string"),s(/^\//.test(e.restApiRoot),'app.restApiRoot must start with "/"'),b.set("restApiRoot",e.restApiRoot);for(var k in e){var m=b.get(k);(void 0===m||null===m)&&b.set(k,e[k])}g(i,function(a,c){b.dataSource(a,c)}),g(h,function(a,c){b.model(a,c)});try{r.autoAttach()}catch(n){if("AssertionError"!==n.name)throw n;console.warn(n)}var p=b.remotes().exports.swagger,q=e.swagger&&e.swagger.requireToken;p&&(p.requireToken=q||!1);l(z.join(c,"models")),l(z.join(c,"boot"))},A.listen=function(b){var c=this,d=a("http").createServer(this);d.on("listening",function(){c.set("port",this.address().port)});var e=0==arguments.length||1==arguments.length&&"function"==typeof arguments[0];return e?d.listen(this.get("port"),this.get("host"),b):d.listen.apply(d,arguments),d}}).call(this,a("+xKvab"),"/../node_modules/loopback/lib")},{"+xKvab":29,"./compat":92,"./registry":110,assert:9,fs:8,http:23,"loopback-datasource-juggler":61,path:28,"strong-remoting":117,"strong-remoting/ext/swagger":116,underscore:133,"underscore.string":132,util:50}],91:[function(a,b){function c(){return new d}function d(){this.settings={}}b.exports=c,c.errorHandler={},d.prototype.set=function(a,b){return 1==arguments.length?this.get(a):(this.settings[a]=b,this)},d.prototype.get=function(a){return this.settings[a]}},{}],92:[function(a,b,c){var d=a("assert"),e=c;e.usePluralNamesForRemoting=!1,e.getClassNameForRemoting=function(a){return d("function"==typeof a,"compat.getClassNameForRemoting expects a constructor as the argument"),e.usePluralNamesForRemoting?(d(a.pluralModelName,'Model must have a "pluralModelName" property in compat mode'),a.pluralModelName):a.modelName}},{assert:9}],93:[function(a,b){function c(a){d.apply(this,arguments),this.options=a,e("created with options",a)}b.exports=c;{var d=a("events").EventEmitter,e=a("debug")("connector"),f=a("util"),g=f.inherits;a("assert")}g(c,d),c._createJDBAdapter=function(a){var b={};a.initialize(b,function(){})},c.prototype._addCrudOperationsFromJDBAdapter=function(){}},{assert:9,debug:115,events:22,util:50}],94:[function(a,b){(function(c){function d(a){g("object"==typeof a,"cannot initiaze MailConnector without a settings object");var b=a.transports||[];this.transportsIndex={},this.transports=[],i.isServer&&b.forEach(this.setupTransport.bind(this))}function e(){}var f=a("nodemailer"),g=a("assert"),h=a("debug"),i=a("../loopback");b.exports=d,d.initialize=function(a,b){a.connector=new d(a.settings),b()},d.prototype.DataAccessObject=e,d.prototype.setupTransport=function(a){var b=this;b.transports=b.transports||[],b.transportsIndex=b.transportsIndex||{};var c=f.createTransport(a.type,a);b.transportsIndex[a.type]=c,b.transports.push(c)},d.prototype.transportForName=function(a){return this.transportsIndex[a]},d.prototype.defaultTransport=function(){return this.transports[0]||this.stubTransport},e.send=function(a,b){var d=this.dataSource,e=d&&d.settings,f=d.connector;g(f,"Cannot send mail without a connector!");var i=f.transportForName(a.transport);i||(i=f.defaultTransport()),(h.enabled||e&&e.debug)&&(console.log("Sending Mail:"),a.transport&&console.log("	 TRANSPORT:",a.transport),console.log("	 TO:",a.to),console.log("	 FROM:",a.from),console.log("	 SUBJECT:",a.subject),console.log("	 TEXT:",a.text),console.log("	 HTML:",a.html)),i?(g(i.sendMail,"You must supply an Email.settings.transports containing a valid transport"),i.sendMail(a,b)):(console.warn("Warning: No email transport specified for sending email. Setup a transport to send mail messages."),c.nextTick(function(){b(null,a)}))},e.prototype.send=function(a){this.constructor.send(this,a)},d.mailer=d.prototype.mailer=e.mailer=e.prototype.mailer=f}).call(this,a("+xKvab"))},{"+xKvab":29,"../loopback":98,assert:9,debug:115,nodemailer:12}],95:[function(a,b){function c(){}b.exports=c;var d=a("./base-connector"),e=(a("debug")("memory"),a("util")),f=e.inherits,g=(a("assert"),a("loopback-datasource-juggler/lib/connectors/memory"));f(c,d),c.initialize=g.initialize},{"./base-connector":93,assert:9,debug:115,"loopback-datasource-juggler/lib/connectors/memory":62,util:50}],96:[function(a,b){function c(a){e("object"==typeof a,"cannot initiaze RemoteConnector without a settings object"),this.client=a.client,this.adapter=a.adapter||"rest",this.protocol=a.protocol||"http",this.root=a.root||"",this.host=a.host||"localhost",this.port=a.port||3e3,this.remotes=f.create(),this.name="remote-connector",this.url=a.url?a.url:this.protocol+"://"+this.host+":"+this.port+this.root;this.DataAccessObject=function(){}}function d(a,b,c){{var d=c.isStatic?a:a.prototype;d[c.name]}d[c.name]=function(){var a,d=Array.prototype.slice.call(arguments),e="function"==typeof d[d.length-1];e&&(a=d.pop()),b.invoke(c.stringName,d,a)}}{var e=a("assert"),f=a("strong-remoting");a("../compat"),a("loopback-datasource-juggler/lib/dao")}b.exports=c,c.prototype.connect=function(){this.remotes.connect(this.url,this.adapter)},c.initialize=function(a,b){var d=a.connector=new c(a.settings);d.connect(),b()},c.prototype.define=function(a){var b=a.model,c=this.remotes;e(b.sharedClass,"cannot attach "+b.modelName+" to a remote connector without a Model.sharedClass"),c.addClass(b.sharedClass),b.sharedClass.methods().forEach(function(a){"Change"!==a.name&&"Checkpoint"!==a.name&&d(b,c,a)})}},{"../compat":92,assert:9,"loopback-datasource-juggler/lib/dao":63,"strong-remoting":117}],97:[function(a,b,c){(function(b){function d(b){try{return a(b)}catch(c){return void 0}}function e(a,b){return function(){throw new Error("The middleware loopback."+a+" is not installed.\nPlease run `npm install "+b+"` to fix the problem.")}}var f=(a("express"),a("path")),g=c,h={compress:"compression",timeout:"connect-timeout",cookieParser:"cookie-parser",cookieSession:"cookie-session",csrf:"csurf",errorHandler:"errorhandler",session:"express-session",methodOverride:"method-override",logger:"morgan",responseTime:"response-time",favicon:"serve-favicon",directory:"serve-index",vhost:"vhost"};g.bodyParser=d("body-parser"),g.json=g.bodyParser&&g.bodyParser.json,g.urlencoded=g.bodyParser&&g.bodyParser.urlencoded;for(var i in h){var j=h[i];g[i]=d(j)||e(i,j)}var k=g.favicon;g.favicon=function(a,c){return a=a||f.join(b,"../favicon.ico"),k(a,c)}}).call(this,"/../node_modules/loopback/lib")},{express:91,path:28}],98:[function(a,b,c){(function(d){function e(){var a=g();return l(a,h),a.loopback=m,a.models=function(){return h.models.apply(this,arguments)},a.datasources=a.dataSources={},a.connectors={},a.connector("memory",m.Memory),a.connector("remote",m.Remote),a}function f(a){for(var b in a){var c=Object.getOwnPropertyDescriptor(a,b);c&&Object.defineProperty(m,b,c)}}var g=a("express"),h=a("./application"),i=a("fs"),j=a("ejs"),k=a("path"),l=a("util")._extend,m=(a("assert"),c=b.exports=e);if(m.version=a("../package.json").version,m.mime=g.mime,m.compat=a("./compat"),f(a("./runtime")),f(a("./registry")),f(g),m.isServer){var n=a("./express-middleware");f(n)}m.isServer&&i.readdirSync(k.join(d,"middleware")).filter(function(a){return a.match(/\.js$/)}).forEach(function(b){m[b.replace(/\.js$/,"")]=a("./middleware/"+b)}),m.errorHandler.title="Loopback",m.remoteMethod=function(a,b){a.shared=!0,"object"==typeof b&&Object.keys(b).forEach(function(c){a[c]=b[c]}),a.http=a.http||{verb:"get"}},m.template=function(a){var b=this._templates||(this._templates={}),c=b[a]||(b[a]=i.readFileSync(a,"utf8"));return j.compile(c)},m.Email=a("./models/email"),m.User=a("./models/user"),m.Application=a("./models/application"),m.AccessToken=a("./models/access-token"),m.Role=a("./models/role").Role,m.RoleMapping=a("./models/role").RoleMapping,m.ACL=a("./models/acl").ACL,m.Scope=a("./models/acl").Scope,m.Change=a("./models/change");var o={DB:"db",MAIL:"mail"};m.Email.autoAttach=o.MAIL,m.PersistedModel.autoAttach=o.DB,m.User.autoAttach=o.DB,m.AccessToken.autoAttach=o.DB,m.Role.autoAttach=o.DB,m.RoleMapping.autoAttach=o.DB,m.ACL.autoAttach=o.DB,m.Scope.autoAttach=o.DB,m.Application.autoAttach=o.DB}).call(this,"/../node_modules/loopback/lib")},{"../package.json":134,"./application":90,"./compat":92,"./express-middleware":97,"./models/access-token":100,"./models/acl":101,"./models/application":102,"./models/change":103,"./models/email":105,"./models/role":108,"./models/user":109,"./registry":110,"./runtime":111,assert:9,ejs:51,express:91,fs:8,path:28,util:50}],99:[function(a,b){function c(a){if(!(this instanceof c))return new c(a);a=a||{},this.principals=a.principals||[];var b=a.model;b="string"==typeof b?f.getModel(b):b,this.model=b,this.modelName=b&&b.modelName,this.modelId=a.id||a.modelId,this.property=a.property||c.ALL,this.method=a.method,this.sharedMethod=a.sharedMethod,this.sharedClass=this.sharedMethod&&this.sharedMethod.sharedClass,this.methodNames=this.sharedMethod?this.sharedMethod.aliases.concat([this.sharedMethod.name]):[],this.sharedMethod&&(this.accessType=this.model._getAccessTypeForMethod(this.sharedMethod)),this.accessType=a.accessType||c.ALL,this.accessToken=a.accessToken||g.ANONYMOUS;var e=a.principalType||d.USER,h=a.principalId||void 0,i=a.principalName||void 0;h&&this.addPrincipal(e,h,i);var j=this.accessToken||{};j.userId&&this.addPrincipal(d.USER,j.userId),j.appId&&this.addPrincipal(d.APPLICATION,j.appId)}function d(a,b,c){return this instanceof d?(this.type=a,this.id=b,void(this.name=c)):new d(a,b,c)}function e(a,b,d,f,g){if(!(this instanceof e))return new e(a,b,d);if(1===arguments.length&&"object"==typeof a){var h=a||{};this.model=h.model||c.ALL,this.property=h.property||c.ALL,this.accessType=h.accessType||c.ALL,this.permission=h.permission||c.DEFAULT,this.methodNames=g||[]}else this.model=a||c.ALL,this.property=b||c.ALL,this.accessType=d||c.ALL,this.permission=f||c.DEFAULT,this.methodNames=g||[]}var f=a("../loopback"),g=a("./access-token"),h=a("debug")("loopback:security:access-context");c.ALL="*",c.READ="READ",c.WRITE="WRITE",c.EXECUTE="EXECUTE",c.DEFAULT="DEFAULT",c.ALLOW="ALLOW",c.ALARM="ALARM",c.AUDIT="AUDIT",c.DENY="DENY",c.permissionOrder={DEFAULT:0,ALLOW:1,ALARM:2,AUDIT:3,DENY:4},c.prototype.addPrincipal=function(a,b,c){for(var e=new d(a,b,c),f=0;f<this.principals.length;f++){var g=this.principals[f];if(g.equals(e))return!1}return this.principals.push(e),!0},c.prototype.getUserId=function(){for(var a=0;a<this.principals.length;a++){var b=this.principals[a];if(b.type===d.USER)return b.id}return null},c.prototype.getAppId=function(){for(var a=0;a<this.principals.length;a++){var b=this.principals[a];if(b.type===d.APPLICATION)return b.id}return null},c.prototype.isAuthenticated=function(){return!(!this.getUserId()&&!this.getAppId())},c.prototype.debug=function(){h.enabled&&(h("---AccessContext---"),this.principals&&this.principals.length?(h("principals:"),this.principals.forEach(function(a){h("principal: %j",a)})):h("principals: %j",this.principals),h("modelName %s",this.modelName),h("modelId %s",this.modelId),h("property %s",this.property),h("method %s",this.method),h("accessType %s",this.accessType),this.accessToken&&(h("accessToken:"),h("  id %j",this.accessToken.id),h("  ttl %j",this.accessToken.ttl)),h("getUserId() %s",this.getUserId()),h("isAuthenticated() %s",this.isAuthenticated()))},d.USER="USER",d.APP=d.APPLICATION="APP",d.ROLE="ROLE",d.SCOPE="SCOPE",d.prototype.equals=function(a){return a instanceof d?this.type===a.type&&String(this.id)===String(a.id):!1},e.prototype.isWildcard=function(){return this.model===c.ALL||this.property===c.ALL||this.accessType===c.ALL},e.prototype.exactlyMatches=function(a){var b=a.model===this.model,c=a.property===this.property,d=-1!==this.methodNames.indexOf(a.property),e=a.accessType===this.accessType;return b&&e?c||d:!1},e.prototype.isAllowed=function(){return this.permission!==a("./acl").ACL.DENY},e.prototype.debug=function(){h.enabled&&(h("---AccessRequest---"),h(" model %s",this.model),h(" property %s",this.property),h(" accessType %s",this.accessType),h(" permission %s",this.permission),h(" isWildcard() %s",this.isWildcard()),h(" isAllowed() %s",this.isAllowed()))},b.exports.AccessContext=c,b.exports.Principal=d,b.exports.AccessRequest=e},{"../loopback":98,"./access-token":100,"./acl":101,debug:115}],100:[function(a,b){(function(c){function d(a,b){var c,d,e=b.params||[],f=b.headers||[],g=b.cookies||[],h=0;for(e=e.concat(["access_token"]),f=f.concat(["X-Access-Token","authorization"]),g=g.concat(["access_token","authorization"]),c=e.length;c>h;h++)if(d=a.param(e[h]),"string"==typeof d)return d;for(h=0,c=f.length;c>h;h++)if(d=a.header(f[h]),"string"==typeof d)return d;if(a.signedCookies)for(h=0,c=f.length;c>h;h++)if(d=a.signedCookies[g[h]],"string"==typeof d)return d;return null}var e=a("../loopback").Model,f=(a("../loopback"),a("assert")),g=(a("crypto"),a("uid2")),h=1209600,i=64,j=a("./role").Role,k=a("./acl").ACL,l={id:{type:String,id:!0},ttl:{type:Number,ttl:!0,"default":h},created:{type:Date,"default":function(){return new Date}}},m=b.exports=e.extend("AccessToken",l,{acls:[{principalType:k.ROLE,principalId:j.EVERYONE,permission:"DENY"},{principalType:k.ROLE,principalId:j.EVERYONE,property:"create",permission:"ALLOW"}],relations:{user:{type:"belongsTo",model:"User",foreignKey:"userId"}}});m.ANONYMOUS=new m({id:"$anonymous"}),m.createAccessTokenId=function(a){g(this.settings.accessTokenIdLength||i,function(b,c){b?a(b):a(null,c)})},m.beforeCreate=function(a,b){b=b||{},m.createAccessTokenId(function(c,d){c?a(c):(b.id=d,a())})},m.findForRequest=function(a,b,e){var f=d(a,b);f?this.findById(f,function(a,b){a?e(a):b?b.validate(function(a,c){a?e(a):c?e(null,b):e(new Error("Invalid Access Token"))}):e()}):c.nextTick(function(){e()})},m.prototype.validate=function(a){try{f(this.created&&"function"==typeof this.created.getTime,"token.created must be a valid Date"),f(0!==this.ttl,"token.ttl must be not be 0"),f(this.ttl,"token.ttl must exist"),f(this.ttl>=-1,"token.ttl must be >= -1");var b=Date.now(),c=this.created.getTime(),d=(b-c)/1e3,e=this.ttl,g=e>d;g?a(null,g):this.destroy(function(b){a(b,g)})}catch(h){a(h)}}}).call(this,a("+xKvab"))},{"+xKvab":29,"../loopback":98,"./acl":101,"./role":108,assert:9,crypto:17,uid2:131}],101:[function(a,b){(function(c){var d=a("../loopback"),e=a("async"),f=a("assert"),g=a("debug")("loopback:security:acl"),h=a("./access-context"),i=h.AccessContext,j=h.Principal,k=h.AccessRequest,l=a("./role"),m=l.Role,n={model:String,property:String,accessType:String,permission:String,principalType:String,principalId:String},o=d.PersistedModel.extend("ACL",n);o.ALL=i.ALL,o.DEFAULT=i.DEFAULT,o.ALLOW=i.ALLOW,o.ALARM=i.ALARM,o.AUDIT=i.AUDIT,o.DENY=i.DENY,o.READ=i.READ,o.WRITE=i.WRITE,o.EXECUTE=i.EXECUTE,o.USER=j.USER,o.APP=o.APPLICATION=j.APPLICATION,o.ROLE=j.ROLE,o.SCOPE=j.SCOPE,o.getMatchingScore=function(a,b){for(var c=["model","property","accessType"],d=0,e=0;e<c.length;e++){d=4*d;
var f=a[c[e]]||o.ALL,g=b[c[e]]||o.ALL,h="property"===c[e]&&-1!==b.methodNames.indexOf(f);if(f===g||h)d+=3;else if(f===o.ALL)d+=2;else{if(g!==o.ALL)return-1;d+=1}}switch(d=4*d,a.principalType){case o.USER:d+=4;break;case o.APP:d+=3;break;case o.ROLE:d+=2;break;default:d+=1}if(d=8*d,a.principalType===o.ROLE)switch(a.principalId){case m.OWNER:d+=4;break;case m.RELATED:d+=3;break;case m.AUTHENTICATED:case m.UNAUTHENTICATED:d+=2;break;case m.EVERYONE:d+=1;break;default:d+=5}return d=4*d,d+=i.permissionOrder[a.permission||o.ALLOW]-1},o.prototype.score=function(a){return this.constructor.getMatchingScore(this,a)},o.resolvePermission=function(a,b){b instanceof k||(b=new k(b)),a=a.sort(function(a,c){return o.getMatchingScore(c,b)-o.getMatchingScore(a,b)});for(var c=o.DEFAULT,d=0,e=0;e<a.length&&(d=o.getMatchingScore(a[e],b),!(0>d));e++){if(!b.isWildcard()){c=a[e].permission;break}if(b.exactlyMatches(a[e])){c=a[e].permission;break}i.permissionOrder[a[e].permission]>i.permissionOrder[c]&&(c=a[e].permission)}g.enabled&&(g("The following ACLs were searched: "),a.forEach(function(a){a.debug(),g("with score:",a.score(b))}));var f=new k(b.model,b.property,b.accessType,c||o.DEFAULT);return f},o.getStaticACLs=function(a,b){var c=d.findModel(a),e=[];c&&c.settings.acls&&c.settings.acls.forEach(function(b){e.push(new o({model:a,property:b.property||o.ALL,principalType:b.principalType,principalId:b.principalId,accessType:b.accessType||o.ALL,permission:b.permission}))});var f=c&&(c.definition.properties[b]||c._scopeMeta&&c._scopeMeta[b]||c[b]||c.prototype[b]);return f&&f.acls&&f.acls.forEach(function(a){e.push(new o({model:c.modelName,property:b,principalType:a.principalType,principalId:a.principalId,accessType:a.accessType,permission:a.permission}))}),e},o.checkPermission=function(a,b,e,f,h,i){null!==b&&void 0!==b&&"string"!=typeof b&&(b=b.toString()),f=f||o.ALL;var j=f===o.ALL?void 0:{inq:[f,o.ALL]};h=h||o.ALL;var l=h===o.ALL?void 0:{inq:[h,o.ALL]},m=new k(e,f,h),n=this.getStaticACLs(e,f),p=this.resolvePermission(n,m);if(p&&p.permission===o.DENY)return g("Permission denied by statically resolved permission"),g(" Resolved Permission: %j",p),void c.nextTick(function(){i&&i(null,p)});var q=this;this.find({where:{principalType:a,principalId:b,model:e,property:j,accessType:l}},function(a,b){if(a)return void(i&&i(a));if(n=n.concat(b),p=q.resolvePermission(n,m),p&&p.permission===o.DEFAULT){var c=d.findModel(e);p.permission=c&&c.settings.defaultPermission||o.ALLOW}i&&i(null,p)})},o.prototype.debug=function(){g.enabled&&(g("---ACL---"),g("model %s",this.model),g("property %s",this.property),g("principalType %s",this.principalType),g("principalId %s",this.principalId),g("accessType %s",this.accessType),g("permission %s",this.permission))},o.checkAccessForContext=function(a,b){a instanceof i||(a=new i(a));var c=a.model,f=a.property,h=a.accessType,j=a.modelName,l=a.methodNames,n=f===o.ALL?void 0:{inq:l.concat([o.ALL])},p=h===o.ALL?void 0:{inq:[h,o.ALL]},q=new k(j,f,h,o.DEFAULT,l),r=[],s=this.getStaticACLs(c.modelName,f),t=this,u=d.getModelByType(m);this.find({where:{model:c.modelName,property:n,accessType:p}},function(d,f){if(d)return void(b&&b(d));var h=[];f=f.concat(s),f.forEach(function(b){for(var c=0;c<a.principals.length;c++){var d=a.principals[c];if(d.type===b.principalType&&String(d.id)===String(b.principalId))return void r.push(b)}b.principalType===o.ROLE&&h.push(function(c){u.isInRole(b.principalId,a,function(a,d){!a&&d&&r.push(b),c(a,b)})})}),e.parallel(h,function(a){if(a)return void(b&&b(a,null));var d=t.resolvePermission(r,q);d&&d.permission===o.DEFAULT&&(d.permission=c&&c.settings.defaultPermission||o.ALLOW),g("---Resolved---"),d.debug(),b&&b(null,d)})})},o.checkAccessForToken=function(a,b,c,d,e){f(a,"Access token is required");var g=new i({accessToken:a,model:b,property:d,method:d,modelId:c});this.checkAccessForContext(g,function(a,b){return a?void(e&&e(a)):void(e&&e(null,b.permission!==o.DENY))})};var p={name:{type:String,required:!0},description:String},q=d.createModel("Scope",p);q.checkPermission=function(a,b,c,e,f){this.findOne({where:{name:a}},function(a,g){if(a)f&&f(a);else{var h=d.getModelByType(o);h.checkPermission(o.SCOPE,g.id,b,c,e,f)}})},b.exports.ACL=o,b.exports.Scope=q}).call(this,a("+xKvab"))},{"+xKvab":29,"../loopback":98,"./access-context":99,"./role":108,assert:9,async:112,debug:115}],102:[function(a,b){function c(a,b,c){a=a||"loopback",b=b||"sha1",c=c||"hex";var d=k.createHmac(b,a),e=k.randomBytes(32);d.update(e);var f=d.digest(c);return f}var d=a("../loopback"),e=a("assert"),f={scheme:String,credential:Object},g={production:Boolean,certData:String,keyData:String,pushOptions:{type:{gateway:String,port:Number}},feedbackOptions:{type:{gateway:String,port:Number,batchFeedback:Boolean,interval:Number}}},h={serverApiKey:String},i={apns:g,gcm:h},j={id:{type:String,id:!0},name:{type:String,required:!0},description:String,icon:String,owner:String,collaborators:[String],email:String,emailVerified:Boolean,url:String,callbackUrls:[String],permissions:[String],clientKey:String,javaScriptKey:String,restApiKey:String,windowsKey:String,masterKey:String,pushSettings:i,authenticationEnabled:{type:Boolean,"default":!0},anonymousAllowed:{type:Boolean,"default":!0},authenticationSchemes:[f],status:{type:String,"default":"sandbox"},created:{type:Date,"default":Date},modified:{type:Date,"default":Date}},k=a("crypto"),l=d.PersistedModel.extend("Application",j);l.beforeCreate=function(a){var b=this;b.created=b.modified=new Date,b.id=c("id","md5"),b.clientKey=c("client"),b.javaScriptKey=c("javaScript"),b.restApiKey=c("restApi"),b.windowsKey=c("windows"),b.masterKey=c("master"),a()},l.register=function(a,b,c,d){e(a,"owner is required"),e(b,"name is required"),"function"!=typeof c||d||(d=c,c={});var f={owner:a,name:b};for(var g in c)g in f||(f[g]=c[g]);this.create(f,d)},l.prototype.resetKeys=function(a){this.clientKey=c("client"),this.javaScriptKey=c("javaScript"),this.restApiKey=c("restApi"),this.windowsKey=c("windows"),this.masterKey=c("master"),this.modified=new Date,this.save(a)},l.resetKeys=function(a,b){this.findById(a,function(a,c){return a?void(b&&b(a,c)):void c.resetKeys(b)})},l.authenticate=function(a,b,c){this.findById(a,function(a,d){if(a||!d)return void(c&&c(a,null));for(var e=null,f=["clientKey","javaScriptKey","restApiKey","windowsKey","masterKey"],g=0;g<f.length;g++)if(d[f[g]]===b){e={application:d,keyType:f[g]};break}c&&c(null,e)})},b.exports=l},{"../loopback":98,assert:9,crypto:17}],103:[function(a,b){function c(a,b,c){this.SourceModel=b,this.TargetModel=c,this.SourceChange=b.getChangeModel(),this.TargetChange=c.getChangeModel(),this.modelId=a}var d=a("./persisted-model"),e=a("../loopback"),f=a("crypto"),g={stringify:a("canonical-json")},h=a("async"),i=a("assert"),j=a("debug")("loopback:change"),k={id:{type:String,generated:!0,id:!0},rev:{type:String},prev:{type:String},checkpoint:{type:Number},modelName:{type:String},modelId:{type:String}},l={trackChanges:!1},m=b.exports=d.extend("Change",k,l);m.UPDATE="update",m.CREATE="create",m.DELETE="delete",m.UNKNOWN="unknown",m.Conflict=c,m.setup=function(){d.setup.call(this);var a=this;a.getter.id=function(){var b=this.modelName&&this.modelId;return b?a.idForModel(this.modelName,this.modelId):null}},m.setup(),m.rectifyModelChanges=function(a,b,c){var d=[],e=this;b.forEach(function(b){d.push(function(c){e.findOrCreateChange(a,b,function(a,b){return a?e.handleError(a,c):void b.rectify(c)})})}),h.parallel(d,c)},m.idForModel=function(a,b){return this.hash([a,b].join("-"))},m.findOrCreateChange=function(a,b,c){i(e.findModel(a),a+" does not exist");var d=this.idForModel(a,b),f=this;this.findById(d,function(e,g){if(e)return c(e);if(g)c(null,g);else{var h=new f({id:d,modelName:a,modelId:b});h.debug("creating change"),h.save(c)}})},m.prototype.rectify=function(a){function b(a){d.currentRevision(function(b,c){return b?m.handleError(b,a):(c?f!==c?(d.rev=c,d.prev=f):d.debug("rev and prev are equal (not updating rev)"):(d.rev=null,f?d.prev=f:d.prev||(d.debug("ERROR - could not determing prev"),d.prev=m.UNKNOWN)),d.debug("updated revision (was "+f+")"),void a())})}function c(a){d.constructor.getCheckpointModel().current(function(b,c){return b?m.handleError(b):(d.checkpoint=c,void a())})}var d=this,e=[b,c],f=this.rev;d.debug("rectify change"),a=a||function(a){if(a)throw new Error(a)},h.parallel(e,function(b){return b?a(b):void(d.prev===m.UNKNOWN?d.remove(a):d.save(a))})},m.prototype.currentRevision=function(a){var b=this.getModelCtor(),c=this.getModelId();b.findById(c,function(b,c){return b?m.handleError(b,a):void(c?a(null,m.revisionForInst(c)):a(null,null))})},m.hash=function(a){return f.createHash(m.settings.hashAlgorithm||"sha1").update(a).digest("hex")},m.revisionForInst=function(a){return this.hash(g.stringify(a))},m.prototype.type=function(){return this.rev&&this.prev?m.UPDATE:this.rev&&!this.prev?m.CREATE:!this.rev&&this.prev?m.DELETE:m.UNKNOWN},m.prototype.equals=function(a){if(!a)return!1;var b=this.rev||null,c=a.rev||null;return b===c},m.prototype.conflictsWith=function(a){return a?this.equals(a)?!1:m.bothDeleted(this,a)?!1:this.isBasedOn(a)?!1:!0:!1},m.bothDeleted=function(a,b){return a.type()===m.DELETE&&b.type()===m.DELETE},m.prototype.isBasedOn=function(a){return this.prev===a.rev},m.diff=function(a,b,c,d){var e={},f=[];c.forEach(function(a){f.push(a.modelId),e[a.modelId]=new m(a)}),b=Number(b)||0,this.find({where:{modelName:a,modelId:{inq:f},checkpoint:{gte:b}}},function(a,b){if(a)return d(a);var c=[],g=[],h=[];b.forEach(function(a){a=new m(a),h.push(a.modelId);var b=e[a.modelId];b&&!a.equals(b)&&(b.conflictsWith(a)?(b.debug("remote conflict"),a.debug("local conflict"),g.push(a)):(b.debug("remote delta"),c.push(b)))}),f.forEach(function(a){-1===h.indexOf(a)&&c.push(e[a])}),d(null,{deltas:c,conflicts:g})})},m.rectifyAll=function(a){j("rectify all");var b=this;this.find(function(c,d){return c?a(c):void d.forEach(function(a){a=new b(a),a.rectify()})})},m.getCheckpointModel=function(){var b=this.Checkpoint;return b?b:(this.checkpoint=b=a("./checkpoint").extend("checkpoint"),i(this.dataSource,"Cannot getCheckpointModel(): "+this.modelName+" is not attached to a dataSource"),b.attachTo(this.dataSource),b)},m.handleError=function(a){if(!this.settings.ignoreErrors)throw a},m.prototype.debug=function(){if(j.enabled){var a=Array.prototype.slice.call(arguments);j.apply(this,a),j("	id",this.id),j("	rev",this.rev),j("	prev",this.prev),j("	modelName",this.modelName),j("	modelId",this.modelId),j("	type",this.type())}},m.prototype.getModelCtor=function(){return this.constructor.settings.trackModel},m.prototype.getModelId=function(){var a=this.getModelCtor(),b=this.modelId,c=new a;return c.setId(b),c.getId()},m.prototype.getModel=function(a){var b=this.constructor.settings.trackModel,c=this.getModelId();b.findById(c,a)},c.prototype.models=function(a){function b(a){i.findById(g.modelId,function(b,c){return b?a(b):(e=c,void a())})}function c(a){j.findById(g.modelId,function(b,c){return b?a(b):(f=c,void a())})}function d(b){return b?a(b):void a(null,e,f)}var e,f,g=this,i=this.SourceModel,j=this.TargetModel;h.parallel([b,c],d)},c.prototype.changes=function(a){function b(a){g.SourceChange.findOne({where:{modelId:g.modelId}},function(b,c){return b?a(b):(e=c,void a())})}function c(a){g.TargetChange.findOne({where:{modelId:g.modelId}},function(b,c){return b?a(b):(f=c,void a())})}function d(b){return b?a(b):void a(null,e,f)}var e,f,g=this;h.parallel([b,c],d)},c.prototype.resolve=function(a){var b=this;b.changes(function(b,c,d){return b?callback(b):(c.prev=d.rev,void c.save(a))})},c.prototype.type=function(a){this.changes(function(b,c,d){if(b)return a(b);var e=c.type(),f=d.type();return e===m.UPDATE&&f===m.UPDATE?a(null,m.UPDATE):e===m.DELETE||f===m.DELETE?a(null,m.DELETE):a(null,m.UNKNOWN)})}},{"../loopback":98,"./checkpoint":104,"./persisted-model":107,assert:9,async:112,"canonical-json":114,crypto:17,debug:115}],104:[function(a,b){var c=a("../loopback").PersistedModel,d=(a("../loopback"),a("assert"),{seq:{type:Number},time:{type:Date,"default":Date},sourceId:{type:String}}),e={},f=b.exports=c.extend("Checkpoint",d,e);f.current=function(a){var b=this;this.find({limit:1,sort:"seq DESC"},function(c,d){if(c)return a(c);var e=d[0];e?a(null,e.seq):b.create({seq:0},function(b,c){return b?a(b):void a(null,c.seq)})})},f.beforeSave=function(a,b){b.getId()||void 0!==b.seq?a():b.constructor.current(function(c,d){return c?a(c):(b.seq=d+1,void a())})}},{"../loopback":98,assert:9}],105:[function(a,b){var c=a("../loopback").Model,d=(a("../loopback"),{to:{type:String,required:!0},from:{type:String,required:!0},subject:{type:String,required:!0},text:{type:String},html:{type:String}}),e=b.exports=c.extend("Email",d);e.prototype.send=function(){throw new Error("You must connect the Email Model to a Mail connector")}},{"../loopback":98}],106:[function(a,b){var c=a("../registry"),d=a("../compat"),e=a("loopback-datasource-juggler"),f=e.ModelBuilder,g=(e.DataSource,new f),h=a("assert"),i=(a("underscore"),a("strong-remoting").SharedClass),j=b.exports=g.define("Model");j.setup=function(){var a=this,b=this.settings,c=a.sharedClass=new i(d.getClassNameForRemoting(a),a,b.remoting);a.sharedCtor=function(a,b,c){var d=this;if("function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,"object"!=typeof a?(b=a,a=null):b=null),b&&a){var e=new d(a);e.id=b,c(null,e)}else a?c(null,new d(a)):b?d.findById(b,function(a,d){a?c(a):d?c(null,d):(a=new Error("could not find a model with id "+b),a.statusCode=404,c(a))}):c(new Error("must specify an id or data"))};var e=a.modelName+" id";return a.sharedCtor.accepts=[{arg:"id",type:"any",http:{source:"path"},description:e}],a.sharedCtor.http=[{path:"/:id"}],a.sharedCtor.returns={root:!0},a.beforeRemote=function(a,b){var c=this;if(this.app){var e=this.app.remotes(),f=d.getClassNameForRemoting(c);e.before(f+"."+a,function(a,c){b(a,a.result,c)})}else{var g=arguments;this.once("attached",function(){c.beforeRemote.apply(c,g)})}},a.afterRemote=function(a,b){var c=this;if(this.app){var e=this.app.remotes(),f=d.getClassNameForRemoting(c);e.after(f+"."+a,function(a,c){b(a,a.result,c)})}else{var g=arguments;this.once("attached",function(){c.afterRemote.apply(c,g)})}},c.resolve(function(b){var c=a.relations;if(c)for(var d in c){var e=c[d];"belongsTo"===e.type?a.belongsToRemoting(d,e,b):a.scopeRemoting(d,e,b)}}),a};var k=null;j._ACL=function(b){if(void 0!==b&&(k=b),k)return k;var d=a("./acl").ACL;return k=c.getModelByType(d)},j.checkAccess=function(b,c,d,e){var f=a("./access-token").ANONYMOUS;b=b||f;var g=j._ACL();g.checkAccessForContext({accessToken:b,model:this,property:d.name,method:d.name,sharedMethod:d,modelId:c,accessType:this._getAccessTypeForMethod(d)},function(a,b){return a?e(a):void e(null,b.isAllowed())})},j._getAccessTypeForMethod=function(a){"string"==typeof a&&(a={name:a}),h("object"==typeof a,"method is a required argument and must be a RemoteMethod object");var b=j._ACL();switch(a.name){case"create":return b.WRITE;case"updateOrCreate":return b.WRITE;case"upsert":return b.WRITE;case"exists":return b.READ;case"findById":return b.READ;case"find":return b.READ;case"findOne":return b.READ;case"destroyById":return b.WRITE;case"deleteById":return b.WRITE;case"removeById":return b.WRITE;case"count":return b.READ;default:return b.EXECUTE}},j.getApp=function(a){var b=this;this.app?a(null,this.app):b.once("attached",function(){h(b.app),a(null,b.app)})},j.remoteMethod=function(a,b){void 0===b.isStatic&&(b.isStatic=!0),this.sharedClass.defineMethod(a,b)},j.belongsToRemoting=function(a,b,c){var d=this.prototype[a];c("__get__"+a,{isStatic:!1,http:{verb:"get",path:"/"+a},accepts:{arg:"refresh",type:"boolean",http:{source:"query"}},description:"Fetches belongsTo relation "+a,returns:{arg:a,type:b.modelTo.modelName,root:!0}},d)},j.scopeRemoting=function(a,b,c){var d=b.modelTo.modelName;c("__get__"+a,{isStatic:!1,http:{verb:"get",path:"/"+a},accepts:{arg:"filter",type:"object"},description:"Queries "+a+" of "+this.modelName+".",returns:{arg:a,type:[d],root:!0}}),c("__create__"+a,{isStatic:!1,http:{verb:"post",path:"/"+a},accepts:{arg:"data",type:"object",http:{source:"body"}},description:"Creates a new instance in "+a+" of this model.",returns:{arg:"data",type:d,root:!0}}),c("__delete__"+a,{isStatic:!1,http:{verb:"delete",path:"/"+a},description:"Deletes all "+a+" of this model."})},j.setup()},{"../compat":92,"../registry":110,"./access-token":100,"./acl":101,assert:9,"loopback-datasource-juggler":61,"strong-remoting":117,underscore:133}],107:[function(a,b){function c(a,b){throw new Error("Cannot call "+a+"."+b+"(). The "+b+" method has not been setup. The PersistedModel has not been correctly attached to a DataSource!")}function d(a,b){if(null!==a.result)return b();var c=a.method.sharedClass.name,d=a.getArgByName("id"),e='Unknown "'+c+'" id "'+d+'".',f=new Error(e);f.statusCode=f.status=404,b(f)}var e=a("./model"),f=a("../runtime"),g=a("strong-remoting"),h=a("assert"),i=a("async"),j=b.exports=e.extend("PersistedModel");j.setup=function(){e.setup.call(this);var a=this,b=this.modelName;g.convert(b,function(b){return b?new a(b):b}),this.settings.trackChanges&&(a._defineChangeModel(),a.once("dataSourceAttached",function(){a.enableChangeTracking()})),a.setupRemoting()},j.create=function(){c(this.modelName,"create")},j.upsert=j.updateOrCreate=function(){c(this.modelName,"upsert")},j.findOrCreate=function(){c(this.modelName,"findOrCreate")},j.exists=function(){c(this.modelName,"exists")},j.findById=function(){c(this.modelName,"findById")},j.find=function(){c(this.modelName,"find")},j.findOne=function(){c(this.modelName,"findOne")},j.remove=j.deleteAll=j.destroyAll=function(){c(this.modelName,"destroyAll")},j.update=j.updateAll=function(){c(this.modelName,"updateAll")},j.removeById=j.deleteById=j.destroyById=function(){c(this.modelName,"deleteById")},j.count=function(){c(this.modelName,"count")},j.prototype.save=function(a,b){function c(){e.trigger("save",function(a){e.trigger("update",function(c){d.upsert(e,function(d){e._initProperties(f),c.call(e,function(){a.call(e,function(){b(d,e)})})})},f)},f)}var d=this.constructor;"function"==typeof a&&(b=a,a={}),b=b||function(){},a=a||{},"validate"in a||(a.validate=!0),"throws"in a||(a.throws=!1);var e=this,f=e.toObject(!0),g=this.getId();return g?a.validate?void e.isValid(function(d){if(d)c();else{var f=new ValidationError(e);if(a.throws)throw f;b(f,e)}}):c():d.create(this,b)},j.prototype.isNewRecord=function(){c(this.constructor.modelName,"isNewRecord")},j.prototype.remove=j.prototype.delete=j.prototype.destroy=function(){c(this.constructor.modelName,"destroy")},j.prototype.destroy._delegate=!0,j.prototype.updateAttribute=function(){c(this.constructor.modelName,"updateAttribute")},j.prototype.updateAttributes=function(){c(this.modelName,"updateAttributes")},j.prototype.reload=function(){c(this.constructor.modelName,"reload")},j.prototype.setId=function(a){this.getDataSource();this[this.getIdName()]=a},j.prototype.getId=function(){var a=this.toObject();if(a)return a[this.getIdName()]},j.prototype.getIdName=function(){return this.constructor.getIdName()},j.getIdName=function(){var a=this,b=a.getDataSource();return b.idName?b.idName(a.modelName):"id"},j.setupRemoting=function(){function a(a,c,d){var e=a[c];e._delegate=!0,d.isStatic=a===b,b.remoteMethod(c,d)}var b=this,c=b.modelName,e=b.settings;a(b,"create",{description:"Create a new instance of the model and persist it into the data source",accepts:{arg:"data",type:"object",description:"Model instance data",http:{source:"body"}},returns:{arg:"data",type:c,root:!0},http:{verb:"post",path:"/"}}),a(b,"upsert",{description:"Update an existing model instance or insert a new one into the data source",accepts:{arg:"data",type:"object",description:"Model instance data",http:{source:"body"}},returns:{arg:"data",type:c,root:!0},http:{verb:"put",path:"/"}}),a(b,"exists",{description:"Check whether a model instance exists in the data source",accepts:{arg:"id",type:"any",description:"Model id",required:!0},returns:{arg:"exists",type:"boolean"},http:{verb:"get",path:"/:id/exists"}}),a(b,"findById",{description:"Find a model instance by id from the data source",accepts:{arg:"id",type:"any",description:"Model id",required:!0,http:{source:"path"}},returns:{arg:"data",type:c,root:!0},http:{verb:"get",path:"/:id"},rest:{after:d}}),a(b,"find",{description:"Find all instances of the model matched by filter from the data source",accepts:{arg:"filter",type:"object",description:"Filter defining fields, where, orderBy, offset, and limit"},returns:{arg:"data",type:[c],root:!0},http:{verb:"get",path:"/"}}),a(b,"findOne",{description:"Find first instance of the model matched by filter from the data source",accepts:{arg:"filter",type:"object",description:"Filter defining fields, where, orderBy, offset, and limit"},returns:{arg:"data",type:c,root:!0},http:{verb:"get",path:"/findOne"},rest:{after:d}}),a(b,"destroyAll",{description:"Delete all matching records",accepts:{arg:"where",type:"object",description:"filter.where object"},http:{verb:"del",path:"/"},shared:!1}),a(b,"updateAll",{description:"Update instances of the model matched by where from the data source",accepts:[{arg:"where",type:"object",http:{source:"query"},description:"Criteria to match model instances"},{arg:"data",type:"object",http:{source:"body"},description:"An object of model property name/value pairs"}],http:{verb:"post",path:"/update"}}),a(b,"removeById",{description:"Delete a model instance by id from the data source",accepts:{arg:"id",type:"any",description:"Model id",required:!0,http:{source:"path"}},http:{verb:"del",path:"/:id"}}),a(b,"count",{description:"Count instances of the model matched by where from the data source",accepts:{arg:"where",type:"object",description:"Criteria to match model instances"},returns:{arg:"count",type:"number"},http:{verb:"get",path:"/count"}}),a(b.prototype,"updateAttributes",{description:"Update attributes for a model instance and persist it into the data source",accepts:{arg:"data",type:"object",http:{source:"body"},description:"An object of model property name/value pairs"},returns:{arg:"data",type:c,root:!0},http:{verb:"put",path:"/"}}),e.trackChanges&&(a(b,"diff",{description:"Get a set of deltas and conflicts since the given checkpoint",accepts:[{arg:"since",type:"number",description:"Find deltas since this checkpoint"},{arg:"remoteChanges",type:"array",description:"an array of change objects",http:{source:"body"}}],returns:{arg:"result",type:"object",root:!0},http:{verb:"post",path:"/diff"}}),a(b,"changes",{description:"Get the changes to a model since a given checkpoint.Provide a filter object to reduce the number of results returned.",accepts:[{arg:"since",type:"number",description:"Only return changes since this checkpoint"},{arg:"filter",type:"object",description:"Only include changes that match this filter"}],returns:{arg:"changes",type:"array",root:!0},http:{verb:"get",path:"/changes"}}),a(b,"checkpoint",{description:"Create a checkpoint.",returns:{arg:"checkpoint",type:"object",root:!0},http:{verb:"post",path:"/checkpoint"}}),a(b,"currentCheckpoint",{description:"Get the current checkpoint.",returns:{arg:"checkpoint",type:"object",root:!0},http:{verb:"get",path:"/checkpoint"}}),a(b,"createUpdates",{description:"Create an update list from a delta list",accepts:{arg:"deltas",type:"array",http:{source:"body"}},returns:{arg:"updates",type:"array",root:!0},http:{verb:"post",path:"/create-updates"}}),a(b,"bulkUpdate",{description:"Run multiple updates at once. Note: this is not atomic.",accepts:{arg:"updates",type:"array"},http:{verb:"post",path:"/bulk-update"}}),a(b,"rectifyAllChanges",{description:"Rectify all Model changes.",http:{verb:"post",path:"/rectify-all"}}),a(b,"rectifyChange",{description:"Tell loopback that a change to the model with the given id has occurred.",accepts:{arg:"id",type:"any",http:{source:"path"}},http:{verb:"post",path:"/:id/rectify-change"}}))},j.diff=function(a,b,c){var d=this.getChangeModel();d.diff(this.modelName,a,b,c)},j.changes=function(a,b,c){"function"==typeof a&&(b={},c=a,a=-1),"function"==typeof b&&(c=b,a=-1,b={});var d=this.dataSource.idName(this.modelName),e=this.getChangeModel(),f=this;b=b||{},b.fields={},b.where=b.where||{},b.fields[d]=!0,e.find({checkpoint:{gt:a},modelName:this.modelName},function(a,g){if(a)return cb(a);var h=g.map(function(a){return a.getModelId()});b.where[d]={inq:h},f.find(b,function(a,b){if(a)return cb(a);var f=b.map(function(a){return a[d].toString()});c(null,g.filter(function(a){return a.type()===e.DELETE?!0:f.indexOf(a.modelId)>-1}))})})},j.checkpoint=function(a){var b=this.getChangeModel().getCheckpointModel();this.getSourceId(function(c,d){return c?a(c):void b.create({sourceId:d},a)})},j.currentCheckpoint=function(a){var b=this.getChangeModel().getCheckpointModel();b.current(a)},j.replicate=function(a,b,c,d){function e(b){o.changes(a,c.filter,b)}function f(c,d){b.diff(a,c,d)}function g(a,b){n=a,n.conflicts=n.conflicts||[],n&&n.deltas&&n.deltas.length?o.createUpdates(n.deltas,b):l()}function j(a,c){b.bulkUpdate(a,c)}function k(){var a=arguments[arguments.length-1];o.checkpoint(a)}function l(a){if(a)return d(a);var c=n.conflicts.map(function(a){return new p.Conflict(a.modelId,o,b)});c.length&&o.emit("conflicts",c),d&&d(null,c)}var m=arguments[arguments.length-1];"function"==typeof m&&arguments.length>1&&(d=m),"function"==typeof a&&a.modelName&&(b=a,a=-1),c=c||{};var n,o=this,p=this.getChangeModel(),q=b.getChangeModel(),r=p&&q;h(r,"You must enable change tracking before replicating"),d=d||function(a){if(a)throw a};var s=[e,f,g,j,k];i.waterfall(s,l)},j.createUpdates=function(a,b){var c=this.getChangeModel(),d=[],e=this,f=[];a.forEach(function(a){var a=new c(a),b=a.type(),g={type:b,change:a};switch(b){case c.CREATE:case c.UPDATE:f.push(function(b){e.findById(a.modelId,function(c,e){return c?b(c):e?(g.data=e.toObject?e.toObject():e,d.push(g),void b()):(console.error("missing data for change:",a),b&&b(new Error("missing data for change: "+a.modelId)))})});break;case c.DELETE:d.push(g)}}),i.parallel(f,function(a){return a?b(a):void b(null,d)})},j.bulkUpdate=function(a,b){var c=[],d=this,e=this.dataSource.idName(this.modelName),f=this.getChangeModel();a.forEach(function(a){switch(a.type){case f.UPDATE:case f.CREATE:c.push(function(b){var c=new d(a.data);c.save(b)});break;case f.DELETE:var b={};b[e]=a.change.modelId;var g=new d(b);c.push(g.destroy.bind(g))}}),i.parallel(c,b)},j.getChangeModel=function(){var a=this.Change,b=a&&a.dataSource;return h(b,"Cannot get a setup Change model"),a},j.getSourceId=function(a){var b=this.dataSource;b||this.once("dataSourceAttached",this.getSourceId.bind(this,a)),h(b.connector.name,"Model.getSourceId: cannot get id without dataSource.connector.name");var c=[b.connector.name,this.modelName].join("-");a(null,c)},j.enableChangeTracking=function(){function a(){b.rectifyAllChanges(function(a){a&&(console.error(b.modelName+" Change Cleanup Error:"),console.error(a))})}var b=this,c=this.Change||this._defineChangeModel(),d=b.settings.changeCleanupInterval||3e4;h(this.dataSource,"Cannot enableChangeTracking(): "+this.modelName+" is not attached to a dataSource"),c.attachTo(this.dataSource),c.getCheckpointModel().attachTo(this.dataSource),b.afterSave=function(a){b.rectifyChange(this.getId(),a)},b.afterDestroy=function(a){b.rectifyChange(this.getId(),a)},b.on("deletedAll",a),f.isServer&&(a(),setInterval(a,d))},j._defineChangeModel=function(){var b=a("./change");return this.Change=b.extend(this.modelName+"-change",{},{trackModel:this})},j.rectifyAllChanges=function(a){this.getChangeModel().rectifyAll(a)},j.handleChangeError=function(a){a&&(console.error(e.modelName+" Change Tracking Error:"),console.error(a))},j.rectifyChange=function(a,b){var c=this.getChangeModel();c.rectifyModelChanges(this.modelName,[a],b)},j.setup()},{"../runtime":111,"./change":103,"./model":106,assert:9,async:112,"strong-remoting":117}],108:[function(a,b){(function(c){function d(a){return a===f.User||a.prototype instanceof f.User}function e(a,b){return void 0===a||null===a||""===a||void 0===b||null===b||""===b?!1:a===b||a.toString()===b.toString()}var f=a("../loopback"),g=a("debug")("loopback:security:role"),h=a("assert"),i=a("async"),j=a("./access-context").AccessContext,k={id:{type:String,id:!0,generated:!0},name:{type:String,required:!0},description:String,created:{type:Date,"default":Date},modified:{type:Date,"default":Date}},l={id:{type:String,id:!0,generated:!0},principalType:String,principalId:String},m=f.createModel("RoleMapping",l,{relations:{role:{type:"belongsTo",model:"Role",foreignKey:"roleId"}}});m.USER="USER",m.APP=m.APPLICATION="APP",m.ROLE="ROLE",m.prototype.application=function(a){if(this.principalType===m.APPLICATION){var b=this.constructor.Application||f.getModelByType(f.Application);b.findById(this.principalId,a)}else c.nextTick(function(){a&&a(null,null)})},m.prototype.user=function(a){if(this.principalType===m.USER){var b=this.constructor.User||f.getModelByType(f.User);b.findById(this.principalId,a)}else c.nextTick(function(){a&&a(null,null)})},m.prototype.childRole=function(a){if(this.principalType===m.ROLE){var b=this.constructor.Role||f.getModelByType(n);b.findById(this.principalId,a)}else c.nextTick(function(){a&&a(null,null)})};var n=f.createModel("Role",k,{relations:{principals:{type:"hasMany",model:"RoleMapping",foreignKey:"roleId"}}});n.once("dataSourceAttached",function(){var a=this.RoleMapping||f.getModelByType(m);n.prototype.users=function(b){a.find({where:{roleId:this.id,principalType:m.USER}},function(a,c){return a?void(b&&b(a)):c.map(function(a){return a.principalId})})},n.prototype.applications=function(b){a.find({where:{roleId:this.id,principalType:m.APPLICATION}},function(a,c){return a?void(b&&b(a)):c.map(function(a){return a.principalId})})},n.prototype.roles=function(b){a.find({where:{roleId:this.id,principalType:m.ROLE}},function(a,c){return a?void(b&&b(a)):c.map(function(a){return a.principalId})})}}),n.OWNER="$owner",n.RELATED="$related",n.AUTHENTICATED="$authenticated",n.UNAUTHENTICATED="$unauthenticated",n.EVERYONE="$everyone",n.registerResolver=function(a,b){n.resolvers||(n.resolvers={}),n.resolvers[a]=b},n.registerResolver(n.OWNER,function(a,b,d){if(!b||!b.model||!b.modelId)return void c.nextTick(function(){d&&d(null,!1)});var e=b.model,f=b.modelId,g=b.getUserId();n.isOwner(e,f,g,d)}),n.isOwner=function(a,b,f,i){return h(a,"Model class is required"),g("isOwner(): %s %s userId: %s",a&&a.modelName,b,f),f?d(a)?void c.nextTick(function(){i(null,e(b,f))}):void a.findById(b,function(c,h){if(c||!h)return g("Model not found for id %j",b),void(i&&i(c,!1));g("Model found: %j",h);var j=h.userId||h.owner;if(j)return void(i&&i(null,e(j,f)));for(var k in a.relations){var l=a.relations[k];if("belongsTo"===l.type&&d(l.modelTo))return g("Checking relation %s to %s: %j",k,l.modelTo.modelName,l),void h[k](function(a,b){!a&&b?(g("User found: %j",b.id),i&&i(null,e(b.id,f))):i&&i(a,!1)})}g("No matching belongsTo relation found for model %j and user: %j",b,f),i&&i(null,!1)}):void c.nextTick(function(){i(null,!1)})},n.registerResolver(n.AUTHENTICATED,function(a,b,d){return b?void n.isAuthenticated(b,d):void c.nextTick(function(){d&&d(null,!1)})}),n.isAuthenticated=function(a,b){c.nextTick(function(){b&&b(null,a.isAuthenticated())})},n.registerResolver(n.UNAUTHENTICATED,function(a,b,d){c.nextTick(function(){d&&d(null,!b||!b.isAuthenticated())})}),n.registerResolver(n.EVERYONE,function(a,b,d){c.nextTick(function(){d&&d(null,!0)})}),n.isInRole=function(a,b,d){b instanceof j||(b=new j(b)),g("isInRole(): %s",a),b.debug();var e=n.resolvers[a];if(e)return g("Custom resolver found for role %s",a),void e(a,b,d);if(0===b.principals.length)return g("isInRole() returns: false"),void c.nextTick(function(){d&&d(null,!1)});var h=b.principals.some(function(b){var c=b.type||void 0,d=b.id||void 0;return c===m.ROLE&&d===a});if(h)return g("isInRole() returns: %j",h),void c.nextTick(function(){d&&d(null,!0)
});var k=this.RoleMapping||f.getModelByType(m);this.findOne({where:{name:a}},function(a,e){return a?void(d&&d(a)):e?(g("Role found: %j",e),void i.some(b.principals,function(a,b){var d=a.type||void 0,f=a.id||void 0,h=e.id.toString();null!==f&&void 0!==f&&"string"!=typeof f&&(f=f.toString()),d&&f?k.findOne({where:{roleId:h,principalType:d,principalId:f}},function(a,c){g("Role mapping found: %j",c),b(!a&&c)}):c.nextTick(function(){b(!1)})},function(a){g("isInRole() returns: %j",a),d&&d(null,a)})):void(d&&d(null,!1))})},n.getRoles=function(a,b){a instanceof j||(a=new j(a));var c=[],d=function(a){a&&-1===c.indexOf(a)&&c.push(a)},e=this,h=[];Object.keys(n.resolvers).forEach(function(b){h.push(function(c){e.isInRole(b,a,function(a,e){g.enabled&&g("In role %j: %j",b,e),!a&&e?(d(b),c()):c(a,null)})})});var k=this.RoleMapping||f.getModelByType(m);a.principals.forEach(function(a){var b=a.type||void 0,c=a.id||void 0;b===m.ROLE&&c&&d(c),b&&c&&h.push(function(a){k.find({where:{principalType:b,principalId:c}},function(b,c){return g("Role mappings found: %s %j",b,c),b?void(a&&a(b)):(c.forEach(function(a){d(a.roleId)}),void(a&&a()))})})}),i.parallel(h,function(a){g("getRoles() returns: %j %j",a,c),b&&b(a,c)})},b.exports={Role:n,RoleMapping:m}}).call(this,a("+xKvab"))},{"+xKvab":29,"../loopback":98,"./access-context":99,assert:9,async:112,debug:115}],109:[function(a,b){(function(c){var d=a("../loopback").PersistedModel,e=a("../loopback"),f=a("path"),g=10,h=a("crypto"),i=a("bcryptjs"),j=(a("./access-token"),1209600),k=900,l=31556926,m=a("./role").Role,n=a("./acl").ACL,o=a("assert"),p=a("debug")("loopback:user"),q={realm:{type:String},username:{type:String},password:{type:String,required:!0},email:{type:String,required:!0},emailVerified:Boolean,verificationToken:String,credentials:["UserCredential"],challenges:["Challenge"],status:String,created:Date,lastUpdated:Date},r={hidden:["password"],acls:[{principalType:n.ROLE,principalId:m.EVERYONE,permission:n.DENY},{principalType:n.ROLE,principalId:m.EVERYONE,permission:n.ALLOW,property:"create"},{principalType:n.ROLE,principalId:m.OWNER,permission:n.ALLOW,property:"removeById"},{principalType:n.ROLE,principalId:m.EVERYONE,permission:n.ALLOW,property:"login"},{principalType:n.ROLE,principalId:m.EVERYONE,permission:n.ALLOW,property:"logout"},{principalType:n.ROLE,principalId:m.OWNER,permission:n.ALLOW,property:"findById"},{principalType:n.ROLE,principalId:m.OWNER,permission:n.ALLOW,property:"updateAttributes"},{principalType:n.ROLE,principalId:m.EVERYONE,permission:n.ALLOW,property:"confirm"}],relations:{accessTokens:{type:"hasMany",model:"AccessToken",foreignKey:"userId"}}},s=b.exports=d.extend("User",q,r);s.prototype.createAccessToken=function(a,b){var c=this.constructor;a=Math.min(a||c.settings.ttl,c.settings.maxTTL),this.accessTokens.create({ttl:a},b)},s.login=function(a,b,c){var d=this;"function"==typeof b&&(c=b,b=void 0),b=(b||"").toLowerCase();var e={};if(a.email)e.email=a.email;else{if(!a.username){var f=new Error("username or email is required");return f.statusCode=400,c(f)}e.username=a.username}d.findOne({where:e},function(d,f){var g=new Error("login failed");g.statusCode=401,d?(p("An error is reported from User.findOne: %j",d),c(g)):f?f.hasPassword(a.password,function(d,h){d?(p("An error is reported from User.hasPassword: %j",d),c(g)):h?f.createAccessToken(a.ttl,function(a,d){return a?c(a):("user"===b&&(d.__data.user=f),void c(a,d))}):(p("The password is invalid for user %s",e.email||e.username),c(g))}):(p("No matching record is found for user %s",e.email||e.username),c(g))})},s.logout=function(a,b){this.relations.accessTokens.modelTo.findById(a,function(a,c){a?b(a):c?c.destroy(b):b(new Error("could not find accessToken"))})},s.prototype.hasPassword=function(a,b){this.password&&a?i.compare(a,this.password,function(a,c){return a?b(a):void b(null,c)}):b(null,!1)},s.prototype.verify=function(a,b){function d(c){a.verifyHref+="&token="+c.verificationToken,a.text=a.text||"Please verify your email by opening this link in a web browser:\n	{href}",a.text=a.text.replace("{href}",a.verifyHref);var d=e.template(a.template);i.send({to:a.to||c.email,from:a.from,subject:a.subject||"Thanks for Registering",text:a.text,html:d(a)},function(a,d){a?b(a):b(null,{email:d,token:c.verificationToken,uid:c.id})})}var g=this;o("object"==typeof a,"options required when calling user.verify()"),o(a.type,"You must supply a verification type (options.type)"),o("email"===a.type,"Unsupported verification type"),o(a.to||this.email,"Must include options.to when calling user.verify() or the user must have an email property"),o(a.from,"Must include options.from when calling user.verify() or the user must have an email property"),a.redirect=a.redirect||"/",a.template=f.resolve(a.template||f.join(c,"..","..","templates","verify.ejs")),a.user=this,a.protocol=a.protocol||"http",a.host=a.host||"localhost",a.verifyHref=a.verifyHref||a.protocol+"://"+a.host+s.http.path+s.confirm.http.path+"?uid="+a.user.id+"&redirect="+a.redirect;var i=a.mailer||this.constructor.email||e.getModelByType(e.Email);h.randomBytes(64,function(a,c){a?b(a):(g.verificationToken=c.toString("hex"),g.save(function(a){a?b(a):d(g)}))})},s.confirm=function(a,b,c,d){this.findById(a,function(a,c){a?d(a):c.verificationToken===b?(c.verificationToken=void 0,c.emailVerified=!0,c.save(function(a){a?d(a):d()})):d(new Error("invalid token"))})},s.resetPassword=function(a,b){var c=this,d=c.settings.resetPasswordTokenTTL||k;if(a=a||{},"string"==typeof a.email)c.findOne({where:{email:a.email}},function(e,f){e?b(e):f?f.accessTokens.create({ttl:d},function(d,e){d?b(d):(b(),c.emit("resetPasswordRequest",{email:a.email,accessToken:e,user:f}))}):b()});else{var e=new Error("email is required");e.statusCode=400,b(e)}},s.setup=function(){d.setup.call(this);var b=this;this.settings.maxTTL=this.settings.maxTTL||l,this.settings.ttl=j,b.setter.password=function(a){var b=i.genSaltSync(this.constructor.settings.saltWorkFactor||g);this.$password=i.hashSync(a,b)},e.remoteMethod(b.login,{accepts:[{arg:"credentials",type:"object",required:!0,http:{source:"body"}},{arg:"include",type:"string",http:{source:"query"},description:"Related objects to include in the response. See the description of return value for more details."}],returns:{arg:"accessToken",type:"object",root:!0,description:"The response body contains properties of the AccessToken created on login.\nDepending on the value of `include` parameter, the body may contain additional properties:\n\n  - `user` - `{User}` - Data of the currently logged in user. (`include=user`)\n\n"},http:{verb:"post"}}),e.remoteMethod(b.logout,{accepts:[{arg:"access_token",type:"string",required:!0,http:function(a){var b=a&&a.req,c=b&&b.accessToken,d=c&&c.id;return d},description:"Do not supply this argument, it is automatically extracted from request headers."}],http:{verb:"all"}}),e.remoteMethod(b.confirm,{accepts:[{arg:"uid",type:"string",required:!0},{arg:"token",type:"string",required:!0},{arg:"redirect",type:"string",required:!0}],http:{verb:"get",path:"/confirm"}}),e.remoteMethod(b.resetPassword,{accepts:[{arg:"options",type:"object",required:!0,http:{source:"body"}}],http:{verb:"post",path:"/reset"}}),b.on("attached",function(){b.afterRemote("confirm",function(a){a.req?a.res.redirect(a.req.param("redirect")):fn(new Error("transport unsupported"))})}),b.email=a("./email"),b.accessToken=a("./access-token"),b.validatesUniquenessOf("email",{message:"Email already exists"});var c=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.validatesFormatOf("email",{"with":c,message:"Must provide a valid email"}),b},s.setup()}).call(this,"/../node_modules/loopback/lib/models")},{"../loopback":98,"./access-token":100,"./acl":101,"./email":105,"./role":108,assert:9,bcryptjs:113,crypto:17,debug:115,path:28}],110:[function(a,b){function c(a){var b=e({},a.options);for(var c in a)-1===["name","properties","options"].indexOf(c)&&void 0===b[c]&&(b[c]=a[c]);return b}var d=a("assert"),e=a("util")._extend,f=a("loopback-datasource-juggler").DataSource,g=b.exports;g.defaultDataSources={},g.createModel=function(a,b,e){if(1===arguments.length&&"object"==typeof a){var f=a;a=f.name,b=f.properties,e=c(f),d("string"==typeof a,"The model-config property `name` must be a string")}e=e||{};var g=e.base||e.super;if("string"==typeof g){var h=g;g=this.getModel(g),void 0===g&&("DataModel"===h?(console.warn("Model `%s` is extending deprecated `DataModel. Use `PeristedModel` instead.",a),g=this.PersistedModel):console.warn("Model `%s` is extending an unknown model `%s`. Using `PersistedModel` as the base.",a,h))}g=g||this.PersistedModel;var i=g.extend(a,b,e);try{this.autoAttachModel(i)}catch(j){}return i},g.configureModel=function(a,b){var c=a.settings;if(b.relations){var g=c.relations=c.relations||{};Object.keys(b.relations).forEach(function(a){g[a]=e(g[a]||{},b.relations[a])})}b.dataSource&&(d(b.dataSource instanceof f,"Cannot configure "+a.modelName+": config.dataSource must be an instance of DataSource"),a.attachTo(b.dataSource))},g.findModel=function(a){return this.Model.modelBuilder.models[a]},g.getModel=function(a){var b=this.findModel(a);if(b)return b;throw new Error("Model not found: "+a)},g.getModelByType=function(a){d("function"==typeof a,"The model type must be a constructor");var b=this.Model.modelBuilder.models;for(var c in b)if(b[c].prototype instanceof a)return b[c];return a},g.createDataSource=function(a,b){var c=this,d=new f(a,b,c.Model.modelBuilder);return d.createModel=function(a,b,e){var f=c.createModel(a,b,e);return f.attachTo(d),f},d.settings&&d.settings.defaultForType&&this.setDefaultDataSourceForType(d.settings.defaultForType,d),d},g.memory=function(a){a=a||"default";var b=(this._memoryDataSources||(this._memoryDataSources={}))[a];return b||(b=this._memoryDataSources[a]=this.createDataSource({connector:loopback.Memory})),b},g.setDefaultDataSourceForType=function(a,b){var c=this.defaultDataSources;return b instanceof f||(b=this.createDataSource(b)),c[a]=b,b},g.getDefaultDataSourceForType=function(a){return this.defaultDataSources&&this.defaultDataSources[a]},g.autoAttach=function(){var a=this.Model.modelBuilder.models;d.equal(typeof a,"object","Cannot autoAttach without a models object"),Object.keys(a).forEach(function(b){var c=a[b];!c||c.dataSource instanceof f||this.autoAttachModel(c)},this)},g.autoAttachModel=function(a){if(a.autoAttach){var b=this.getDefaultDataSourceForType(a.autoAttach);d(b instanceof f,'cannot autoAttach model "'+a.modelName+'". No dataSource found of type '+a.autoAttach),a.attachTo(b)}},g.DataSource=f,g.Model=a("./models/model"),g.PersistedModel=a("./models/persisted-model"),Object.defineProperty(g,"DataModel",{get:function(){var a=(new Error).stack.split("\n");return console.warn("loopback.DataModel is deprecated, use loopback.PersistedModel instead."),console.warn(a[2]),this.PersistedModel}})},{"./models/model":106,"./models/persisted-model":107,assert:9,"loopback-datasource-juggler":61,util:50}],111:[function(a,b,c){var d=c;d.isBrowser="undefined"!=typeof window,d.isServer=!d.isBrowser},{}],112:[function(a,b){b.exports=a(80)},{"+xKvab":29}],113:[function(a,b){(function(c){function d(a){throw a}var e=null;!function(f){function g(a,b,c,d){for(var e,f=a[b],g=a[b+1],f=f^c[0],h=0;14>=h;)e=d[f>>24&255],e+=d[256|f>>16&255],e^=d[512|f>>8&255],e+=d[768|255&f],g^=e^c[++h],e=d[g>>24&255],e+=d[256|g>>16&255],e^=d[512|g>>8&255],e+=d[768|255&g],f^=e^c[++h];return a[b]=g^c[17],a[b+1]=f,a}function h(a,b){var c,d=0;for(c=0;4>c;c++)d=d<<8|255&a[b],b=(b+1)%a.length;return{key:d,a:b}}function i(a,b,c){for(var d=0,e=[0,0],f=b.length,i=c.length,j=0;f>j;j++){var k=h(a,d),d=k.a;b[j]^=k.key}for(j=0;f>j;j+=2)e=g(e,0,b,c),b[j]=e[0],b[j+1]=e[1];for(j=0;i>j;j+=2)e=g(e,0,b,c),c[j]=e[0],c[j+1]=e[1]}function j(a,b,c,d){for(var e,f=0,i=[0,0],j=c.length,k=d.length,l=0;j>l;l++)e=h(b,f),f=e.a,c[l]^=e.key;for(l=f=0;j>l;l+=2)e=h(a,f),f=e.a,i[0]^=e.key,e=h(a,f),f=e.a,i[1]^=e.key,i=g(i,0,c,d),c[l]=i[0],c[l+1]=i[1];for(l=0;k>l;l+=2)e=h(a,f),f=e.a,i[0]^=e.key,e=h(a,f),f=e.a,i[1]^=e.key,i=g(i,0,c,d),d[l]=i[0],d[l+1]=i[1]}function k(a){"undefined"!=typeof c&&"function"==typeof c.nextTick?"function"==typeof setImmediate?setImmediate(a):c.nextTick(a):setTimeout(a,0)}function l(a,b,c,f){function h(){if(!(c>q)){for(q=0;64>q;q++)for(p=0;m>>1>p;p++)g(l,p<<1,n,o);for(d=[],q=0;m>q;q++)d.push((l[q]>>24&255)>>>0),d.push((l[q]>>16&255)>>>0),d.push((l[q]>>8&255)>>>0),d.push((255&l[q])>>>0);return f?(f(e,d),e):d}for(var d=new Date;c>q&&(q+=1,i(a,n,o),i(b,n,o),!(100<Date.now()-d)););return f&&k(h),e}var l=v.slice(),m=l.length;(4>c||c>31)&&d(Error("Illegal number of rounds: "+c)),16!=b.length&&d(Error("Illegal salt length: "+b.length+" != 16")),c=1<<c;var n=t.slice(),o=u.slice();j(b,a,n,o);var p,q=0;if("undefined"!=typeof f)return h(),e;for(var r;;)if((r=h())!==e)return r}function m(a){for(var b,c,d=[],e=0;e<a.length;e++){b=a.charCodeAt(e),c=[];do c.push(255&b),b>>=8;while(b);d=d.concat(c.reverse())}return d}function n(a,b,c){function f(a){var b=[];return b.push("$2"),g>="a"&&b.push(g),b.push("$"),10>i&&b.push("0"),b.push(i.toString()),b.push("$"),b.push(r.b(j,j.length)),b.push(r.b(a,4*v.length-1)),b.join("")}var g,h;("$"!=b.charAt(0)||"2"!=b.charAt(1))&&d(Error("Invalid salt version: "+b.substring(0,2))),"$"==b.charAt(2)?(g=String.fromCharCode(0),h=3):(g=b.charAt(2),("a"!=g||"$"!=b.charAt(3))&&d(Error("Invalid salt revision: "+b.substring(2,4))),h=4),"$"<b.charAt(h+2)&&d(Error("Missing salt rounds"));var i=10*parseInt(b.substring(h,h+1),10)+parseInt(b.substring(h+1,h+2),10);b=b.substring(h+3,h+25),a=m(a+(g>="a"?"\x00":""));var j=[],j=r.c(b,16);return"undefined"==typeof c?f(l(a,j,i)):(l(a,j,i,function(a,b){a?c(a,e):c(e,f(b))}),e)}function o(){if("undefined"!=typeof b&&b.exports)return a("crypto").randomBytes(16);var c=new Uint32Array(16);return f.crypto&&"function"==typeof f.crypto.getRandomValues?f.crypto.getRandomValues(c):"function"==typeof w?w(c):d(Error("Failed to generate random values: Web Crypto API not available / no polyfill set")),Array.prototype.slice.call(c)}var p="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),q=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1],r={b:function(a,b){var c,e,f=0,g=[];for((0>=b||b>a.length)&&d(Error("Invalid 'len': "+b));b>f;){if(c=255&a[f++],g.push(p[c>>2&63]),c=(3&c)<<4,f>=b){g.push(p[63&c]);break}if(e=255&a[f++],c|=e>>4&15,g.push(p[63&c]),c=(15&e)<<2,f>=b){g.push(p[63&c]);break}e=255&a[f++],c|=e>>6&3,g.push(p[63&c]),g.push(p[63&e])}return g.join("")},c:function(a,b){var c,e,f,g=0,h=a.length,i=0,j=[];for(0>=b&&d(Error("Illegal 'len': "+b));h-1>g&&b>i&&(f=a.charCodeAt(g++),c=f<q.length?q[f]:-1,f=a.charCodeAt(g++),e=f<q.length?q[f]:-1,-1!=c&&-1!=e)&&(f=c<<2>>>0,f|=(48&e)>>4,j.push(String.fromCharCode(f)),!(++i>=b||g>=h))&&(f=a.charCodeAt(g++),c=f<q.length?q[f]:-1,-1!=c)&&(f=(15&e)<<4>>>0,f|=(60&c)>>2,j.push(String.fromCharCode(f)),!(++i>=b||g>=h));)f=a.charCodeAt(g++),e=f<q.length?q[f]:-1,f=(3&c)<<6>>>0,f|=e,j.push(String.fromCharCode(f)),++i;for(h=[],g=0;i>g;g++)h.push(j[g].charCodeAt(0));return h}},s={},t=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],u=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],v=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892],w=e;s.setRandomPolyfill=function(a){w=a},s.genSaltSync=function(a){a||(a=10);var b;a=a||10,(4>a||a>31)&&d(Error("Illegal number of rounds: "+a));var c=[];c.push("$2a$"),10>a&&c.push("0"),c.push(a.toString()),c.push("$");try{c.push(r.b(o(),16)),b=c.join("")}catch(e){d(e)}return b},s.genSalt=function(a,b,c){"function"==typeof b&&(c=b,b=-1);var f;"function"==typeof a?(c=a,f=10):f=parseInt(a,10),"function"!=typeof c&&d(Error("Illegal or missing 'callback': "+c)),k(function(){try{var a=s.genSaltSync(f);c(e,a)}catch(b){c(b,e)}})},s.hashSync=function(a,b){return b||(b=10),"number"==typeof b&&(b=s.genSaltSync(b)),n(a,b)},s.hash=function(a,b,c){"function"!=typeof c&&d(Error("Illegal 'callback': "+c)),"number"==typeof b?s.genSalt(b,function(b,d){n(a,d,c)}):n(a,b,c)},s.compareSync=function(a,b){("string"!=typeof a||"string"!=typeof b)&&d(Error("Illegal argument types: "+typeof a+", "+typeof b)),60!=b.length&&d(Error("Illegal hash length: "+b.length+" != 60"));for(var c=s.hashSync(a,b.substr(0,b.length-31)),e=c.length==b.length,f=c.length<b.length?c.length:b.length,g=0;f>g;++g)c.length>=g&&b.length>=g&&c[g]!=b[g]&&(e=!1);return e},s.compare=function(a,b,c){"function"!=typeof c&&d(Error("Illegal 'callback': "+c)),s.hash(a,b.substr(0,29),function(a,d){c(a,b===d)})},s.getRounds=function(a){return"string"!=typeof a&&d(Error("Illegal type of 'hash': "+typeof a)),parseInt(a.split("$")[2],10)},s.getSalt=function(a){return"string"!=typeof a&&d(Error("Illegal type of 'hash': "+typeof a)),60!=a.length&&d(Error("Illegal hash length: "+a.length+" != 60")),a.substring(0,29)},"undefined"!=typeof b&&b.exports?b.exports=s:"undefined"!=typeof define&&define.amd?define("bcrypt",function(){return s}):(f.dcodeIO||(f.dcodeIO={}),f.dcodeIO.bcrypt=s)}(this)}).call(this,a("+xKvab"))},{"+xKvab":29,crypto:17}],114:[function(a,b){function c(a){return h.lastIndex=0,h.test(a)?'"'+a.replace(h,function(a){var b=i[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function d(a,b){var h,i,j,k,l,m=e,n=b[a];switch(n&&"object"==typeof n&&"function"==typeof n.toJSON&&(n=n.toJSON(a)),"function"==typeof g&&(n=g.call(b,a,n)),typeof n){case"string":return c(n);case"number":return isFinite(n)?String(n):"null";case"boolean":case"null":return String(n);case"object":if(!n)return"null";if(e+=f,l=[],"[object Array]"===Object.prototype.toString.apply(n)){for(k=n.length,h=0;k>h;h+=1)l[h]=d(h,n)||"null";return j=0===l.length?"[]":e?"[\n"+e+l.join(",\n"+e)+"\n"+m+"]":"["+l.join(",")+"]",e=m,j}if(g&&"object"==typeof g)for(k=g.length,h=0;k>h;h+=1)"string"==typeof g[h]&&(i=g[h],j=d(i,n),j&&l.push(c(i)+(e?": ":":")+j));else{var o=Object.keys(n).sort();for(h in o)i=o[h],Object.prototype.hasOwnProperty.call(n,i)&&(j=d(i,n),j&&l.push(c(i)+(e?": ":":")+j))}return j=0===l.length?"{}":e?"{\n"+e+l.join(",\n"+e)+"\n"+m+"}":"{"+l.join(",")+"}",e=m,j}}var e,f,g,h=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j=function(a,b,c){var h;if(e="",f="","number"==typeof c)for(h=0;c>h;h+=1)f+=" ";else"string"==typeof c&&(f=c);if(g=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return d("",{"":a})};b.exports=j},{}],115:[function(a,b){b.exports=a(56)},{}],116:[function(a,b){function c(a,b,c){function f(a){a(null,s)}var g=b||{},h=g.name||"swagger",i=g.version,l=g.basePath,m=a.handler("rest").adapter,n=m.allRoutes(),o=a.classes(),p={},q=j.extend(p),r={},s={apiVersion:i,swaggerVersion:"1.1",basePath:l,apis:[]};return o.forEach(function(b){function e(a){a(null,r[b.name])}s.apis.push({path:"/"+h+b.http.path,description:b.ctor.sharedCtor&&b.ctor.sharedCtor.description}),r[b.name]={apiVersion:s.apiVersion,swaggerVersion:s.swaggerVersion,basePath:s.basePath,apis:[],models:c},q.method(e,{path:b.name,http:{path:b.http.path},returns:{type:"object",root:!0}}),d(a,h+"."+b.name,r[b.name])}),n.forEach(function(a){var b,c=a.method.split("."),d=r[c[0]];return d?(b=o.filter(function(a){return a.name===c[0]})[0],b&&b.sharedCtor&&b.sharedCtor.accepts&&c.length>2&&(a.accepts=(a.accepts||[]).concat(b.sharedCtor.accepts)),k("route %j",a),void d.apis.push(e(a))):void console.error("Route exists with no class: %j",a)}),q.method(f,{returns:[{type:"object",root:!0}]}),d(a,h+".resources",s),a.exports[h]=p,p}function d(a,b,c){function d(){return g}function e(a){return Object.defineProperty(a,"basePath",{configurable:!1,enumerable:!0,get:d})}var f=c.basePath||"/",g=String(c.basePath)||"";return/^https?:\/\//.test(g)||a.before(b,function(a,b){var c=a.req.headers,d=c.Host||c.host;g=a.req.protocol+"://"+d+f,b()}),e(c)}function e(a){var b=a.returns&&a.returns[0];return{path:f(a.path),operations:[{httpMethod:g(a.verb),nickname:a.method.replace(/\./g,"_"),responseClass:b?b.model||i(b.type):"void",parameters:a.accepts?a.accepts.map(h(a)):[],errorResponses:[],summary:a.description,notes:""}]}}function f(a){return a.split("/").map(function(a){return":"===a.charAt(0)?"{"+a.slice(1)+"}":a}).join("/")}function g(a){return"all"===a.toLowerCase()?"POST":"del"===a.toLowerCase()?"DELETE":a.toUpperCase()
}function h(a){var b="form";return"get"===a.verb.toLowerCase()&&(b="query"),function(c){var d=c.name||c.arg,e=b;return-1!==a.path.indexOf(":"+d)&&(e="path"),c.http&&c.http.source&&(e=c.http.source),{paramType:e||b,name:d,description:c.description,dataType:c.model||i(c.type),required:!!c.required,allowMultiple:!1}}}function i(a){if(!a)return"void";if(Array.isArray(a))return"array";switch(a){case"buffer":return"byte";case"date":return"Date";case"number":return"double"}return a}b.exports=c;var j=a("../"),k=a("debug")("strong-remoting:swagger")},{"../":117,debug:115}],117:[function(a,b){b.exports=a("./lib/remote-objects"),b.exports.SharedClass=a("./lib/shared-class")},{"./lib/remote-objects":122,"./lib/shared-class":124}],118:[function(a,b){function c(a,b){this.val=a,this.ctx=b}b.exports=c;var d=(a("debug")("strong-remoting:dynamic"),a("assert"));c.converters=[],c.define=function(a,b){b.typeName=a,this.converters.unshift(b)},c.canConvert=function(a){return!!this.getConverter(a)},c.getConverter=function(a){for(var b,c=this.converters,d=0;d<c.length;d++)if(b=c[d],b.typeName===a)return b},c.prototype.to=function(a){var b=this.constructor.getConverter(a);return d(b,"No Type converter defined for "+a),b(this.val,this.ctx)},c.define("boolean",function(a){switch(typeof a){case"string":switch(a){case"false":case"undefined":case"null":case"0":case"":return!1;default:return!0}break;case"number":return 0!==a;default:return Boolean(a)}}),c.define("number",function(a){return 0===a?a:a?Number(a):a})},{assert:9,debug:115}],119:[function(a,b){function c(a){return this instanceof c?void(this._obj=a):new c(a)}function d(a,b){var c=this,d=c._obj,e=a.split("."),f=e.pop();return e.forEach(function(a){d[a]||(d[a]={}),d=d[a]}),g("Setting %s to %s",a,b),d[f]=b,c}function e(a,b){var d=this,e=b.path||b.name||a.name||null,f=b.sharedCtor||null,g=b.accepts||null;return e?(f||(f=function(){var b=[].slice.call(arguments);b.pop()(null,a.apply(null,b))}),f.accepts||(f.accepts=g),f.returns||(f.returns={type:"object",root:!0}),h.forEach(function(a){b[a]&&(f[a]=b[a])}),d.setPath(e,a),a.shared=!0,a.sharedCtor=f,new c(a.prototype)):d}function f(a,b){var c=this,d=b.path||b.name||a.name||null,e=b.accepts||null,f=b.returns||null;return d?(c.setPath(d,a),a.shared=!0,a.accepts=e,a.returns=f,h.forEach(function(c){b[c]&&(a[c]=b[c])}),c):c}b.exports=c;var g=a("debug")("strong-remoting:exports-helper"),h=["http","description"];c.prototype.setPath=d,c.prototype.addType=e,c.prototype.type=e,c.prototype.addMethod=f,c.prototype.method=f},{debug:115}],120:[function(a,b){function c(a,b,c){this.req=a,this.res=b,this.method=c,this.args=this.buildArgs(c),this.methodString=c.stringName}function d(a){return"string"!=typeof a?a:"null"==a?null:"true"==a?!0:"false"==a?!1:l.test(a)?parseFloat(a,10):k.test(a)?parseInt(a,10):a}function e(a){var b=Array.isArray(a)?"array":typeof a;switch(b){case"string":return d(a);case"object":a&&Object.keys(a).forEach(function(b){a[b]=e(a[b])});break;case"array":a.map(function(a){return e(a)})}return a}b.exports=c;var f=a("events").EventEmitter,g=(a("debug")("strong-remoting:http-context"),a("util")),h=g.inherits,i=(a("assert"),a("./dynamic")),j=["json","application/javascript","text/javascript"];h(c,f),c.prototype.buildArgs=function(a){{var b={},c=this,d=a.accepts;a.returns}return d.forEach(function(a){var d,e=a.http,f=a.name||a.arg;if(e)switch(typeof e){case"function":d=e(this);break;case"object":switch(e.source){case"body":d=this.req.body;break;case"form":d=this.req.body&&this.req.body[f];break;case"query":d=this.req.query[f];break;case"path":d=this.req.params[f];break;case"req":d=this.req;break;case"res":d=this.res;break;case"context":d=this}}else d=this.getArgByName(f,a);var g,h=a.type&&a.type.toLowerCase();i.canConvert(h)&&(g=new i(d,c),d=g.to(h)),b[a.arg]=d}.bind(this)),b},c.prototype.getArgByName=function(a){var b=this.req,c=b.param("args");c&&(c=JSON.parse(c)),"object"==typeof c&&c||(c={});var d=c&&c[a]||this.req.param(a);return"object"==typeof d&&(d=e(d)),d};var k=/^[0-9]+$/,l=/^([0-9]+)?\.[0-9]+$/;c.prototype.invoke=function(a,b,c,d){var e=this.args;if(d)try{e=this.buildArgs(b)}catch(f){return c(f)}var g=b.http,h=g&&g.pipe,i=h&&h.dest,j=h&&h.source;if(i)switch(i){case"res":this.res.header("Content-Type","application/json"),this.res.header("Transfer-Encoding","chunked");var k=b.invoke(a,e,c);k.pipe(this.res);break;default:c(new Error("unsupported pipe destination"))}else if(j)switch(i){case"req":this.req.pipe(b.invoke(a,e,c));break;default:c(new Error("unsupported pipe source"))}else b.invoke(a,e,c)},c.prototype.done=function(){var a=this.result,b=this.res,c=this.req.accepts(j),d="undefined"!=typeof a;if(d)switch(c){case"json":b.json(a);break;case"application/javascript":case"text/javascript":b.jsonp(a);break;default:b.send(406)}else b.header("Content-Type","application/json"),b.statusCode=204,b.end()}},{"./dynamic":118,assert:9,debug:115,events:22,util:50}],121:[function(a,b){function c(a,b,d){this.base=d,this.method=a,this.args=b||[];var e,f=this.namedArgs={};a.accepts.forEach(function(a){e=b.shift(),c.isAcceptable(e,a)&&(f[a.arg||a.name]=e)})}b.exports=c;var d=a("events").EventEmitter,e=(a("debug")("strong-remoting:http-invocation"),a("util")),f=e.inherits,g=(a("path"),a("assert"),a("request")),h=a("./dynamic"),i=a("qs");f(c,d),c.isAcceptable=function(a,b){var c=Array.isArray(b.type)||"array"===b.type.toLowerCase(),d=c?"array":b.type&&b.type.toLowerCase(),e=d&&"any"!==d;return c?Array.isArray(a):e?(typeof a).toLowerCase()===d:!0},c.prototype.createRequest=function(){{var a,b=this.method,c=b.getHttpMethod(),d={json:!0,method:c||"GET"},e=b.accepts;b.returns}return d.url=this.base+b.getFullPath(),e.forEach(function(b){var e=b.http,f=b.name||b.arg,g=this.getArgByName(f);if(e)switch(typeof e){case"function":break;case"object":switch(e.source){case"body":d.body=g;break;case"form":d.body=d.body||{},d.body[f]=g;break;case"query":void 0!==g&&(a=a||{},a[f]=g);break;case"path":d.url=d.url.replace(":"+f,g)}}else"get"===c.toLowerCase()?void 0!==g&&(a=a||{},a[f]=g):(d.body=d.body||{},d.body[f]=g)}.bind(this)),a&&(d.url+="?"+i.stringify(a)),d},c.prototype.getArgByName=function(a){return this.namedArgs[a]},c.prototype.invoke=function(a){var b=this.createRequest();g(b,function(b,c,d){return b instanceof SyntaxError&&204===c.status&&(b=null),b?a(b):void this.transformResponse(c,d,a)}.bind(this))},c.prototype.transformResponse=function(a,b,c){var d,e=[null],f=this.method,g=f.returns,i="object"==typeof b,j=a.statusCode>=400,k={method:f,req:a.req,res:a};return j?(i&&b.error?(d=new Error(b.error.message),d.name=b.error.name,d.stack=b.error.stack,d.details=b.error.details):d=new Error("Error: "+a.statusCode),c(d)):(g.forEach(function(b){var c,d,f=(b.http,b.name||b.arg),g=b.type;c=b.root?a.body:a.body[f],h.canConvert(g)&&(d=new h(c,k),c=d.to(g)),e.push(c)}.bind(this)),void c.apply(this,e))}},{"./dynamic":118,assert:9,debug:115,events:22,path:28,qs:129,request:126,util:50}],122:[function(a,b){function c(a){e.call(this,{wildcard:!0}),this.setMaxListeners(16),this.options=a||{},this.exports=this.options.exports||{},this._classes={}}function d(a,b,c,e){if(!c)return[];var f,g,h,i,j,k,l,m=[],n=b.length,o=b[e],p=b[e+1];if(e===n&&c._listeners){if("function"==typeof c._listeners)return a&&a.push(c._listeners),[c];for(f=0,g=c._listeners.length;g>f;f++)a&&a.push(c._listeners[f]);return[c]}if("*"===o||"**"===o||c[o]){if("*"===o){for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&(m=m.concat(d(a,b,c[h],e+1)));return m}if("**"===o){l=e+1===n||e+2===n&&"*"===p,l&&c._listeners&&(m=m.concat(d(a,b,c,n)));for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&("*"===h||"**"===h?(c[h]._listeners&&!l&&(m=m.concat(d(a,b,c[h],n))),m=m.concat(d(a,b,c[h],e))):m=m.concat(h===p?d(a,b,c[h],e+2):d(a,b,c[h],e)));return m}m=m.concat(d(a,b,c[o],e+1))}if(i=c["*"],i&&d(a,b,i,e+1),j=c["**"])if(n>e){j._listeners&&d(a,b,j,n);for(h in j)"_listeners"!==h&&j.hasOwnProperty(h)&&(h===p?d(a,b,j[h],e+2):h===o?d(a,b,j[h],e+1):(k={},k[h]=j[h],d(a,b,{"**":k},e+1)))}else j._listeners?d(a,b,j,n):j["*"]&&j["*"]._listeners&&d(a,b,j["*"],n);return m}b.exports=c;var e=a("eventemitter2").EventEmitter2,f=(a("debug")("strong-remoting:remotes"),a("util")),g=f.inherits,h=a("assert"),i=a("./dynamic"),j=a("./shared-class"),k=a("./exports-helper");a("./rest-adapter"),g(c,e),c.create=function(a){return new c(a)},c.extend=function(a){return new k(a)},c.prototype.handler=function(a,b){var c=this.adapter(a),d=new c(this,b),e=d.createHandler();return e&&(e.adapter=d),e},c.prototype.connect=function(a,b){var c=this.adapter(b),d=new c(this);return this.serverAdapter=d,d.connect(a)},c.prototype.invoke=function(a,b,c,d){return h(this.serverAdapter,"Cannot invoke method without an adapter. See RemoteObjects#connect()."),this.serverAdapter.invoke.apply(this.serverAdapter,arguments,d)},c.prototype.adapter=function(b){return a("./"+b+"-adapter")},c.prototype.classes=function(){var a=this.exports,b=[],c=this._classes;return Object.keys(a).forEach(function(c){b.push(new j(c,a[c]))}),Object.keys(c).forEach(function(a){b.push(c[a])}),b},c.prototype.addClass=function(a){h(a instanceof j),this._classes[a.name]=a},c.prototype.findMethod=function(a){for(var b=this.methods(),c=0;c<b.length;c++)if(b[c].stringName===a)return b[c]},c.prototype.methods=function(){var a=[];return this.classes().forEach(function(b){a=b.methods().concat(a)}),a},c.prototype.toJSON=function(){var a={},b=this.methods();return b.forEach(function(b){a[b.stringName]={http:b.fn&&b.fn.http,accepts:b.accepts,returns:b.returns}}),a},c.prototype.before=function(a,b){this.on("before."+a,b)},c.prototype.after=function(a,b){this.on("after."+a,b)},c.prototype.execHooks=function(a,b,c,e,f){function g(a){i.push(a)}function h(a){if(a)return f(a);var d=i.shift();d?d.call(c,e,h,b):f()}var i=[],j=a+"."+b.sharedClass.name+(b.isStatic?".":".prototype.")+b.name;this._events||init.call(this);var k;if(this.objectName=b.sharedClass.name,this.methodName=b.name,this.wildcard){k=[];var l="string"==typeof j?j.split(this.delimiter):j.slice();d.call(this,k,l,this.listenerTree,0)}else k=this._events[j];if("function"==typeof k)return this.event=j,g(k),h();if(k){for(var m=arguments.length,n=new Array(m-1),o=1;m>o;o++)n[o-1]=arguments[o];for(var p=k.slice(),o=0,m=p.length;m>o;o++)g(p[o])}return h()},c.prototype.invokeMethodInContext=function(a,b,c){var d=this,e=this.getScope(a,b);d.execHooks("before",b,e,a,function(f){return f?c(f):void a.invoke(e,b,function(f,g){return f?c(f):(a.result=g,void d.execHooks("after",b,e,a,function(a){return a?c(a):void c()}))})})},c.prototype.getScope=function(a,b){return a.instance||b.ctor},c.defineType=c.convert=c.prototype.defineType=c.prototype.convert=function(a,b){i.define(a,b)}},{"./dynamic":118,"./exports-helper":119,"./rest-adapter":123,"./shared-class":124,assert:9,debug:115,eventemitter2:128,util:50}],123:[function(a,b){function c(a){k.call(this),this.remotes=a,this.Context=u}function d(a){var b=a.http;return b&&!Array.isArray(b)&&(b=[b]),b?b.forEach(function(b){b.verb=String(b.verb||"all").toLowerCase(),b.path=b.path||"/"+a.name}):b="sharedCtor"===a.name?[{verb:"all",path:"/prototype"}]:[{verb:"all",path:a.name?"/"+a.name:""}],b}function e(a,b){var c=a.route,d=b.route,e=c.verb.toLowerCase(),f=d.verb.toLowerCase();if("del"===e&&(e="delete"),"del"===f&&(f="delete"),e>f)return-1;if(f>e)return 1;for(var g=c.path.split("/"),h=d.path.split("/"),i=Math.min(g.length,h.length),j=0;i>j;j++){if(""===g[j]&&""!==h[j])return 1;if(""!==g[j]&&""===h[j])return-1;if(":"===g[j][0]&&":"!==h[j][0])return 1;if(":"!==g[j][0]&&":"===h[j][0])return-1;if(g[j]>h[j])return 1;if(g[j]<h[j])return-1}return h.length-g.length}function f(a){i(this,"sharedClass",a),this.name=a.name,this.routes=d(a),this.ctor=a.sharedCtor&&new g(this,a.sharedCtor),this.methods=a.methods().filter(function(a){return!a.isSharedCtor}).map(function(a){return new g(this,a)}.bind(this))}function g(a,b){i(this,"restClass",a),i(this,"sharedMethod",b),this.fullName=b.stringName,this.name=this.fullName.split(".").slice(1).join("."),this.accepts=b.accepts,this.returns=b.returns,this.description=b.description;var c=d(b);if(b.isStatic||!a.ctor)this.routes=c;else{var e=this.routes=[];c.forEach(function(b){a.ctor.routes.forEach(function(a){var c=m._extend({},b);c.path=j(a.path,b.path),e.push(c)})})}}function h(a){return"function"==typeof a&&(a=a.name),"string"==typeof a?a.toLowerCase():(l("WARNING: unkown ctorOrName of type %s: %j",typeof a,a),"undefined")}function i(a,b,c){Object.defineProperty(a,b,{value:c,enumerable:!1,writable:!1,configurable:!1})}function j(a,b){if(!a)return b;if(!b||"/"==b)return a;var c=a[a.length-1]+b[0];return"//"==c?a+b.slice(1):"/"==c[0]||"/"==c[1]?a+b:a+"/"+b}b.exports=c,c.RestClass=f,c.RestMethod=g;var k=a("events").EventEmitter,l=a("debug")("strong-remoting:rest-adapter"),m=a("util"),n=m.inherits,o=a("assert"),p=a("express"),q=a("body-parser"),r=a("cors"),s=a("async"),t=a("./http-invocation"),u=a("./http-context"),v=q.json,w=q.urlencoded;n(c,k),c.create=c.createRestAdapter=function(a){return new c(a)},c.prototype.getRoutes=d,c.prototype.connect=function(a){this.connection=a},c.prototype.invoke=function(a,b,c){o(this.connection,"Cannot invoke method without a connection. See RemoteObjects#connect()."),o("string"==typeof a,"method is required when calling invoke()");var d=arguments[arguments.length-1];b=Array.isArray(b)?b:[],c="function"==typeof d?d:void 0;var e=this.getRestMethodByName(a),f=new t(e,b,this.connection);f.invoke(c)},c.prototype.getRestMethodByName=function(a){for(var b=this.getClasses(),c=0;c<b.length;c++)for(var d=b[c],e=0;e<d.methods.length;e++){var f=d.methods[e];if(f.fullName===a)return f}},c.sortRoutes=e,c.prototype.createHandler=function(){var a=p.Router(),b=this,d=this.getClasses();a.use(function(a,b,c){a.is("application/json")&&"0"===a.get("Content-Length")&&(a._body=!0,a.body={}),c()}),l("remoting options: %j",this.remotes.options);var f=this.remotes.options.urlencoded||{},g=this.remotes.options.json||{strict:!1},h=this.remotes.options.cors||{};return a.use(w(f)),a.use(v(g)),a.use(r(h)),d.forEach(function(d){var f=p.Router(),g=d.sharedClass.name;l("registering REST handler for class %j",g);var h=[];d.methods.forEach(function(a){var b=a.sharedMethod;l("    method %s",b.stringName),a.routes.forEach(function(a){h.push({route:a,method:b})})}),h.sort(e),h.forEach(function(a){b._registerMethodRouteHandlers(f,a.method,a.route)}),f.use(c.remoteMethodNotFoundHandler(g)),d.routes.forEach(function(b){l("    at %s",b.path),a.use(b.path,f)})}),a.use(c.urlNotFoundHandler()),a.use(c.errorHandler()),a},c.remoteMethodNotFoundHandler=function(a){return a=a||"(unknown)",function(b,c,d){var e='Shared class "'+a+'" has no method handling '+b.method+" "+b.url,f=new Error(e);f.status=f.statusCode=404,d(f)}},c.urlNotFoundHandler=function(){return function(a,b,c){var d="There is no method to handle "+a.method+" "+a.url,e=new Error(d);e.status=e.statusCode=404,c(e)}},c.errorHandler=function(){return function(a,b,c){"string"==typeof a&&(a=new Error(a),a.status=a.statusCode=500),c.statusCode=a.statusCode||a.status||500,l("Error in %s %s: %s",b.method,b.url,a.stack);var d={name:a.name,status:c.statusCode,message:a.message||"An unknown error occurred"};for(var e in a)d[e]=a[e];d.stack=a.stack,c.send({error:d})}},c.prototype._registerMethodRouteHandlers=function(a,b,c){var d=b.isStatic?this._createStaticMethodHandler(b):this._createPrototypeMethodHandler(b);l("        %s %s %s",c.verb,c.path,d.name);var e=c.verb;"del"===e&&(e="delete"),a[e](c.path,d)},c.prototype._createStaticMethodHandler=function(a){var b=this,c=this.Context;return function(d,e,f){var g=new c(d,e,a);b._invokeMethod(g,a,f)}},c.prototype._createPrototypeMethodHandler=function(a){var b=this,c=this.Context;return function(d,e,f){var g=new c(d,e,a);g.invoke(a.ctor,a.sharedCtor,function(c,d){return c?f(c):(g.instance=d,void b._invokeMethod(g,a,f))},!0)}},c.prototype._invokeMethod=function(a,b,c){var d=this.remotes,e=[];b.rest.before&&e.push(function(c){l("Invoking rest.before for "+a.methodString),b.rest.before.call(d.getScope(a,b),a,c)}),e.push(this.remotes.invokeMethodInContext.bind(this.remotes,a,b)),b.rest.after&&e.push(function(c){l("Invoking rest.after for "+a.methodString),b.rest.after.call(d.getScope(a,b),a,c)}),s.series(e,function(b){return b?c(b):void a.done()})},c.prototype.allRoutes=function(){function a(a,c,d){c="/"===c||"//"===c?e:e+c,"/"===c[c.length-1]&&(c=c.substr(0,c.length-1)),c=c.replace(/\/\//g,"/"),b.push({verb:a,path:c,description:d.description,method:d.stringName,accepts:d.accepts&&d.accepts.length?d.accepts:void 0,returns:d.returns&&d.returns.length?d.returns:void 0})}var b=[],c=this,d=this.remotes.classes(),e="";return d.forEach(function(b){c.getRoutes(b).forEach(function(d){e=d.path;var f=b.methods();f.forEach(function(b){c.getRoutes(b).forEach(function(d){b.isStatic?a(d.verb,d.path,b):c.getRoutes(b.sharedCtor).forEach(function(c){a(d.verb,c.path+d.path,b)})})})})}),b},c.prototype.getClasses=function(){return this.remotes.classes().map(function(a){return new f(a)})},f.prototype.getPath=function(){return this.routes[0].path},g.prototype.isReturningArray=function(){return 1==this.returns.length&&this.returns[0].root&&"array"===h(this.returns[0].type)||!1},g.prototype.acceptsSingleBodyArgument=function(){if(1!=this.accepts.length)return!1;var a=this.accepts[0];return a.http&&"body"==a.http.source&&"object"==h(a.type)||!1},g.prototype.getHttpMethod=function(){var a=this.routes[0].verb;return"all"==a?"POST":"del"==a?"DELETE":a.toUpperCase()},g.prototype.getPath=function(){return this.routes[0].path},g.prototype.getFullPath=function(){return j(this.restClass.getPath(),this.getPath())}},{"./http-context":120,"./http-invocation":121,assert:9,async:112,"body-parser":12,cors:127,debug:115,events:22,express:12,util:50}],124:[function(a,b){function c(a,b){this.name=a||b.remoteNamespace,this.ctor=b,this._methods=[],this._resolvers=[];var c=b&&b.http,d={path:"/"+this.name};Array.isArray(c)?(this.http=c,0===c.length&&c.push(d)):this.http=g._extend(d,c),"function"==typeof b&&b.sharedCtor&&(this.sharedCtor=new h(b.sharedCtor,"sharedCtor",this)),i(this.name,"must include a remoteNamespace when creating a SharedClass")}function d(a,b,c,d){c=c||{};var e=new h(d,b,this,c);return a.push(e),e}function e(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];if(e.isDelegateFor(b,c))return e}return null}function f(a,b){if(a)for(var c in a)if("super_"!==c){var d;try{d=a[c]}catch(e){}"function"==typeof d&&d.shared&&b(d,c)}}b.exports=c;var g=(a("debug")("strong-remoting:shared-class"),a("util")),h=(g.inherits,a("./shared-method")),i=a("assert");c.prototype.methods=function(){var a=this.ctor,b=[],c=this,g=[];return f(a,function(a,d){return-1!==g.indexOf(a)?(sharedMethod=e(b,a),void sharedMethod.addAlias(d)):(g.push(a),void b.push(h.fromFunction(a,d,c,!0)))}),f(a.prototype,function(a,d){return-1!==g.indexOf(a)?(sharedMethod=e(b,a),void sharedMethod.addAlias(d)):(g.push(a),void b.push(h.fromFunction(a,d,c)))}),this._resolvers.forEach(function(a){a.call(this,d.bind(c,b))}),b=b.concat(this._methods),b.filter(function(a){return a.shared===!0})},c.prototype.defineMethod=function(a,b,c){return d.call(this,this._methods,a,b,c)},c.prototype.resolve=function(a){this._resolvers.push(a)},c.prototype.find=function(a,b){var c=this.methods();return e(c,a,b)}},{"./shared-method":125,assert:9,debug:115,util:50}],125:[function(a,b){(function(c){function d(a,b,c,d){"boolean"==typeof d&&(d={isStatic:d}),this.fn=a,a=a||{},this.name=b,d=d||{},this.aliases=d.aliases||[];var e=this.isStatic=d.isStatic||!1;this.accepts=d.accepts||a.accepts||[],this.returns=d.returns||a.returns||[],this.description=d.description||a.description,this.http=d.http||a.http||{},this.rest=d.rest||a.rest||{},this.shared=d.shared,void 0===this.shared&&(this.shared=!0),a.shared===!1&&(this.shared=!1),this.sharedClass=c,c&&(this.ctor=c.ctor,this.sharedCtor=c.sharedCtor),"sharedCtor"===b&&(this.isSharedCtor=!0),this.accepts&&!Array.isArray(this.accepts)&&(this.accepts=[this.accepts]),this.returns&&!Array.isArray(this.returns)&&(this.returns=[this.returns]),this.stringName=(c?c.name:"")+(e?".":".prototype.")+b}b.exports=d;var e=(a("events").EventEmitter,a("debug")("strong-remoting:shared-method")),f=a("util"),g=(f.inherits,a("assert"),a("traverse"));d.fromFunction=function(a,b,c,e){return new d(a,b,c,{isStatic:e,accepts:a.accepts,returns:a.returns,description:a.description,http:a.http,rest:a.rest})},d.prototype.invoke=function(a,b,c){function f(a){return a?c(a):(g=d.toResult(i,[].slice.call(arguments,1)),e("- %s - result %j",k.name,g),void c(null,g))}var g,h=this.accepts,i=this.returns,j=this.getFunction(),k=this,l=[];if(h)for(var m=0;m<h.length;m++){var n=h[m],o=n.name||n.arg,p=d.convertArg(n,b[o]),q=d.getType(p);if("undefined"!==q){if("string"===q&&"any"!==n.type&&q!==n.type)switch(n.type){case"number":p=Number(p);break;case"boolean":p=Boolean(p);break;case"object":case"array":try{p=JSON.parse(p)}catch(r){return e("- %s - invalid value for argument '%s' of type '%s': %s",k.name,o,n.type,p),c(r)}}l.push(p)}else{if(n.required){var r=new Error(o+" is a required arg");return r.statusCode=400,c(r)}l.push(void 0)}}return l.push(f),e("- %s - invoke with",this.name,l),j.apply(a,l)},d.getType=function(a){var b=typeof a;switch(b){case"undefined":case"boolean":case"number":case"function":case"string":return b;case"object":return null===a?"null":c.isBuffer(a)?"buffer":Array.isArray(a)?"array":a instanceof Date?"date":"object"}},d.convertArg=function(a,b){if(a.http&&("req"===a.http.source||"res"===a.http.source||"context"===a.http.source))return b;if(null===b||"object"!=typeof b)return b;var d=g(b).forEach(function(a){if(null===a||"object"!=typeof a)return a;var b=a;if("base64"===a.$type||"date"===a.$type){switch(a.$type){case"base64":b=new c(a.$data,"base64");break;case"date":b=new Date(a.$data)}this.update(b)}return b});return d},d.toResult=function(a,b){function c(a){switch(d.getType(a)){case"date":return{$type:"date",$data:a.toString()};case"buffer":return{$type:"base64",$data:a.toString("base64")}}return a}var e={};if(a.length)return a=a.filter(function(a,d){return d>=b.length?!1:a.root?(e=c(b[d]),!1):!0}),a.forEach(function(a,d){e[a.name||a.arg]=c(b[d])}),e},d.prototype.getFunction=function(){var a;return this.ctor?(a=this.isStatic?this.ctor[this.name]:this.ctor.prototype[this.name],a||this.fn):this.fn},d.prototype.isDelegateFor=function(a,b){var c=typeof a;if(b=b||!1,a)switch(c){case"function":return this.getFunction()===a;case"string":return this.isStatic!==b?!1:this.name===a||-1!==this.aliases.indexOf(a)}return!1},d.prototype.addAlias=function(a){-1===this.aliases.indexOf(a)&&this.aliases.push(a)}}).call(this,a("buffer").Buffer)},{assert:9,buffer:13,debug:115,events:22,traverse:130,util:50}],126:[function(a,b){function c(a,b){if("function"!=typeof b)throw new Error("Bad callback given: "+b);if(!a)throw new Error("No options given");var g=a.onResponse;if(a="string"==typeof a?{uri:a}:JSON.parse(JSON.stringify(a)),a.onResponse=g,a.verbose&&(c.log=f()),a.url&&(a.uri=a.url,delete a.url),!a.uri&&""!==a.uri)throw new Error("options.uri is a required argument");if("string"!=typeof a.uri)throw new Error("options.uri must be a string");for(var h=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],j=0;j<h.length;j++)if(a[h[j]])throw new Error("options."+h[j]+" is not supported");if(a.callback=b,a.method=a.method||"GET",a.headers=a.headers||{},a.body=a.body||null,a.timeout=a.timeout||c.DEFAULT_TIMEOUT,a.headers.host)throw new Error("Options.headers.host is not supported");return a.json&&(a.headers.accept=a.headers.accept||"application/json","GET"!==a.method&&(a.headers["content-type"]="application/json"),"boolean"!=typeof a.json?a.body=JSON.stringify(a.json):"string"!=typeof a.body&&(a.body=JSON.stringify(a.body))),a.onResponse=a.onResponse||e,a.onResponse===!0&&(a.onResponse=b,a.callback=e),!a.headers.authorization&&a.auth&&(a.headers.authorization="Basic "+i(a.auth.username+":"+a.auth.password)),d(a)}function d(a){function b(){k=!0;var b=new Error("ETIMEDOUT");return b.code="ETIMEDOUT",b.duration=a.timeout,c.log.error("Timeout",{id:i._id,milliseconds:a.timeout}),a.callback(b,i)}function d(){if(k)return c.log.debug("Ignoring timed out state change",{state:i.readyState,id:i.id});if(c.log.debug("State change",{state:i.readyState,id:i.id,timed_out:k}),i.readyState===j.OPENED){c.log.debug("Request started",{id:i.id});for(var b in a.headers)i.setRequestHeader(b,a.headers[b])}else i.readyState===j.HEADERS_RECEIVED?e():i.readyState===j.LOADING?(e(),f()):i.readyState===j.DONE&&(e(),f(),g())}function e(){if(!p.response){if(p.response=!0,c.log.debug("Got response",{id:i.id,status:i.status}),clearTimeout(i.timeoutTimer),i.statusCode=i.status,m&&0==i.statusCode){var b=new Error("CORS request rejected: "+a.uri);return b.cors="rejected",p.loading=!0,p.end=!0,a.callback(b,i)}a.onResponse(null,i)}}function f(){p.loading||(p.loading=!0,c.log.debug("Response body loading",{id:i.id}))}function g(){if(!p.end){if(p.end=!0,c.log.debug("Request done",{id:i.id}),i.body=i.responseText,a.json)try{i.body=JSON.parse(i.responseText)}catch(b){return a.callback(b,i)}a.callback(null,i,i.body)}}var i=new j,k=!1,m=h(a.uri),n="withCredentials"in i;if(l+=1,i.seq_id=l,i.id=l+": "+a.method+" "+a.uri,i._id=i.id,m&&!n){var o=new Error("Browser does not support cross-origin request: "+a.uri);return o.cors="unsupported",a.callback(o,i)}i.timeoutTimer=setTimeout(b,a.timeout);var p={response:!1,loading:!1,end:!1};return i.onreadystatechange=d,i.open(a.method,a.uri,!0),m&&(i.withCredentials=!!a.withCredentials),i.send(a.body),i}function e(){}function f(){var a,b,c={},d=["trace","debug","info","warn","error"];for(b=0;b<d.length;b++)a=d[b],c[a]=e,"undefined"!=typeof console&&console&&console[a]&&(c[a]=g(console,a));return c}function g(a,b){function c(c,d){return"object"==typeof d&&(c+=" "+JSON.stringify(d)),a[b].call(a,c)}return c}function h(a){var b,c=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{b=location.href}catch(d){b=document.createElement("a"),b.href="",b=b.href}var e=c.exec(b.toLowerCase())||[],f=c.exec(a.toLowerCase()),g=!(!f||f[1]==e[1]&&f[2]==e[2]&&(f[3]||("http:"===f[1]?80:443))==(e[3]||("http:"===e[1]?80:443)));return g}function i(a){var b,c,d,e,f,g,h,i,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;do b=a.charCodeAt(k++),c=a.charCodeAt(k++),d=a.charCodeAt(k++),i=b<<16|c<<8|d,e=i>>18&63,f=i>>12&63,g=i>>6&63,h=63&i,n[l++]=j.charAt(e)+j.charAt(f)+j.charAt(g)+j.charAt(h);while(k<a.length);switch(m=n.join(""),a.length%3){case 1:m=m.slice(0,-2)+"==";break;case 2:m=m.slice(0,-1)+"="}return m}var j=XMLHttpRequest;if(!j)throw new Error("missing XMLHttpRequest");b.exports=c,c.log={trace:e,debug:e,info:e,warn:e,error:e};var k=18e4,l=0;c.withCredentials=!1,c.DEFAULT_TIMEOUT=k,c.defaults=function(a){var b=function(b){var c=function(c,d){c="string"==typeof c?{uri:c}:JSON.parse(JSON.stringify(c));for(var e in a)void 0===c[e]&&(c[e]=a[e]);return b(c,d)};return c},d=b(c);return d.get=b(c.get),d.post=b(c.post),d.put=b(c.put),d.head=b(c.head),d};var m=["get","put","post","head"];m.forEach(function(a){var b=a.toUpperCase(),d=a.toLowerCase();c[d]=function(a){"string"==typeof a?a={method:b,uri:a}:(a=JSON.parse(JSON.stringify(a)),a.method=b);var d=[a].concat(Array.prototype.slice.apply(arguments,[1]));return c.apply(this,d)}}),c.couch=function(a,b){function d(a,c,d){if(a)return b(a,c,d);if((c.statusCode<200||c.statusCode>299)&&d.error){a=new Error("CouchDB error: "+(d.error.reason||d.error.error));for(var e in d)a[e]=d[e];return b(a,c,d)}return b(a,c,d)}"string"==typeof a&&(a={uri:a}),a.json=!0,a.body&&(a.json=a.body),delete a.body,b=b||e;var f=c(a,d);return f}},{}],127:[function(a,b){!function(){"use strict";function a(a,b){var c=a.origin;return c===!0?c=b.headers.origin:c||(c="*"),{key:"Access-Control-Allow-Origin",value:c}}function c(a){var b=a.methods||j.methods;return b.join&&(b=a.methods.join(",")),{key:"Access-Control-Allow-Methods",value:b}}function d(a){return a.credentials===!0?{key:"Access-Control-Allow-Credentials",value:"true"}:null}function e(a,b){var c=a.allowedHeaders||a.headers;return c?c.join&&(c=c.join(",")):c=b.headers["access-control-request-headers"],c&&c.length?{key:"Access-Control-Allow-Headers",value:c}:null}function f(a){var b=a.exposedHeaders;return b?(b.join&&(b=b.join(",")),b&&b.length?{key:"Access-Control-Expose-Headers",value:b}:null):null}function g(a){var b=a.maxAge&&a.maxAge.toString();return b&&b.length?{key:"Access-Control-Max-Age",value:b}:null}function h(b,h,i,j){var k=[],l=function(a,b){a.forEach(function(a){a&&a.value&&b.setHeader(a.key,a.value)})};"OPTIONS"===h.method?(k.push(a(b,h)),k.push(d(b,h)),k.push(c(b,h)),k.push(e(b,h)),k.push(g(b,h)),l(k,i),i.statusCode=204,i.end()):(k.push(a(b,h)),k.push(d(b,h)),k.push(f(b,h)),l(k,i),j())}function i(a){a||(a={}),void 0===a.origin&&(a.origin=j.origin),void 0===a.methods&&(a.methods=j.methods);var b=null;return b="function"==typeof a?a:function(b,c){c(null,a)},function(a,c,d){a.pause(),b(a,function(b,e){if(a.resume(),b)d(b);else{var f=null;e.origin&&"function"==typeof e.origin?f=e.origin:e.origin&&(f=function(a,b){b(null,e.origin)}),f?(a.pause(),f(a.headers.origin,function(b,f){if(a.resume(),b||!f)d(b);else{var g=Object.create(e);g.origin=f,h(g,a,c,d)}})):d()}})}}var j={origin:"*",methods:"GET,HEAD,PUT,PATCH,POST,DELETE"};b.exports=i}()},{}],128:[function(a,b,c){!function(){function a(){this._events={},this._conf&&b.call(this,this._conf)}function b(a){a&&(this._conf=a,a.delimiter&&(this.delimiter=a.delimiter),a.maxListeners&&(this._events.maxListeners=a.maxListeners),a.wildcard&&(this.wildcard=a.wildcard),a.newListener&&(this.newListener=a.newListener),this.wildcard&&(this.listenerTree={}))}function d(a){this._events={},this.newListener=!1,b.call(this,a)}function e(a,b,c,d){if(!c)return[];var f,g,h,i,j,k,l,m=[],n=b.length,o=b[d],p=b[d+1];if(d===n&&c._listeners){if("function"==typeof c._listeners)return a&&a.push(c._listeners),[c];for(f=0,g=c._listeners.length;g>f;f++)a&&a.push(c._listeners[f]);return[c]}if("*"===o||"**"===o||c[o]){if("*"===o){for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&(m=m.concat(e(a,b,c[h],d+1)));return m}if("**"===o){l=d+1===n||d+2===n&&"*"===p,l&&c._listeners&&(m=m.concat(e(a,b,c,n)));for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&("*"===h||"**"===h?(c[h]._listeners&&!l&&(m=m.concat(e(a,b,c[h],n))),m=m.concat(e(a,b,c[h],d))):m=m.concat(h===p?e(a,b,c[h],d+2):e(a,b,c[h],d)));return m}m=m.concat(e(a,b,c[o],d+1))}if(i=c["*"],i&&e(a,b,i,d+1),j=c["**"])if(n>d){j._listeners&&e(a,b,j,n);for(h in j)"_listeners"!==h&&j.hasOwnProperty(h)&&(h===p?e(a,b,j[h],d+2):h===o?e(a,b,j[h],d+1):(k={},k[h]=j[h],e(a,b,{"**":k},d+1)))}else j._listeners?e(a,b,j,n):j["*"]&&j["*"]._listeners&&e(a,b,j["*"],n);return m}function f(a,b){a="string"==typeof a?a.split(this.delimiter):a.slice();for(var c=0,d=a.length;d>c+1;c++)if("**"===a[c]&&"**"===a[c+1])return;for(var e=this.listenerTree,f=a.shift();f;){if(e[f]||(e[f]={}),e=e[f],0===a.length){if(e._listeners){if("function"==typeof e._listeners)e._listeners=[e._listeners,b];else if(g(e._listeners)&&(e._listeners.push(b),!e._listeners.warned)){var i=h;"undefined"!=typeof this._events.maxListeners&&(i=this._events.maxListeners),i>0&&e._listeners.length>i&&(e._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",e._listeners.length),console.trace())}}else e._listeners=b;return!0}f=a.shift()}return!0}var g=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},h=10;d.prototype.delimiter=".",d.prototype.setMaxListeners=function(b){this._events||a.call(this),this._events.maxListeners=b,this._conf||(this._conf={}),this._conf.maxListeners=b},d.prototype.event="",d.prototype.once=function(a,b){return this.many(a,1,b),this
},d.prototype.many=function(a,b,c){function d(){0===--b&&e.off(a,d),c.apply(this,arguments)}var e=this;if("function"!=typeof c)throw new Error("many only accepts instances of Function");return d._origin=c,this.on(a,d),e},d.prototype.emit=function(){this._events||a.call(this);var b=arguments[0];if("newListener"===b&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var c=arguments.length,d=new Array(c-1),f=1;c>f;f++)d[f-1]=arguments[f];for(f=0,c=this._all.length;c>f;f++)this.event=b,this._all[f].apply(this,d)}if("error"===b&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var g;if(this.wildcard){g=[];var h="string"==typeof b?b.split(this.delimiter):b.slice();e.call(this,g,h,this.listenerTree,0)}else g=this._events[b];if("function"==typeof g){if(this.event=b,1===arguments.length)g.call(this);else if(arguments.length>1)switch(arguments.length){case 2:g.call(this,arguments[1]);break;case 3:g.call(this,arguments[1],arguments[2]);break;default:for(var c=arguments.length,d=new Array(c-1),f=1;c>f;f++)d[f-1]=arguments[f];g.apply(this,d)}return!0}if(g){for(var c=arguments.length,d=new Array(c-1),f=1;c>f;f++)d[f-1]=arguments[f];for(var i=g.slice(),f=0,c=i.length;c>f;f++)this.event=b,i[f].apply(this,d);return i.length>0||!!this._all}return!!this._all},d.prototype.on=function(b,c){if("function"==typeof b)return this.onAny(b),this;if("function"!=typeof c)throw new Error("on only accepts instances of Function");if(this._events||a.call(this),this.emit("newListener",b,c),this.wildcard)return f.call(this,b,c),this;if(this._events[b]){if("function"==typeof this._events[b])this._events[b]=[this._events[b],c];else if(g(this._events[b])&&(this._events[b].push(c),!this._events[b].warned)){var d=h;"undefined"!=typeof this._events.maxListeners&&(d=this._events.maxListeners),d>0&&this._events[b].length>d&&(this._events[b].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[b].length),console.trace())}}else this._events[b]=c;return this},d.prototype.onAny=function(a){if("function"!=typeof a)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(a),this},d.prototype.addListener=d.prototype.on,d.prototype.off=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");var c,d=[];if(this.wildcard){var f="string"==typeof a?a.split(this.delimiter):a.slice();d=e.call(this,null,f,this.listenerTree,0)}else{if(!this._events[a])return this;c=this._events[a],d.push({_listeners:c})}for(var h=0;h<d.length;h++){var i=d[h];if(c=i._listeners,g(c)){for(var j=-1,k=0,l=c.length;l>k;k++)if(c[k]===b||c[k].listener&&c[k].listener===b||c[k]._origin&&c[k]._origin===b){j=k;break}if(0>j)continue;return this.wildcard?i._listeners.splice(j,1):this._events[a].splice(j,1),0===c.length&&(this.wildcard?delete i._listeners:delete this._events[a]),this}(c===b||c.listener&&c.listener===b||c._origin&&c._origin===b)&&(this.wildcard?delete i._listeners:delete this._events[a])}return this},d.prototype.offAny=function(a){var b,c=0,d=0;if(a&&this._all&&this._all.length>0){for(b=this._all,c=0,d=b.length;d>c;c++)if(a===b[c])return b.splice(c,1),this}else this._all=[];return this},d.prototype.removeListener=d.prototype.off,d.prototype.removeAllListeners=function(b){if(0===arguments.length)return!this._events||a.call(this),this;if(this.wildcard)for(var c="string"==typeof b?b.split(this.delimiter):b.slice(),d=e.call(this,null,c,this.listenerTree,0),f=0;f<d.length;f++){var g=d[f];g._listeners=null}else{if(!this._events[b])return this;this._events[b]=null}return this},d.prototype.listeners=function(b){if(this.wildcard){var c=[],d="string"==typeof b?b.split(this.delimiter):b.slice();return e.call(this,c,d,this.listenerTree,0),c}return this._events||a.call(this),this._events[b]||(this._events[b]=[]),g(this._events[b])||(this._events[b]=[this._events[b]]),this._events[b]},d.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof define&&define.amd?define(function(){return d}):"object"==typeof c?c.EventEmitter2=d:window.EventEmitter2=d}()},{}],129:[function(a,b){b.exports=a(86)},{}],130:[function(a,b){b.exports=a(87)},{}],131:[function(a,b){function c(a){var b,c;for(b=[],c=0;c<a.length;c++)b.push(f[a[c]%f.length]);return b.join("")}function d(a,b){return"undefined"==typeof b?c(e.pseudoRandomBytes(a)):void e.pseudoRandomBytes(a,function(a,d){return a?b(a):void b(null,c(d))})}var e=a("crypto"),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";b.exports=d},{crypto:17}],132:[function(a,b,c){!function(a,d){"use strict";function e(a,b){var c,d,e=a.toLowerCase();for(b=[].concat(b),c=0;c<b.length;c+=1)if(d=b[c]){if(d.test&&d.test(a))return!0;if(d.toLowerCase()===e)return!0}}var f=d.prototype.trim,g=d.prototype.trimRight,h=d.prototype.trimLeft,i=function(a){return 1*a||0},j=function(a,b){if(1>b)return"";for(var c="";b>0;)1&b&&(c+=a),b>>=1,a+=a;return c},k=[].slice,l=function(a){return null==a?"\\s":a.source?a.source:"["+q.escapeRegExp(a)+"]"},m={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},n={};for(var o in m)n[m[o]]=o;n["'"]="#39";var p=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}var b=j,c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};return c.format=function(c,e){var f,g,h,i,j,k,l,m=1,n=c.length,o="",q=[];for(g=0;n>g;g++)if(o=a(c[g]),"string"===o)q.push(c[g]);else if("array"===o){if(i=c[g],i[2])for(f=e[m],h=0;h<i[2].length;h++){if(!f.hasOwnProperty(i[2][h]))throw new Error(p('[_.sprintf] property "%s" does not exist',i[2][h]));f=f[i[2][h]]}else f=i[1]?e[i[1]]:e[m++];if(/[^s]/.test(i[8])&&"number"!=a(f))throw new Error(p("[_.sprintf] expecting number but found %s",a(f)));switch(i[8]){case"b":f=f.toString(2);break;case"c":f=d.fromCharCode(f);break;case"d":f=parseInt(f,10);break;case"e":f=i[7]?f.toExponential(i[7]):f.toExponential();break;case"f":f=i[7]?parseFloat(f).toFixed(i[7]):parseFloat(f);break;case"o":f=f.toString(8);break;case"s":f=(f=d(f))&&i[7]?f.substring(0,i[7]):f;break;case"u":f=Math.abs(f);break;case"x":f=f.toString(16);break;case"X":f=f.toString(16).toUpperCase()}f=/[def]/.test(i[8])&&i[3]&&f>=0?"+"+f:f,k=i[4]?"0"==i[4]?"0":i[4].charAt(1):" ",l=i[6]-d(f).length,j=i[6]?b(k,l):"",q.push(i[5]?f+j:j+f)}return q.join("")},c.cache={},c.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw new Error("[_.sprintf] huh?");if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw new Error("[_.sprintf] huh?");for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw new Error("[_.sprintf] huh?");f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");d.push(c)}b=b.substring(c[0].length)}return d},c}(),q={VERSION:"2.3.0",isBlank:function(a){return null==a&&(a=""),/^\s*$/.test(a)},stripTags:function(a){return null==a?"":d(a).replace(/<\/?[^>]+>/g,"")},capitalize:function(a){return a=null==a?"":d(a),a.charAt(0).toUpperCase()+a.slice(1)},chop:function(a,b){return null==a?[]:(a=d(a),b=~~b,b>0?a.match(new RegExp(".{1,"+b+"}","g")):[a])},clean:function(a){return q.strip(a).replace(/\s+/g," ")},count:function(a,b){if(null==a||null==b)return 0;a=d(a),b=d(b);for(var c=0,e=0,f=b.length;;){if(e=a.indexOf(b,e),-1===e)break;c++,e+=f}return c},chars:function(a){return null==a?[]:d(a).split("")},swapCase:function(a){return null==a?"":d(a).replace(/\S/g,function(a){return a===a.toUpperCase()?a.toLowerCase():a.toUpperCase()})},escapeHTML:function(a){return null==a?"":d(a).replace(/[&<>"']/g,function(a){return"&"+n[a]+";"})},unescapeHTML:function(a){return null==a?"":d(a).replace(/\&([^;]+);/g,function(a,b){var c;return b in m?m[b]:(c=b.match(/^#x([\da-fA-F]+)$/))?d.fromCharCode(parseInt(c[1],16)):(c=b.match(/^#(\d+)$/))?d.fromCharCode(~~c[1]):a})},escapeRegExp:function(a){return null==a?"":d(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(a,b,c,d){var e=q.chars(a);return e.splice(~~b,~~c,d),e.join("")},insert:function(a,b,c){return q.splice(a,b,0,c)},include:function(a,b){return""===b?!0:null==a?!1:-1!==d(a).indexOf(b)},join:function(){var a=k.call(arguments),b=a.shift();return null==b&&(b=""),a.join(b)},lines:function(a){return null==a?[]:d(a).split("\n")},reverse:function(a){return q.chars(a).reverse().join("")},startsWith:function(a,b){return""===b?!0:null==a||null==b?!1:(a=d(a),b=d(b),a.length>=b.length&&a.slice(0,b.length)===b)},endsWith:function(a,b){return""===b?!0:null==a||null==b?!1:(a=d(a),b=d(b),a.length>=b.length&&a.slice(a.length-b.length)===b)},succ:function(a){return null==a?"":(a=d(a),a.slice(0,-1)+d.fromCharCode(a.charCodeAt(a.length-1)+1))},titleize:function(a){return null==a?"":(a=d(a).toLowerCase(),a.replace(/(?:^|\s|-)\S/g,function(a){return a.toUpperCase()}))},camelize:function(a){return q.trim(a).replace(/[-_\s]+(.)?/g,function(a,b){return b?b.toUpperCase():""})},underscored:function(a){return q.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(a){return q.trim(a).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(a){return q.titleize(d(a).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(a){return q.capitalize(q.underscored(a).replace(/_id$/,"").replace(/_/g," "))},trim:function(a,b){return null==a?"":!b&&f?f.call(a):(b=l(b),d(a).replace(new RegExp("^"+b+"+|"+b+"+$","g"),""))},ltrim:function(a,b){return null==a?"":!b&&h?h.call(a):(b=l(b),d(a).replace(new RegExp("^"+b+"+"),""))},rtrim:function(a,b){return null==a?"":!b&&g?g.call(a):(b=l(b),d(a).replace(new RegExp(b+"+$"),""))},truncate:function(a,b,c){return null==a?"":(a=d(a),c=c||"...",b=~~b,a.length>b?a.slice(0,b)+c:a)},prune:function(a,b,c){if(null==a)return"";if(a=d(a),b=~~b,c=null!=c?d(c):"...",a.length<=b)return a;var e=function(a){return a.toUpperCase()!==a.toLowerCase()?"A":" "},f=a.slice(0,b+1).replace(/.(?=\W*\w*$)/g,e);return f=f.slice(f.length-2).match(/\w\w/)?f.replace(/\s*\S+$/,""):q.rtrim(f.slice(0,f.length-1)),(f+c).length>a.length?a:a.slice(0,f.length)+c},words:function(a,b){return q.isBlank(a)?[]:q.trim(a,b).split(b||/\s+/)},pad:function(a,b,c,e){a=null==a?"":d(a),b=~~b;var f=0;switch(c?c.length>1&&(c=c.charAt(0)):c=" ",e){case"right":return f=b-a.length,a+j(c,f);case"both":return f=b-a.length,j(c,Math.ceil(f/2))+a+j(c,Math.floor(f/2));default:return f=b-a.length,j(c,f)+a}},lpad:function(a,b,c){return q.pad(a,b,c)},rpad:function(a,b,c){return q.pad(a,b,c,"right")},lrpad:function(a,b,c){return q.pad(a,b,c,"both")},sprintf:p,vsprintf:function(a,b){return b.unshift(a),p.apply(null,b)},toNumber:function(a,b){return a?(a=q.trim(a),a.match(/^-?\d+(?:\.\d+)?$/)?i(i(a).toFixed(~~b)):0/0):0},numberFormat:function(a,b,c,d){if(isNaN(a)||null==a)return"";a=a.toFixed(~~b),d="string"==typeof d?d:",";var e=a.split("."),f=e[0],g=e[1]?(c||".")+e[1]:"";return f.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+d)+g},strRight:function(a,b){if(null==a)return"";a=d(a),b=null!=b?d(b):b;var c=b?a.indexOf(b):-1;return~c?a.slice(c+b.length,a.length):a},strRightBack:function(a,b){if(null==a)return"";a=d(a),b=null!=b?d(b):b;var c=b?a.lastIndexOf(b):-1;return~c?a.slice(c+b.length,a.length):a},strLeft:function(a,b){if(null==a)return"";a=d(a),b=null!=b?d(b):b;var c=b?a.indexOf(b):-1;return~c?a.slice(0,c):a},strLeftBack:function(a,b){if(null==a)return"";a+="",b=null!=b?""+b:b;var c=a.lastIndexOf(b);return~c?a.slice(0,c):a},toSentence:function(a,b,c,d){b=b||", ",c=c||" and ";var e=a.slice(),f=e.pop();return a.length>2&&d&&(c=q.rtrim(b)+c),e.length?e.join(b)+c+f:f},toSentenceSerial:function(){var a=k.call(arguments);return a[3]=!0,q.toSentence.apply(q,a)},slugify:function(a){if(null==a)return"";var b="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",c="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",e=new RegExp(l(b),"g");return a=d(a).toLowerCase().replace(e,function(a){var d=b.indexOf(a);return c.charAt(d)||"-"}),q.dasherize(a.replace(/[^\w\s-]/g,""))},surround:function(a,b){return[b,a,b].join("")},quote:function(a,b){return q.surround(a,b||'"')},unquote:function(a,b){return b=b||'"',a[0]===b&&a[a.length-1]===b?a.slice(1,a.length-1):a},exports:function(){var a={};for(var b in this)this.hasOwnProperty(b)&&!b.match(/^(?:include|contains|reverse)$/)&&(a[b]=this[b]);return a},repeat:function(a,b,c){if(null==a)return"";if(b=~~b,null==c)return j(d(a),b);for(var e=[];b>0;e[--b]=a);return e.join(c)},naturalCmp:function(a,b){if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var c=/(\.\d+)|(\d+)|(\D+)/g,e=d(a).toLowerCase().match(c),f=d(b).toLowerCase().match(c),g=Math.min(e.length,f.length),h=0;g>h;h++){var i=e[h],j=f[h];if(i!==j){var k=parseInt(i,10);if(!isNaN(k)){var l=parseInt(j,10);if(!isNaN(l)&&k-l)return k-l}return j>i?-1:1}}return e.length===f.length?e.length-f.length:b>a?-1:1},levenshtein:function(a,b){if(null==a&&null==b)return 0;if(null==a)return d(b).length;if(null==b)return d(a).length;a=d(a),b=d(b);for(var c,e,f=[],g=0;g<=b.length;g++)for(var h=0;h<=a.length;h++)e=g&&h?a.charAt(h-1)===b.charAt(g-1)?c:Math.min(f[h],f[h-1],c)+1:g+h,c=f[h],f[h]=e;return f.pop()},toBoolean:function(a,b,c){return"number"==typeof a&&(a=""+a),"string"!=typeof a?!!a:(a=q.trim(a),e(a,b||["true","1"])?!0:e(a,c||["false","0"])?!1:void 0)}};q.strip=q.trim,q.lstrip=q.ltrim,q.rstrip=q.rtrim,q.center=q.lrpad,q.rjust=q.lpad,q.ljust=q.rpad,q.contains=q.include,q.q=q.quote,q.toBool=q.toBoolean,"undefined"!=typeof c&&("undefined"!=typeof b&&b.exports&&(b.exports=q),c._s=q),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return q}),a._=a._||{},a._.string=a._.str=q}(this,String)},{}],133:[function(a,b){b.exports=a(60)},{}],134:[function(a,b){b.exports={name:"loopback",description:"LoopBack: Open API Framework for Node.js",homepage:"http://loopback.io",keywords:["restful","rest","api","express","restify","koa","auth","security","oracle","mysql","nosql","mongo","mongodb","sqlserver","mssql","postgres","postgresql","soap","StrongLoop","framework","mobile","mBaaS"],version:"2.0.0-beta3",scripts:{test:"grunt test"},dependencies:{debug:"~0.8.1",express:"4.x","body-parser":"~1.2.2","strong-remoting":"2.0.0-beta4",inflection:"~1.3.5",nodemailer:"~0.6.5",ejs:"~1.0.0",bcryptjs:"~0.7.12","underscore.string":"~2.3.3",underscore:"~1.6.0",uid2:"0.0.3",async:"~0.9.0","canonical-json":"0.0.4"},peerDependencies:{"loopback-datasource-juggler":"2.0.0-beta2"},devDependencies:{browserify:"~4.1.6",chai:"~1.9.1","cookie-parser":"~1.1.0",errorhandler:"~1.0.1","es5-shim":"^3.4.0",grunt:"~0.4.5","grunt-browserify":"~2.1.0","grunt-cli":"^0.1.13","grunt-contrib-jshint":"~0.10.0","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.6.1","grunt-karma":"~0.8.3","grunt-mocha-test":"^0.11.0",karma:"~0.12.16","karma-browserify":"~0.2.1","karma-chrome-launcher":"~0.1.4","karma-firefox-launcher":"~0.1.3","karma-html2js-preprocessor":"~0.1.0","karma-junit-reporter":"^0.2.2","karma-mocha":"^0.1.4","karma-phantomjs-launcher":"~0.1.4","karma-script-launcher":"~0.1.0","loopback-datasource-juggler":"2.0.0-beta2","loopback-testing":"~0.2.0",mocha:"~1.20.1","serve-favicon":"~2.0.0","strong-task-emitter":"0.0.x",supertest:"~0.13.0"},repository:{type:"git",url:"https://github.com/strongloop/loopback"},browser:{express:"./lib/browser-express.js",connect:!1,passport:!1,"passport-local":!1,nodemailer:!1},license:{name:"Dual MIT/StrongLoop",url:"https://github.com/strongloop/loopback/blob/master/LICENSE"},readme:'LoopBack is a highly extensible, open source Node.js framework that enables you to:\n\n  * Create dynamic end-to-end REST APIs with little or no coding\n  * Easily access data from Oracle, MySQL, PostgreSQL, MS SQL Server, MongoDB, SOAP and other REST APIs\n  * Incorporate model relationships and access controls for complex APIs\n  * Run your application on-premises or in the cloud  \n  * Use built-in push, geolocation, and file services for mobile use cases\n  * Easily create client apps using Android, iOS, and JavaScript SDKs\n\nLoopBack consists of:\n  * A library of Node.js modules.\n  * A command line tool, `slc`, for creating and working with LoopBack applications.\n  * Client SDKs for native and web-based mobile clients.\n\nFor more details, see http://loopback.io/.\n\n## LoopBack modules \n\nIn addition to the [main LoopBack module](https://github.com/strongloop/loopback), LoopBack consists of numerous other modules that implement specific functionality, \nas illustrated below:\n\n![LoopBack modules](https://github.com/strongloop/loopback/raw/master/docs/assets/lb-modules.png "LoopBack modules")\n\n* Frameworks\n  * [loopback](https://github.com/strongloop/loopback)\n  * [loopback-datasource-juggler](https://github.com/strongloop/loopback-datasource-juggler)\n  * [strong-remoting](https://github.com/strongloop/strong-remoting)\n\n* Enterprise Connectors\n  * [loopback-connector-mongodb](https://github.com/strongloop/loopback-connector-mongodb)\n  * [loopback-connector-mysql](https://github.com/strongloop/loopback-connector-mysql)\n  * [loopback-connector-oracle](https://github.com/strongloop/loopback-connector-oracle)\n  * [loopback-connector-mssql](https://github.com/strongloop/loopback-connector-mssql)\n  * [loopback-connector-postgresql](https://github.com/strongloop/loopback-connector-postgresql)\n  * [loopback-connector-rest](https://github.com/strongloop/loopback-connector-rest)\n  * [loopback-connector-soap](https://github.com/strongloop/loopback-connector-soap) \n\n* Mobile services\n  * [loopback-push-notification](https://github.com/strongloop/loopback-push-notification)\n  * [loopback-storage-service](https://github.com/strongloop/loopback-storage-service)\n\n* Clients\n  * [loopback-ios](https://github.com/strongloop/loopback-ios)\n  * [strong-remoting-ios](https://github.com/strongloop/strong-remoting-ios)\n  * [loopback-android](https://github.com/strongloop/loopback-android)\n  * [strong-remoting-android](https://github.com/strongloop/strong-remoting-android)\n  * [loopback-angular](https://github.com/strongloop/loopback-angular)\n\n* Tools\n  * [loopback-explorer](https://github.com/strongloop/loopback-explorer)\n  * [loopback-workspace](https://github.com/strongloop/loopback-workspace)\n  * [strong-cli](https://github.com/strongloop/strong-cli)\n\n* Examples\n  * [loopback-example-full-stack](https://github.com/strongloop/loopback-example-full-stack)\n  * [loopback-example-office-supplies](https://github.com/strongloop/loopback-example-office-supplies)\n  * [loopback-example-todo](https://github.com/strongloop/loopback-example-todo)\n  * [loopback-example-access-control](https://github.com/strongloop/loopback-example-access-control)\n  * [loopback-example-proxy](https://github.com/strongloop/loopback-example-proxy)\n  * [strongloop-community/loopback-example-datagraph](https://github.com/strongloop-community/loopback-example-datagraph)\n  * [strongloop-community/loopback-example-database](https://github.com/strongloop-community/loopback-example-database)\n  * [strongloop-community/loopback-examples-ios](https://github.com/strongloop-community/loopback-examples-ios)\n  * [strongloop-community/loopback-example-ssl](https://github.com/strongloop-community/loopback-example-ssl)\n\n## Resources \n\n  * [Documentation](http://docs.strongloop.com/display/DOC/LoopBack).\n  * [API documentation](http://apidocs.strongloop.com/loopback).\n  * [LoopBack Google Group](https://groups.google.com/forum/#!forum/loopbackjs).\n  * [GitHub issues](https://github.com/strongloop/loopback/issues).\n  * Read more about the [LoopBack\'s features](https://github.com/strongloop/loopback/wiki/Features).\n\n## Contributing\n\nPlease read [CONTRIBUTING.md](CONTRIBUTING.md) on how to contribute.\n\nA brief guide for [contributing to LoopBack projects](https://github.com/strongloop/loopback/wiki/How-To-Contribute).\n\n[![Analytics](https://sl-beacon.appspot.com/UA-37775386-1/github/loopback/readme?pixel)](https://github.com/strongloop/loopback)\n',readmeFilename:"README.md",bugs:{url:"https://github.com/strongloop/loopback/issues"},_id:"loopback@2.0.0-beta3",_shasum:"26ab5edf69c455e08ecbeac245986e8c2f4688a6",_resolved:"../loopback/loopback-2.0.0-beta3.tgz",_from:"../loopback/loopback-2.0.0-beta3.tgz"}},{}]},{},[]),window.CONFIG={routes:{"/":{controller:"HomeCtrl",templateUrl:"/views/welcome.html"},"/me":{controller:"UserCtrl",templateUrl:"/views/user.html"},"/my/todos/:status":{controller:"TodoCtrl",templateUrl:"/views/todos.html"},"/my/todos":{controller:"TodoCtrl",templateUrl:"/views/todos.html"},"/login":{controller:"LoginCtrl",templateUrl:"/views/login.html"},"/register":{controller:"RegisterCtrl",templateUrl:"/views/register.html"},"/debug":{controller:"ChangeCtrl",templateUrl:"/views/changes.html"}}},angular.module("loopbackExampleFullStackApp",["ngRoute"]).config(["$routeProvider","$locationProvider",function(a,b){Object.keys(window.CONFIG.routes).forEach(function(b){var c=window.CONFIG.routes[b];a.when(b,c)}),a.otherwise({redirectTo:"/"}),b.html5Mode(!0)}]);var client=function(){return require("lbclient")}();angular.module("loopbackExampleFullStackApp").value("Todo",client.models.LocalTodo).value("RemoteTodo",client.models.Todo).value("sync",client.sync).value("network",client.network),angular.module("loopbackExampleFullStackApp").controller("HomeCtrl",["$scope",function(a){a.foo=Math.random()}]),angular.module("loopbackExampleFullStackApp").controller("UserCtrl",["$scope",function(a){a.foo=Math.random()}]),angular.module("loopbackExampleFullStackApp").controller("TodoCtrl",["$scope","$routeParams","$filter","Todo","$location","sync","network",function(a,b,c,d,e,f,g){function h(){d.stats(function(b,c){return b?i(b):void(a.stats=c)}),d.find({where:a.statusFilter,sort:"order DESC"},function(b,c){a.todos=c,a.$apply()})}function i(a){throw a}function j(a){a&&i(a)}function k(){a.localConflicts=[],a.$apply(),f()}a.todos=[],a.newTodo="",a.editedTodo=null,f(h),a.loc=e,d.on("changed",h),d.on("deleted",h),a.$on("$routeChangeSuccess",function(){var c=a.status=b.status||"";a.statusFilter="active"===c?{completed:!1}:"completed"===c?{completed:!0}:{}}),a.addTodo=function(){var b=new d({title:a.newTodo});b.save(),a.newTodo=""},a.editTodo=function(b){a.editedTodo=b},a.todoCompleted=function(a){a.completed=!0,a.save()},a.doneEditing=function(b){a.editedTodo=null,b.title=b.title.trim(),b.title?b.save():a.removeTodo(b)},a.removeTodo=function(a){a.remove(j)},a.clearCompletedTodos=function(){d.destroyAll({completed:!0},h)},a.markAll=function(a){d.find(function(b,c){return b?j(b):void c.forEach(function(b){b.completed=a,b.save(j)})})},a.sync=function(){f()},a.connected=function(){return g.isConnected},a.connect=function(){g.isConnected=!0,f()},a.disconnect=function(){g.isConnected=!1},d.on("conflicts",function(b){a.localConflicts=b,b.forEach(function(b){b.type(function(c,d){b.type=d,b.models(function(c,d,e){b.source=d,b.target=e,b.manual=new b.SourceModel(d||e),a.$apply()}),b.changes(function(c,d,e){b.sourceChange=d,b.targetChange=e,a.$apply()})})})}),a.resolveUsingSource=function(a){a.resolve(k)},a.resolveUsingTarget=function(a){if("delete"===a.targetChange.type())a.SourceModel.deleteById(a.modelId,k);else{var b=new a.SourceModel(a.target);b.save(k)}},a.resolveManually=function(a){a.manual.save(function(b){return b?j(b):void a.resolve(k)})}}]),angular.module("loopbackExampleFullStackApp").controller("LoginCtrl",["$scope",function(a){a.foo=Math.random()}]),angular.module("loopbackExampleFullStackApp").controller("RegisterCtrl",["$scope",function(a){a.foo=Math.random()}]),angular.module("loopbackExampleFullStackApp").controller("ChangeCtrl",["$scope","$routeParams","$filter","Todo","RemoteTodo",function(a,b,c,d,e){d.getChangeModel().find(function(b,c){a.changes=c,a.$apply(),e.diff(0,c,function(b,c){a.diff=c,a.$apply()})}),a.clearLocalStorage=function(){localStorage.removeItem("todo-db")},d.find(function(b,c){a.todos=c,a.$apply()})}]);